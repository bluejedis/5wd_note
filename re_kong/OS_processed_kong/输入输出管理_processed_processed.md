## above

<ul>

### 【考纲内容】

<ul>

(一）I/O管理基础

设备：设备的基本概念，设备的分类，I/O接口IO控制方式：____方式，____方式，____方式

I/O软件层次结构：____处理程序，____程序，设备独立性软件，用户层I/O软件输入/输出应用程序接口：____设备接口，____设备接口，____设备接口，____/____I/O

(二）设备独立软件缓冲区管理：设备分配与回收；假脱机技术（SPOOLing）：设备____程序接口

(三）外存管理

磁盘：磁盘结构，____，分区，磁盘____算法固态硬盘：读/写性能特效，____均衡

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>轮询</li>
    <li>中断</li>
    <li>DMA</li>
    <li>中断</li>
    <li>驱动</li>
    <li>字符</li>
    <li>块</li>
    <li>网络</li>
    <li>阻塞</li>
    <li>非阻塞</li>
    <li>驱动</li>
    <li>格式化</li>
    <li>调度</li>
    <li>磨损</li>
  </ul>
</details>
</div>

### 【复习提示】

<ul>

- 本章内容概述：
  - 内容较为____。

- 重点掌握的知识点：
  - I/O____。
  - I/O____。
  - 三种I/O____方式。
  - 高速缓存与____。
  - ____技术。
  - 磁盘____和调度算法。

- 学习建议：
  - 与计算机组成原理的对应章节结合____。
  - 已复习过计算机组成原理的读者遇到熟悉的内容时可适当____。

- 统考真题中的内容比重：
  - 所占的比重不____。
  - 若统考中出现本章的题目，则基本上较为____。

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>分散</li>
    <li>接口</li>
    <li>软件</li>
    <li>控制</li>
    <li>缓冲区</li>
    <li>SPOOLing</li>
    <li>特性</li>
    <li>复习</li>
    <li>跳过</li>
    <li>大</li>
    <li>简单</li>
  </ul>
</details>
</div>

</ul>

## I/O管理<span style="color: gray;">概述</span>

<ul>

在学习本节时，请读者思考I/O管理要完成哪些____。

### I/O设备

<ul>

- I/O设备管理的特点：
  - 操作系统设计中最为____的部分。
  - 具有____性。

- I/O设备管理的复杂性原因：
  - 包含多个领域的不同____。
  - 包含与设备相关的____程序。
  - 很难有____且一致的设计方案。

<div>
<details>
  <summary> </summary>
  <ul>
    <li>功能</li>
    <li>凌乱</li>
    <li>挑战</li>
    <li>设备</li>
    <li>应用</li>
    <li>通用</li>
  </ul>
</details>
</div>

#### 设备的分类

<ul>

- I/O设备定义：
  - 能够将数据____计算机的外部设备。
  - 能够接收计算机____数据的外部设备。

- I/O设备的分类：

  ##### 按信息交换的单位分类：
  <ul>
  1. 块设备：
     - 信息交换以____为单位。
     - 例如：____、磁带。
     - 特征：传输速率较高，可____。
  
  2. 字符设备：
     - 信息交换以____为单位。
     - 例如：交互式终端机、____。
     - 特征：传输速率低，不可____，常采用中断I/O方式。
  </ul>

  ##### 按设备的传输速率分类：
  <ul>
  1. 低速设备：
     - 传输速率：每秒几字节至____字节。
     - 例如：____、鼠标。

  2. 中速设备：
     - 传输速率：每秒数千字节至____字节。
     - 例如：激光____。

  3. 高速设备：
     - 传输速率：数百千字节至____字节。
     - 例如：____机、光盘机。
  </ul>

  ##### 按设备的使用特性分类：
  <ul>
  1. 存储设备：
     - 用于存储____。
     - 例如：磁盘、____、光盘。

  2. 输入/输出设备：
     - 输入设备：向计算机输入____。
       - 例如：键盘、____、扫描仪。
     - 输出设备：输出数据____。
       - 例如：____。
     - 交互式设备：集成____和输出功能。
       - 例如：触控____。
  </ul>

  ##### 按设备的共享属性分类：
  <ul>
  1. 独占设备：
     - 同一时刻只能由一个____占用。
     - 低速设备通常是____设备。
     - 例如：____。

  2. 共享设备：
     - 允许多个进程同时____。
     - 通过分时共享使用。
     - 例如：____。

  3. 虚拟设备：
     - 通过____技术将独占设备变为共享设备。
     - 一个物理设备变为多个____设备。
     - 允许多个进程同时____使用。
  </ul>

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>输入</li>
    <li>输出</li>
    <li>数据块</li>
    <li>磁盘</li>
    <li>寻址</li>
    <li>字符</li>
    <li>打印机</li>
    <li>寻址</li>
    <li>数百</li>
    <li>键盘</li>
    <li>数万</li>
    <li>打印机</li>
    <li>千兆</li>
    <li>磁盘</li>
    <li>信息</li>
    <li>磁带</li>
    <li>信息</li>
    <li>鼠标</li>
    <li>信息</li>
    <li>打印机</li>
    <li>输入</li>
    <li>显示器</li>
    <li>进程</li>
    <li>独占</li>
    <li>打印机</li>
    <li>访问</li>
    <li>磁盘</li>
    <li>SPOOLing</li>
    <li>逻辑</li>
    <li>分配</li>
  </ul>
</details>
</div>

#### I/O接口（设备控制器）

<ul>

- I/O接口的定义：
  - 也称为____控制器。
  - CPU与____之间的接口。
  - 实现设备和计算机之间的数据____。

- I/O接口的功能：
  - 接收CPU发出的____。
  - 控制设备____。
  - 使CPU从繁杂的设备控制事务中____出来。

**组成**

**设备控制器**主要由三部分组成:

- ![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/e49971ea86446d27951fba8407efff766807b5cfb5b3209d1a23bdaa982a458a.jpg)\
图5.1设备控制器的组成

**1）\~与CPU的接口**

- CPU与设备控制器通信接口：
  - 实现CPU与设备控制器之间的____。

- 接口信号线分类：
  - 数据线：
    - 传输读/写____。
    - 传输控制____。
    - 传输状态____。
  - 地址线：
    - 用于访问I/O接口中的____编号。
  - 控制线：
    - 传输读/写等____信号。

**2）\~与设备的接口**

- 设备控制器的连接能力：
  - 一个设备控制器可以连接一个或多个____。
  - 因此，控制器中有一个或多个____接口。

- 设备接口的信号传输：
  - 每个接口都可以传输三种类型的信号：
    - ____信号。
    - ____信号。
    - ____信号。

**3）I/O逻辑**

用于实现对设备的____

它通过一组控制线与CPU交互，对从CPU收到的I/O命令进行**____**。

CPU启动设备时：

* 将启动命令发送给____
* 同时通过地址线将地址发送给____
  * 由控制器的I/O逻辑对地址进行____
  * 并对所选设备进行____

**主要功能：**

① 接收和识别命令

* 如磁盘控制器能接收CPU发来的读、写、____等命令

② 数据交换

* 包括CPU和控制器之间的数据____，以及控制器和设备之间的数据____；

③标识和报告设备的状态，以供CPU____； 
④ 地址____； 数据____； 差错____。

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>设备</li>
    <li>设备</li>
    <li>交换</li>
    <li>命令</li>
    <li>工作</li>
    <li>解脱</li>
    <li>通信</li>
    <li>数据</li>
    <li>信息</li>
    <li>信息</li>
    <li>寄存器</li>
    <li>控制</li>
    <li>设备</li>
    <li>设备</li>
    <li>数据</li>
    <li>控制</li>
    <li>状态</li>
    <li>控制</li>
    <li>译码</li>
    <li>控制器</li>
    <li>控制器</li>
    <li>译码</li>
    <li>控制</li>
    <li>查找</li>
    <li>传输</li>
    <li>传输</li>
    <li>处理</li>
    <li>识别</li>
    <li>缓冲</li>
    <li>控制</li>
  </ul>
</details>
</div>

#### I/O接口的类型

<ul>

从不同的角度看，I/O接口can分为不同的类型：

1）按数据传送方式（外设和接口一侧）

* ____接口（一个字节or者一个字的所有位同时传送）
* ____接口（一位一位地有序传送）

接口要完成数据____的转换。

2）按主机访问IO设备的控制方式

* ____查询接口、____接口和____接口等

3）按功能选择的灵活性

* ____接口（通过编程改变接口功能）
* ____接口

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>并行</li>
    <li>串行</li>
    <li>格式</li>
    <li>程序</li>
    <li>中断</li>
    <li>DMA</li>
    <li>可编程</li>
    <li>不可编程</li>
  </ul>
</details>
</div>

#### I/O端口

<ul>

I/O端口：设备控制器中 可被CPU直接访问的____

主要有以下三类寄存器：

* 数据寄存器：
  * 用于缓存 从设备送来的____数据 or 从CPU送来的____数据
* 状态寄存器：
  * 保存设备的执行结果or____信息，以供CPU读取
* 控制寄存器：
  * 由CPU写入，以便启动____or更改设备____

I/O端口要想can被CPU访问，就要对各个端口进行____，every端口对应一个端口地址。

而对I/O端口的编址方式have与存储器____编址和____编址两种:

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/401d00c9d063a104c8f5367dac6c8fba58fe2fab6e01df0ba55a3358f01f1d49.jpg)\
图5.2独立编址I/O和内存映射I/O

**（1）独立编址**

独立编址是指为every端口分配一个I/O____号

I/O端口的____空间与____地址空间是两个独立的地址空间

* their范围can____
  * 相同地址可能属于不同的地址空间
* 普通用户程序不能对端口进行____
* only操作系统使用特殊的I/O____才能访问端口

优点：

* I/O端口数比主存单元少得多，只需少量地址线，makes I/O端口译码**____**，寻址速度更**____**
* 使用专用I/O指令，可使程序更加**____**，便于理解和检查

缺点：

* I/O指令少，只提供简单的传输操作，所以程序设计的**____**较**____**
* 此外，CPU需要提供两组独立的存储器和设备的读/写控制信号，增加了____ 的**____**性

**（2）统一编址**

> also called as**____映射**I/O

* 将**____**地址空间 ____ 一部分给I/O端口进行编址
  * I/O端口和主存单元在同一地址空间的不同分段中
    * according to地址范围，can区分访向的是 ____端口or主存单元
  * thus无须设置专门的____指令，用统一的访存指令就可访问I/O端口

优点：

* 不需要专门的I/O指令，makes CPU访问I/O的操作更加____和____
  * 端口有较**____**的**____**空间
* I/O访问的**____机制**可由虚拟存储管理系统来实现，**____专门**设置

缺点：

* 端口地址**____**了部分**____**地址空间 → 主存的可用容量变小
* 由于 在识别I/O端口时全部地址线 都需 参加____
  * makes 译码电路更**____**，**____**了寻址**____**

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>寄存器</li>
    <li>输入</li>
    <li>输出</li>
    <li>状态</li>
    <li>命令</li>
    <li>模式</li>
    <li>编址</li>
    <li>独立</li>
    <li>统一</li>
    <li>端口</li>
    <li>地址</li>
    <li>主存</li>
    <li>重叠</li>
    <li>访问</li>
    <li>指令</li>
    <li>简单</li>
    <li>快</li>
    <li>清晰</li>
    <li>灵活性</li>
    <li>差</li>
    <li>控制</li>
    <li>复杂</li>
    <li>内存</li>
    <li>主存</li>
    <li>分出</li>
    <li>I/O</li>
    <li>I/O</li>
    <li>灵活</li>
    <li>方便</li>
    <li>大</li>
    <li>编址</li>
    <li>保护</li>
    <li>无须</li>
    <li>占用</li>
    <li>主存</li>
    <li>译码</li>
    <li>复杂</li>
    <li>降低</li>
    <li>速度</li>
  </ul>
</details>
</div>

</ul>

### I/O控制方式

<ul>

- I/O控制的目的：
  - 控制设备和主机之间的数据____。

- I/O控制方式的发展宗旨：
  - 尽量减少CPU对I/O控制的____。
  - 解脱CPU从繁杂的I/O控制事务中。
  - 使CPU能更多执行____任务。

控制方式共有4种：

<div>
<details>
  <summary> </summary>
  <ul>
    <li>传送</li>
    <li>干预</li>
    <li>运算</li>
  </ul>
</details>
</div>

#### 程序直接控制方式

<ul>

* CPU对I/O设备的控制采取____的I/O方式，also called as程序轮询方式
* 工作过程：
  * CPU向设备控制器发出一条____指令，启动从I/O设备读取一个字（节）
  * 不断地循环测试设备____（称为轮询）
  * 直到确定该字（节）已在设备控制器的数据____中
  * CPU将数据寄存器中的数据取出，送入内存的指定____

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/75abe47fb068f8bc618d23ce5403594c090e71aa91de763369678b2e38aaa339.jpg)\
图5.3I/O控制方式的操作流程

* 缺点：
  * CPU的绝大部分时间都处于等待I/O设备状态的____测试中
  * CPU和I/O设备只能____工作
  * 由于CPU和I/O设备的速度差异很大，导致CPU的利用率相当____
  * CPU之所以要不断地测试I/O设备的状态，是因为在CPU中未采用____机构

<div>
<details>
  <summary> </summary>
  <ul>
    <li>轮询</li>
    <li>I/O</li>
    <li>状态</li>
    <li>寄存器</li>
    <li>单元</li>
    <li>循环</li>
    <li>串行</li>
    <li>低</li>
    <li>中断</li>
  </ul>
</details>
</div>

</ul>

#### 中断驱动方式

<ul>

##### 基本思想

<ul>

* 允许I/O设备主动打断CPU的运行并请求____，从而"解放"CPU
* CPU向设备控制器发出一条I/O指令后can继续做其他有用的____

</ul>

##### 工作过程

<ul>

###### 设备控制器角度

<ul>

* 从CPU接收读____，然后从设备读数据
* 数据读入设备控制器的数据寄存器后：
  * 通过控制线给CPU发出____信号
  * 等待CPU请求该____
  * 收到CPU发出的取数据请求后
  * 将数据放到数据____上，传到CPU的寄存器中

> pro：中断处理程序执行时请求进程的状态（2017、2023）

> pro：键盘接收数据的中断过程分析（2010、2024）

</ul>

###### CPU角度

<ul>

* 当前运行进程发出读命令：
  * 进程被____
  * 保存进程____
  * 转去执行其他程序
* 检查中断信号：
  * 在每个指令周期末尾____
  * 有中断时：
    * 保存当前运行进程____
    * 执行中断____程序
    * 从设备控制器读数据到寄存器并存入____
    * 解除发出I/O命令的进程的____状态
    * 恢复进程____
    * 继续运行

</ul>

</ul>

##### 优缺点

<ul>

* 优点：
  * 不需要____
  * CPU和设备____工作
  * CPU利用率____
* 缺点：
  * 数据交换必须经过CPU____
  * CPU以字（节）为单位进行干预，对块设备I/O操作效率____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>服务</li>
    <li>工作</li>
    <li>命令</li>
    <li>中断</li>
    <li>数据</li>
    <li>总线</li>
    <li>阻塞</li>
    <li>上下文</li>
    <li>检查</li>
    <li>上下文</li>
    <li>处理</li>
    <li>主存</li>
    <li>阻塞</li>
    <li>上下文</li>
    <li>轮询</li>
    <li>并行</li>
    <li>提升</li>
    <li>寄存器</li>
    <li>低</li>
  </ul>
</details>
</div>

</ul>

#### DMA方式

<ul>

##### 基本思想

<ul>

* 在I/O设备和内存之间开辟直接的数据____通路，彻底"解放"CPU

</ul>

##### 特点

<ul>

* 基本传送单位是____，而不再是字（节）
* 数据直接在设备和内存间____，不经过CPU
* 仅在传送数据块的开始和结束时需要CPU____

</ul>

##### 组成

<ul>

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/85a7e7036a0fcb4d7c5d51e75521bf08aa23e0583e84e1bea877320f5e79b378.jpg)\
图5.4DMA控制器的组成

* DMA控制器寄存器：
  * 命令/状态寄存器（CR）：接收CPU____和控制信息
  * 内存地址寄存器（MAR）：存放数据传送的内存____
  * 数据寄存器（DR）：暂存传送____
  * 数据计数器（DC）：存放要传送的____数

> pro：DMA方式的工作流程（2017）

</ul>

##### 工作过程

<ul>

* CPU接收到设备的DMA____：
  * 向DMA控制器发出____
  * 设置MAR和DC____
  * 启动DMA____
  * 继续其他工作
* DMA控制器负责数据传送：
  * 直接与内存____
  * 每次传送一个____
  * 传送结束后向CPU发送____信号

</ul>

##### 优点

<ul>

* 数据传输以"____"为单位，CPU介入频率低
* 数据传送不经过CPU____
* CPU和设备并行操作程度____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>交换</li>
    <li>数据块</li>
    <li>传送</li>
    <li>干预</li>
    <li>命令</li>
    <li>地址</li>
    <li>数据</li>
    <li>字节</li>
    <li>请求</li>
    <li>命令</li>
    <li>初值</li>
    <li>控制器</li>
    <li>交互</li>
    <li>字</li>
    <li>中断</li>
    <li>块</li>
    <li>寄存器</li>
    <li>提升</li>
  </ul>
</details>
</div>

</ul>

#### 通道控制方式

<ul>

##### 基本特点

<ul>

* 通道是特殊的____，可执行通道指令
* CPU只需发送一条I/O指令指明：
  * 通道程序在内存中的____
  * 要访问的I/O____
* 实现CPU、通道和I/O设备三者____工作

</ul>

##### 与其他方式的区别

<ul>

###### 与一般处理机的区别

<ul>

* 通道指令类型____
* 没有自己的____
* 与CPU共享____

</ul>

###### 与DMA方式的区别

<ul>

* 控制方式：
  * DMA需要CPU控制传输____
  * 通道由通道自身____
* 设备控制：
  * DMA一个控制器对应一台____
  * 一个通道可控制多台____

</ul>

</ul>

##### 四种方式的比喻

<ul>

* 程序控制方式：
  * 客户需定期查看____
  * 浪费客户____
* 中断方式：
  * 裁缝完成一件就____
  * 仍需频繁____
* DMA方式：
  * 雇用单线____
  * 按固定规则____
  * 定期向客户____
* 通道方式：
  * 秘书拥有更高____
  * 可自行决策存放____
  * 可灵活安排报告____
  * 可同时与多个裁缝____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>处理机</li>
    <li>位置</li>
    <li>设备</li>
    <li>并行</li>
    <li>单一</li>
    <li>内存</li>
    <li>内存</li>
    <li>细节</li>
    <li>控制</li>
    <li>设备</li>
    <li>设备</li>
    <li>进度</li>
    <li>时间</li>
    <li>通知</li>
    <li>往返</li>
    <li>秘书</li>
    <li>处理</li>
    <li>报告</li>
    <li>自主权</li>
    <li>位置</li>
    <li>时间</li>
    <li>沟通</li>
  </ul>
</details>
</div>

</ul>

</ul>

### I/O软件层次结构

<ul>

- **I/O软件的作用**
  - I/O软件的广泛涉及面：
    - 与____有密切关系。
    - 与虚拟存储器系统____。
    - 与文件系统____。
    - 与用户直接____。
    - 作用是实现I/O____。

> **pro：I/O子系统各层次的排序及功能（2012、2013）**

- **层次式结构的I/O软件**
  - I/O软件层次结构的目的：
    - 实现清晰的____。
    - 提高可移植性和易____性。

  - 层次结构的设计原则：
    - 将设备管理模块分为多个____。
    - 每层利用下层服务完成子____，并屏蔽实现细节。
    - 向高层提供____。

  - 层次结构的好处：
    - 层间接口不变时，修改某层软件不会影响其他____。
    - 仅最低层涉及硬件具体____。

  - I/O软件层次结构示例：
    - 一个合理的层次划分：图5.5。
    - I/O软件系统结构：____个层次。
    - 各层次及其功能：待详细描述。

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/2c2433d79207718a1762ec1908712367d27b45e0d88f2e784f80227d1447309b.jpg)
图5.5 I/O层次结构

<div>
<details>
  <summary> </summary>
  <ul>
    <li>硬件</li>
    <li>相关</li>
    <li>相关</li>
    <li>交互</li>
    <li>操作</li>
    <li>结构</li>
    <li>适应</li>
    <li>层次</li>
    <li>功能</li>
    <li>服务</li>
    <li>层次</li>
    <li>特性</li>
    <li>4</li>
  </ul>
</details>
</div>

#### （1）用户层软件

<ul>

- **功能**
  - 实现与用户交互的____，用户可直接调用在用户层提供的、与I/O操作有关的____函数，对设备进行操作。
  - 通常大部分的I/O软件都在操作系统内核，但仍有一小部分在用户层，包括与用户程序链接在一起的____函数。
  - 用户层I/O软件必须通过一组____调用来获取操作系统服务。

<div>
<details>
  <summary> </summary>
  <ul>
    <li>接口</li>
    <li>库</li>
    <li>库</li>
    <li>系统</li>
  </ul>
</details>
</div>

</ul>

#### （2）设备独立性软件

<ul>

- **功能**
  - 设备独立性软件的功能：
  - 实现用户程序与设备____的统一接口。
  - 设备____。
  - 设备____。
  - 设备的____与释放。
  - 为设备管理和数据传送提供____空间。

- 设备独立性的含义：
  - 应用程序使用的设备不局限于某个具体的____设备。

- 逻辑设备和物理设备的概念：
  - 引入这两个概念是为了实现设备____。
  - 应用程序中使用逻辑设备名请求____。
  - 系统执行时将逻辑设备名映射成____设备名。

> **pro：设备独立性所涵盖的内容（2020）**

- **好处**
  - 增加设备分配的____，易于实现I/O重定向，即用于I/O操作的设备可以更换（重定向），而不必改变____。
- **主要功能**
  - 执行所有设备的公有操作，包括：
    - 对设备的____与回收
    - 将逻辑设备名映射为____设备名
    - 对设备进行____，禁止用户直接访问设备
    - ____管理、差错控制
    - 提供独立于设备的大小统一的逻辑____，屏蔽设备之间信息交换单位大小和传输速率的差异
  - 向用户层（或文件层）提供统一____，无论何种设备，它们向用户所提供的接口应是相同的。例如，对各种设备的读/写操作，在应用程序中都统一使用read/write命令等。

<div>
<details>
  <summary> </summary>
  <ul>
    <li>驱动器</li>
    <li>命名</li>
    <li>保护</li>
    <li>分配</li>
    <li>存储</li>
    <li>物理</li>
    <li>独立性</li>
    <li>设备</li>
    <li>物理</li>
    <li>灵活性</li>
    <li>应用程序</li>
    <li>分配</li>
    <li>物理</li>
    <li>保护</li>
    <li>缓冲</li>
    <li>块</li>
    <li>接口</li>
  </ul>
</details>
</div>

</ul>

#### （3）设备驱动程序

<ul>

- **功能**
  - 设备驱动程序的功能：
    - 直接与硬件____，执行系统对设备的操作____。
    - 驱动I/O设备____。

  - 设备驱动程序的存在形式：
    - 每类设备通常配置一个____程序。
    - 作为I/O进程与设备控制器之间的____程序。
    - 通常以____的形式存在。

  - 设备驱动程序的角色：
    - 向上层用户程序提供____接口。
    - 封装设备具体____，接收并转换抽象I/O要求（如read和write命令）。
    - 控制I/O设备____。
    - 将设备控制器的____传送给上层软件。
    - 隐藏设备控制器之间的____。

<div>
<details>
  <summary> </summary>
  <ul>
    <li>相关</li>
    <li>指令</li>
    <li>工作</li>
    <li>驱动</li>
    <li>通信</li>
    <li>进程</li>
    <li>标准</li>
    <li>差别</li>
    <li>工作</li>
    <li>信号</li>
    <li>差异</li>
  </ul>
</details>
</div>

</ul>

#### （4）中断处理程序

<ul>

- **功能**
  - 中断处理层的作用：
    - 保存被中断进程的CPU____。
    - 转入相应的中断____程序进行处理。
    - 处理完毕后恢复被中断进程的____。
    - 返回到被中断进程继续____。

  - 中断处理层的主要任务：
    - 进行进程____的切换。
    - 对处理中断信号源进行____。
    - 读取设备状态和修改进程____等。

  - 中断处理层的特性：
    - 与硬件____相关。
    - 对用户而言应尽量____。
    - 应放在操作系统的____。
    - 系统的其余部分尽可能少地与之发生____。

> **pro：磁盘I/O操作中各层次的处理过程（2011）**

- **处理过程示例**
  - 用户读取设备内容的流程：

    1. 用户层：
       - 用户通过操作系统提供的____命令接口读取设备内容。

    2. 设备独立层：
       - 解析用户发出的____命令。
       - 将解析后的命令传递给____。

    3. 设备驱动层：
       - 针对不同设备，将read命令解析成不同的____。
       - 磁盘与打印机的read命令行为____。

    4. 中断处理程序：
       - 中断正在运行的____。
       - 执行____命令。

    5. 硬件设备层：
       - 控制器接收并执行____。
       - 完成相应____。

<div>
<details>
  <summary> </summary>
  <ul>
    <li>环境</li>
    <li>处理</li>
    <li>现场</li>
    <li>执行</li>
    <li>上下文</li>
    <li>测试</li>
    <li>状态</li>
    <li>紧密</li>
    <li>屏蔽</li>
    <li>底层</li>
    <li>联系</li>
    <li>read</li>
    <li>read</li>
    <li>下层</li>
    <li>指令</li>
    <li>不同</li>
    <li>进程</li>
    <li>read</li>
    <li>命令</li>
    <li>功能</li>
  </ul>
</details>
</div>

</ul>

</ul>

#### 应用程序I/O接口

<ul>

##### **I/O接口的分类**

<ul>

  - **字符设备接口**
    - 字符设备是指数据的存取和传输是以____为单位的设备，如键盘、打印机等
      - 基本特征：传输速率较低、不可____
      - 输入/输出方式：通常采用____驱动方式
    - get和put操作
      - 由于字符设备不可寻址，只能采取____存取方式
      - 用户程序通过get操作从缓冲区获取字符，通过put操作将字符输出到____
    - in-control指令
      - 字符设备类型繁多，差异甚大
      - 接口中提供一种通用的in-control____来处理它们
      - 包含了许多____，每个参数表示一个与具体设备相关的特定功能
    - 打开和关闭操作
      - 字符设备都属于____设备
      - 接口中需要提供打开和关闭操作，以实现互斥____

  - **块设备接口**
    - 块设备是指数据的存取和传输是以____为单位的设备，典型的块设备是磁盘
      - 基本特征：传输速率较高、可____
      - I/O方式：常采用____方式
    - 隐藏磁盘的二维结构
      - 在二维结构中，每个扇区的地址需要用磁道号和____号来表示
      - 块设备接口将磁盘的所有扇区从0到 \( n-1 \) 依次编号，将二维结构变为____序列
    - 将抽象命令映射为低层操作
      - 支持上层发来的对文件或设备的____、读、写和关闭等抽象命令
      - 将上述命令映射为设备能识别的较低层的具体____
    - 内存映射接口
      - 通过内存的字节数组来访问磁盘，不提供读/写磁盘____
      - 映射文件到内存的系统调用返回包含文件副本的一个虚拟内存____
      - 只在需要访问内存映像时，才由虚拟存储器实际____
      - 访问内存映射文件如同内存读/写一样简单，极大地方便了____

  - **网络设备接口**
    - 现代操作系统都提供面向网络的____
      - 需要提供相应的网络软件和网络通信____
      - 计算机可以通过网络与其他计算机进行通信或上网____
    - 网络I/O接口
      - 许多操作系统提供的网络I/O接口为网络____接口
      - 套接字接口的系统调用使应用程序创建的本地套接字连接到远程应用程序创建的____
      - 通过此连接发送和接收____

</ul>

##### **阻塞I/O & 非阻塞I/O**

<ul>

  - **阻塞I/O**
    - 当用户进程调用I/O操作时，进程会被____，并移到阻塞队列
    - I/O操作完成后，进程被____，移到就绪队列
    - 进程恢复执行时，收到系统调用的____，并继续处理数据
    - 大多数操作系统提供的I/O接口都是采用____I/O
    - 例子：
      - 你和女友去奶茶店买奶茶，点完单后，因为不知道奶茶什么时候做好
      - 所以只能一直____，其他什么事也不能干
    - 优点：
      - 操作____，实现难度低，适合并发量小的应用开发
    - 缺点：
      - I/O执行阶段进程会一直____下去

  - **非阻塞I/O**
    - 当用户进程调用I/O操作时，不____该进程
    - 进程需要不断询问I/O操作是否____，在I/O执行阶段，进程还可以做其他事情
    - 当问到I/O操作完成后，系统将数据从内核复制到____空间，进程继续处理数据
    - 例子：
      - 你和女友去奶茶店买奶茶，汲取了上次的教训，点完单后顺便逛逛____
      - 由于担心错过取餐，所以每隔一段时间就过来询问____
    - 优点：
      - 进程在等待I/O期间不会____，可以做其他事情，适合并发量大的应用开发
    - 缺点：
      - ____方式询问I/O结果，会占用CPU的时间

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>字符</li>
    <li>寻址</li>
    <li>中断</li>
    <li>顺序</li>
    <li>缓冲区</li>
    <li>指令</li>
    <li>参数</li>
    <li>独占</li>
    <li>共享</li>
    <li>数据块</li>
    <li>寻址</li>
    <li>DMA</li>
    <li>扇区</li>
    <li>线性</li>
    <li>打开</li>
    <li>操作</li>
    <li>操作</li>
    <li>地址</li>
    <li>调页</li>
    <li>程序员</li>
    <li>功能</li>
    <li>接口</li>
    <li>浏览</li>
    <li>套接字</li>
    <li>套接字</li>
    <li>数据</li>
    <li>阻塞</li>
    <li>唤醒</li>
    <li>返回值</li>
    <li>阻塞</li>
    <li>等待</li>
    <li>简单</li>
    <li>阻塞</li>
    <li>阻塞</li>
    <li>完成</li>
    <li>用户</li>
    <li>商场</li>
    <li>服务员</li>
    <li>阻塞</li>
    <li>轮询</li>
  </ul>
</details>
</div>

</ul>

</ul>

</ul>

### brief

<ul>

本节开头提出的问题的参考答案如下。

I/O管理要完成哪些功能？

O管理需要完成以下4部分内容：1）状态____。要能实时掌握外部设备的状态。2）设备____。要实现对设备的存取操作。3）设备____。在多用户环境下，负责设备的分配与回收。4）设备____。包括设备的驱动、完成和故障的中断处理。

<div>
<details>
  <summary> </summary>
  <ul>
    <li>跟踪</li>
    <li>存取</li>
    <li>分配</li>
    <li>控制</li>
  </ul>
</details>
</div>

</ul>

## 设备<span style="color: Gold;">独立</span>性<span style="color: GreenYellow;">软件</span>

<ul>

在学习本节时，请读者思考以下问题：

1）当处理机和外部设备的速度差距较大时，有什么办法can____问题？

2）什么是设备的____性？引入设备的____性有什么好处？

### 设备独立性软件

<ul>

- 设备独立性软件（与设备无关的软件）：
  - 位于I/O系统的最高层____。
  - 下层是设备____程序。
  - 软件与设备的界限因操作系统和设备的不同而有所____。

- 功能实现位置的差异：
  - 一些应由设备独立性软件实现的功能可能在设备____程序中实现。
  - 这种差异主要是出于多方面因素的____，包括运行效率等。

- 设备独立性软件的总体功能：
  - 包括执行所有设备____操作的软件。

<div>
<details>
  <summary> </summary>
  <ul>
    <li>解决</li>
    <li>独立</li>
    <li>独立</li>
    <li>软件</li>
    <li>驱动</li>
    <li>差异</li>
    <li>驱动</li>
    <li>权衡</li>
    <li>公有</li>
  </ul>
</details>
</div>

</ul>

### 高速缓存与缓冲区

<ul>

#### 磁盘高速缓存（DiskCache）

<ul>

##### 目的：

<ul>

>pro:  **设置磁盘缓冲区的目的（2015）**
  - 提高磁盘的访问**____**
<br>
  
  - 例如，
    - 正在运行进程的数据既存储在磁盘上
      - 又存储在物理____上
      - 也被复制到CPU的二级和一级高速____中
  - DiskCache
    - **不同于**通常意义下的 btween CPU and 内存之间的 <span style="color: LightSkyBlue;">____容量</span>高速存储器
    - 指utilize 
      - 内存中的存储____
      - 来暂存从磁盘中读出的一系列盘块中的信息
  -  → 磁盘高速缓存
     -  逻辑上属于____
     -  物理上则是驻留在内存中的____

</ul>

##### **磁盘高速缓存的形式**

<ul>

  - 两种形式
    - 在内存中开辟一个单独的空间作为____区
      - 大小____
    - 将未利用的内存空间作为一个缓冲____
      - 供请求分页系统和磁盘I/O时____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>速度</li>
    <li>内存</li>
    <li>缓存</li>
    <li>小</li>
    <li>空间</li>
    <li>磁盘</li>
    <li>盘块</li>
    <li>缓存</li>
    <li>固定</li>
    <li>池</li>
    <li>共享</li>
  </ul>
</details>
</div>

</ul>

</ul>

#### 缓冲区（Buffer）

<ul>

- **引入缓冲区的目的**
  - 缓和CPU与I/O设备间速度不____的矛盾
  - 减少对CPU的中断____，放宽对CPU中断响应时间的限制
  - 解决基本数据单元大小（数据____）不匹配的问题
  - 提高CPU和I/O设备之间的____性

- **缓冲区的实现方法**
  - 采用硬件____器
    - 但由于成本太高，除一些关键部位外，一般不采用硬件缓冲器
  - 利用内存作为____区
    - 根据系统设置缓冲区的个数，缓冲技术可以分为如下几种：

<div>
<details>
  <summary> </summary>
  <ul>
    <li>匹配</li>
    <li>频率</li>
    <li>粒度</li>
    <li>并行</li>
    <li>缓冲</li>
    <li>缓冲</li>
  </ul>
</details>
</div>

##### 单缓冲

<ul>

###### 基本概念与原理

<ul>

- 缓冲区分配
  - 每当用户进程发出I/O____时
    - 操作系统在内存中分配一个____区
      - 缓冲区大小通常为一个____

- 数据输入处理流程
  - 时间参数
    - T: 设备输入数据到缓冲区的____
    - M: 数据从缓冲区传送到工作区的____
    - C: CPU处理数据的____
  - 工作限制
    - 必须等待缓冲区装满后才能取出____

  ![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/0098ff41721b50a7f2f4813f3e810d1abfc0d5ac0327fc9235418282ddd0eaa2.jpg)
  - 图5.6单缓冲工作示意图

</ul>

###### 工作时间的理解与计算

<ul>

> **pro：单缓冲的工作时间的理解与计算（2011、2013）**

- 并行特性
  - 在单缓冲区中， $T$ 是可以和 $C$ ____的

- 两种工作情况分析
  - 情况1：$T>C$ (设备输入时间较长)
    - CPU处理一块完数据后，需等待缓冲区____
    - 平均处理一块数据的时间为 $\scriptstyle{____}$
  
  - 情况2：$T<C$ (CPU处理时间较长) 
    - 缓冲区装满后需等待CPU处理____
    - 平均处理一块数据的时间为 $____$

- 总结
  - 单缓冲区处理每块数据的平均时间为 $\mathrm{____}(C,T)+M$

</ul>

###### 资源互斥

<ul>

- 缓冲区作为共享资源的限制
  - 若CPU尚未取走缓冲区中的____，则即使设备又生产出新的数据，也无法将其送入缓冲区
  - 此时设备需要____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>请求</li>
    <li>缓冲</li>
    <li>块</li>
    <li>时间</li>
    <li>时间</li>
    <li>时间</li>
    <li>数据</li>
    <li>并行</li>
    <li>装满</li>
    <li>T+M</li>
    <li>完成</li>
    <li>C+M</li>
    <li>Max</li>
    <li>数据</li>
    <li>等待</li>
  </ul>
</details>
</div>

</ul>

##### 双缓冲

<ul>

###### 基本概念与目的

<ul>

- 为了加快输入和输出____，提高设备利用率，引入了双缓冲机制，也称缓冲对换

</ul>

###### 工作原理

<ul>

- 数据输入过程
  - 设备数据首先送入缓冲区1，装满后转向缓冲区____
  - 操作系统从缓冲区1取出____，送入用户进程进行CPU处理
  - 当缓冲区1数据处理完成后：
    - 若缓冲区2已满，则从缓冲区2取数据____
    - 同时设备可继续向缓冲区1输入____

###### 优势

- 提高了设备和CPU的____程度

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/74916f63bbadd3ecec51c79d9d7983076a15ba312169b06e359201300d17cbd5.jpg)
- 图5.7双缓冲工作示意图

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>速度</li>
    <li>2</li>
    <li>数据</li>
    <li>处理</li>
    <li>数据</li>
    <li>并行</li>
  </ul>
</details>
</div>

</ul>

##### 双缓冲的工作时间理解与计算

<ul>

> **pro：双缓冲的工作时间的理解与计算（2011）**

###### 双缓冲区的并行特性

<ul>

- 在双缓冲区中，$C$ 和 $M$ 是可以与 $T$ ____的

</ul>

###### 两种工作情况分析

<ul>

- 情况1：$T>C+M$ (设备输入时间较长)
  - 特点：设备输入的时间比数据传送和处理的时间多，可使设备连续____
  - 工作过程：
    - 初始状态：缓冲区1空，缓冲区2____
    - 并行操作：
      - 缓冲区2向工作区传送____
      - 缓冲区1开始装入____
    - 时间计算：
      - 传送并处理时间为 $____$
      - 必须等待缓冲区1____
      - 平均处理一块数据的时间为____

- 情况2：$T<C+M$ (CPU处理时间较长)
  - 特点：设备输入的时间比数据传送和处理的时间少，可使CPU不必等待设备____
  - 工作过程：
    - 初始状态：缓冲区1空，缓冲区2____
    - 并行操作：
      - 缓冲区2向工作区传送____
      - 缓冲区1开始装入____
    - 时间计算：
      - 缓冲区1装满用时为 $____$
      - 需等待缓冲区2数据处理____
      - 平均处理一块数据的时间为 $____$

</ul>

###### 总结

<ul>

- 双缓冲区处理每块数据的平均时间为 $\operatorname{____}(C+M,T)$

</ul>

###### 双机通信中的缓冲设置

<ul>

- 单缓冲限制：
  - 仅配置单缓冲时只能实现单方向数据____
  - ![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/9f47ca6462f4c404f4194111c41c4ca49f03430e3edac630d53319bd8b859779.jpg)
  - 图5.8双机通信时缓冲区的设置
- 双向传输解决方案：
  - 每台机器需设置两个缓冲区：
    - 一个用作发送____区
    - 一个用作接收____区

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>并行</li>
    <li>输入</li>
    <li>满</li>
    <li>数据</li>
    <li>数据</li>
    <li>C+M</li>
    <li>装满</li>
    <li>T</li>
    <li>输入</li>
    <li>满</li>
    <li>数据</li>
    <li>数据</li>
    <li>T</li>
    <li>完成</li>
    <li>C+M</li>
    <li>Max</li>
    <li>传输</li>
    <li>缓冲</li>
    <li>缓冲</li>
  </ul>
</details>
</div>

</ul>

</ul>

##### 循环缓冲

<ul>

###### 循环缓冲的引入背景

<ul>

- 双缓冲机制的局限性：
  - 当输入与输出速度基本匹配时效果较____
  - 当速度相差较大时效果不____
- 解决方案：
  - 引入多缓冲____
  - 采用循环缓冲区____
  - ![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/1567ec3a07d06f813ba74bebbedc891cf49d9587682fd38dc0cd9f2ccb14a9fb.jpg)
  - 图5.9循环缓冲工作示意图

</ul>

###### 循环缓冲的结构特点

<ul>

- 缓冲区组成：
  - 包含多个大小相等的____区
  - 每个缓冲区通过链接指针____
    - 指向下一个缓冲区
    - 最后一个指向第一个，形成循环____
- 指针设置：
  - in指针：
    - 指向第一个可输入数据的空____区
    - 输入时沿链接方向循环____
  - out指针：
    - 指向第一个可提取数据的满____区
    - 输出时沿链接方向循环____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>好</li>
    <li>理想</li>
    <li>机制</li>
    <li>形式</li>
    <li>缓冲</li>
    <li>连接</li>
    <li>队列</li>
    <li>缓冲</li>
    <li>移动</li>
    <li>缓冲</li>
    <li>移动</li>
  </ul>
</details>
</div>

</ul>

##### 缓冲池

<ul>

###### 缓冲池的定义与特点

<ul>

- 相比于缓冲区（仅是一块内存空间），缓冲池具有以下特点：
  - 包含管理自身的数据____和操作函数
  - 是一种管理多个____区的机制
  - 可供多个进程____使用

</ul>

###### 缓冲池的组成结构

<ul>

- 缓冲区分类：
  - 按使用状况分为三种____：
    - 空缓冲队列：由空缓冲区链接而成
    - 输入队列：由装满输入数据的缓冲区链接而成
    - 输出队列：由装满输出数据的缓冲区链接而成
  - 四种工作缓冲区：
    - hin：用于收容____数据
    - sin：用于提取____数据
    - hout：用于收容____数据
    - sout：用于提取____数据

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/d289d35f48846a698b12364bd9fc16928286068c4b2382e62ec3fc3de069c555.jpg)

</ul>

###### 缓冲池的工作方式

<ul>

- 收容输入过程：
  - 输入进程需要输入数据时：
    - 从空缓冲队列队首摘下空缓冲区作为收容输入工作____区
    - 将数据输入其中
    - 装满后将其挂到输入队列____
- 提取输入过程：
  - 计算进程需要输入数据时：
    - 从输入队列队首取得缓冲区作为提取输入工作____区
    - 从中提取____
    - 用完数据后将其挂到空缓冲队列____
- 收容输出过程：
  - 计算进程需要输出数据时：
    - 从空缓冲队列队首取得空缓冲区作为收容输出工作____区
    - 装满数据后将其挂到输出队列____
- 提取输出过程：
  - 输出进程需要输出数据时：
    - 从输出队列队首取得满缓冲区作为提取输出工作____区
    - 数据提取完后将其挂到空缓冲队列____

</ul>

###### 说明

<ul>

- 对于循环缓冲和缓冲池：
  - 仅定性介绍其____
  - 不进行定量研究处理____
- 对于单缓冲和双缓冲：
  - 可按模板分析解决任何情况下的数据块处理____问题

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>结构</li>
    <li>缓冲</li>
    <li>共享</li>
    <li>队列</li>
    <li>输入</li>
    <li>输入</li>
    <li>输出</li>
    <li>输出</li>
    <li>缓冲</li>
    <li>队尾</li>
    <li>缓冲</li>
    <li>数据</li>
    <li>队尾</li>
    <li>缓冲</li>
    <li>队尾</li>
    <li>缓冲</li>
    <li>队尾</li>
    <li>机理</li>
    <li>时间</li>
    <li>时间</li>
  </ul>
</details>
</div>

</ul>

</ul>

#### 高速缓存与缓冲区的对比

<ul>

- 高速缓存是可以保存数据拷贝的高速____，访问高速缓存比访问原始数据更高效，速度更快
- 高速缓存和缓冲区的对比见表5.1
  - ![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/c9e3499e84e502be34fe26707f8ea3406ae442f8b0a1385c94431ed9d0b18a22.jpg)

<div>
<details>
  <summary> </summary>
  <ul>
    <li>存储器</li>
  </ul>
</details>
</div>

</ul>

</ul>

### 设备分配与回收

<ul>

#### 设备分配概述

<ul>

- 设备分配是指according to用户的I/O____分配所需的设备
- 分配总原则
  - 充分发挥设备的使用____
  - 尽可能让设备____
  - 避免不合理分配造成进程____

<div>
<details>
  <summary> </summary>
  <ul>
    <li>请求</li>
    <li>效率</li>
    <li>忙碌</li>
    <li>死锁</li>
  </ul>
</details>
</div>

</ul>

#### 设备分配的数据结构

<ul>

##### 主要数据结构

<ul>

1. 设备控制表（DCT)
- 系统为every设备配置一张____
- 表项包含设备属性：
  - 设备类型（打印机、扫描仪、键盘等）
  - 设备____符（物理设备名，唯一）
  - 设备____（忙/闲）
  - 指向____表的指针
  - 重复执行次数or____
  - 设备队列的队首____

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/50bedf2c692be2ca6907ed975af28b99ad7a4d421d1db2be4ea6d0b52bb3bb8d.jpg)

> **attention:**
当某个进程释放某个设备，且无其他进程请求该设备时，系统将该设备DCT中的设备状态改为____，即可实现"设备回收"。

2. 控制器控制表（COCT)
- every设备控制器对应一张____
- 用于操作系统对控制器的操作和____
- 通过指针连接相应____信息

3. 通道控制表（CHCT)
- every通道对应一张____
- 用于操作系统对通道的操作和____
- 可管理多个____

4. 系统设备表（SDT)
- 整个系统只有一张____
- 记录所有物理设备____
- every物理设备对应一个____

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/60e89f67bc7c7e8d39295151c52c1a642494ef3f346209255067309200fbe0e1.jpg)

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>DCT</li>
    <li>标识</li>
    <li>状态</li>
    <li>控制器</li>
    <li>时间</li>
    <li>指针</li>
    <li>空闲</li>
    <li>COCT</li>
    <li>管理</li>
    <li>通道</li>
    <li>CHCT</li>
    <li>管理</li>
    <li>控制器</li>
    <li>SDT</li>
    <li>情况</li>
    <li>表目</li>
  </ul>
</details>
</div>

</ul>

#### 设备分配时应考虑的因素

<ul>

> **pro：设备分配需要考虑的因素（2023）**

##### 设备的固有属性

<ul>

- 独占设备
  - 分配给某进程后由其____
  - 直至进程完成or____
- 共享设备
  - 可同时分配给多个____
  - 需调度访问____
- 虚拟设备
  - 属于可____设备
  - 可同时分配给多____

</ul>

##### 设备分配算法

<ul>

- FCFS算法
  - according to请求先后次序____
  - 优先分配给队首____
- 最高优先级优先算法
  - 优先级高的进程排____
  - 同优先级按____原则

</ul>

##### 设备分配中的安全性

<ul>

- 安全分配方式
  - 进程发出I/O请求后进入____态
  - 直到I/O操作完成才____
  - 优点：设备分配____
  - 缺点：CPU和I/O设备____工作
- 不安全分配方式
  - 发出I/O请求后继续____
  - 仅当设备被占用时才____
  - 优点：可同时操作多个设备，进程推进____
  - 缺点：可能造成____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>独占</li>
    <li>释放</li>
    <li>进程</li>
    <li>次序</li>
    <li>共享</li>
    <li>进程</li>
    <li>排队</li>
    <li>进程</li>
    <li>前面</li>
    <li>FCFS</li>
    <li>阻塞</li>
    <li>唤醒</li>
    <li>安全</li>
    <li>串行</li>
    <li>运行</li>
    <li>阻塞</li>
    <li>迅速</li>
    <li>死锁</li>
  </ul>
</details>
</div>

</ul>

#### 设备分配的步骤

<ul>

##### 独占设备分配过程

<ul>

- 分配设备
  - 根据I/O请求中的物理设备名查找____
  - 找出该设备的____
  - 检查DCT中设备____
    - 若忙：将进程PCB挂到设备等待____
    - 若不忙：按策略分配给____

- 分配控制器
  - 根据DCT找到____
  - 查询控制器____
    - 若忙：将进程PCB挂到控制器等待____
    - 若不忙：分配给____

- 分配通道
  - 根据COCT找到____
  - 查询通道____
    - 若忙：将进程PCB挂到通道等待____
    - 若不忙：分配给____

</ul>

##### 设备独立性实现

<ul>

- 使用逻辑设备名代替物理____名
- 系统从SDT中查找该类____
  - 若第一个设备忙，查找第二个
  - 仅当所有设备都忙时，进程才进入等待____
  - 只要有一个可用，即进行____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>SDT</li>
    <li>DCT</li>
    <li>状态</li>
    <li>队列</li>
    <li>进程</li>
    <li>COCT</li>
    <li>状态</li>
    <li>队列</li>
    <li>进程</li>
    <li>CHCT</li>
    <li>状态</li>
    <li>队列</li>
    <li>进程</li>
    <li>设备</li>
    <li>设备</li>
    <li>队列</li>
    <li>分配</li>
  </ul>
</details>
</div>

</ul>

#### 逻辑设备名到物理设备名的映射

<ul>

> **pro：逻辑设备名和物理设备名的使用（2009）**

##### 逻辑设备表结构

<ul>

- 每个表项包含三部分
  - 逻辑设备____
  - 物理设备____
  - 设备驱动程序入口____

</ul>

##### 逻辑设备表设置方式

<ul>

- 系统单表方式
  - 整个系统只设一张____
  - 所有进程____
  - 适用于单用户____
  - ![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/c85a2f6629c4e51d71b94f0e6cf8bff514037b67078eb643178cf87c356cb01b.jpg)

- 用户独立表方式
  - 每个用户设置独立____
  - 可使用相同逻辑设备____
  - 适用于多用户____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>名</li>
    <li>名</li>
    <li>地址</li>
    <li>LUT</li>
    <li>共用</li>
    <li>系统</li>
    <li>LUT</li>
    <li>名</li>
    <li>系统</li>
  </ul>
</details>
</div>

</ul>

</ul>

### SPOOLing技术（假脱机技术）

<ul>

##### 基本概念与组成

<ul>

- 目的：缓和CPU与I/O设备速度____
- 原理：将独占设备改造为____设备
- 数据流向：低速I/O设备 ↔ 高速磁盘 ↔ ____
- ![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/74ebfe19ef0dda81579a41b2cb68df79d0cfd77a32596e82db4adfff9f3d2b18.jpg)

> **pro： SPOOLing技术的特点（2016）**

</ul>

##### 系统组成部分

<ul>

###### 输入井和输出井

<ul>

- 磁盘上的存储____
- 用途
  - 输入井：收容I/O设备输入____
  - 输出井：收容用户程序输出____
- 组织方式：进程数据以文件形式存储并____

</ul>

###### 缓冲区

<ul>

- 输入缓冲区：暂存输入设备____
- 输出缓冲区：暂存待输出____

</ul>

###### 控制进程

<ul>

- 输入进程：模拟脱机____
- 输出进程：模拟脱机____
- 井管理程序：控制作业与磁盘井间信息____

</ul>

</ul>

##### 打印机共享实现

<ul>

- 处理流程
  - 申请磁盘缓冲区存储打印____
  - 创建打印请求表并加入____
- 特点
  - 数据先存入____区
  - 实际打印在空闲时____
  - 用户感知____设备

</ul>

##### SPOOLing技术特点

<ul>

- 提高I/O____
- 实现设备____
- 提供虚拟设备____

</ul>

##### 时空权衡

<ul>

- 空间消耗：磁盘空间用于输入输出____
- 时间节省：通过高速磁盘中转提高____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>矛盾</li>
    <li>共享</li>
    <li>CPU</li>
    <li>区域</li>
    <li>数据</li>
    <li>数据</li>
    <li>链接</li>
    <li>数据</li>
    <li>数据</li>
    <li>输入</li>
    <li>输出</li>
    <li>交换</li>
    <li>数据</li>
    <li>队列</li>
    <li>缓冲</li>
    <li>进行</li>
    <li>独占</li>
    <li>速度</li>
    <li>共享</li>
    <li>功能</li>
    <li>井</li>
    <li>效率</li>
  </ul>
</details>
</div>

</ul>

### 设备驱动程序接口

<ul>

> **pro：设备驱动程序的功能（2013、2019、2023）**

##### 基本功能

<ul>

- 命令____与参数处理
- 请求合法性____
- I/O操作____
- 中断____

</ul>

> **pro：设备驱动程序的特点（2022）**

##### 程序特点

<ul>

- 实现I/O请求____
- 与I/O控制方式____
- 硬件____性强
- ROM固化____
- 支持多次____

</ul>

##### 接口统一要求

<ul>

- 标准化操作系统____
- 设备名称____机制
- 设备访问____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>转换</li>
    <li>检查</li>
    <li>控制</li>
    <li>处理</li>
    <li>转换</li>
    <li>相关</li>
    <li>相关</li>
    <li>实现</li>
    <li>调用</li>
    <li>接口</li>
    <li>转换</li>
    <li>保护</li>
  </ul>
</details>
</div>

</ul>

</ul>

### brief

<ul>

本节开头提出的问题的参考答案如下。

1）当处理机和外部设备的速度差距较大时，有什么办法can解决问题？

可采用____技术来缓解CPU与外设速度上的矛盾，即在某个地方（一般为主存）设立一片缓冲区，外设与CPU的输入/输出都经过缓冲区，这样外设和CPU就都不用互相等待。\
2）什么是设备的独立性？引入设备的独立性有什么好处？设备独立性是指用户在编程序时使用的设备与实际设备____。一个程序应独立于分配给它的某类设备的具体设备，即在用户程序中只指明I/O使用的设备____即可。

设备独立性有以下优点： ① 方便用户____。 $\circledcirc$ 使程序运行不受具体机器环境的____。 $\textcircled{3}$ 便于程序____。

<div>
<details>
  <summary> </summary>
  <ul>
    <li>缓冲</li>
    <li>无关</li>
    <li>类型</li>
    <li>编程</li>
    <li>限制</li>
    <li>移植</li>
  </ul>
</details>
</div>

</ul>

---

以上内容已按照要求完成挖空处理，并确保简洁明了，便于自我考察和反复记忆。每个次级标题下的挖空答案均以HTML折叠块形式列出，且未改变原有目录结构和内容。

以下是按照您的要求对提供的内容进行挖空处理后的结果，包含 Markdown 和 HTML 格式的折叠块，保留原有目录结构，挖空关键词、公式定理和关键步骤，并在每个次级标题下以折叠块形式给出答案。

---

## <span style="color: deepskyblue;">磁盘</span>和 <span style="color: Gold;">固态</span><span style="color: LightSkyBlue;">硬盘</span>

<ul>

在学习本节时，请读者思考以下问题：

1）在磁盘上进行一次读/写操作需要哪几部分时间？其中哪部分时间最长？

2）存储一个文件时，当一个磁道存储不下时，剩下的部分是存在同一个盘面的不同磁道好，还是存在同一个柱面上的不同盘面好？

本节主要介绍____管理的方式。学习本节时，要重点掌握计算一次____操作的时间，以及对于给定访盘的磁道序列，按照特定算法求出磁头通过的总磁道数及平均____数。

<div>
<details>
  <summary> </summary>
  <ul>
    <li>磁盘</li>
    <li>磁盘</li>
    <li>寻道</li>
  </ul>
</details>
</div>

</ul>

### 磁盘

<ul>

#### 磁盘的物理结构

<ul>

> **pro：磁盘容量的计算（2019）**

- 基本组成
  - 磁盘是表面涂有____物质的物理盘片
  - 通过____（导体线圈）从磁盘存取数据
  - 读/写操作时____固定，磁盘高速旋转

- 数据组织方式
  - ____：同心圆形式
    - 每个____与磁头一样宽
    - 一个盘面有上千个____
  - 扇区：____的划分
    - 每个扇区固定存储大小（如____）
    - 一个扇区称为一个____
  - 间隙：相邻____及扇区间的分隔，避免精度错误

> **attention:**

##### 现代磁盘分区特点

<ul>

- 不再将内外____划分为相同数目的扇区
- 将盘面划分为若干____
  - 同一____内的所有磁道具有相同的扇区数
  - 外层____的磁道拥有较内层____的磁道更多的扇区

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>磁性</li>
    <li>磁头</li>
    <li>磁头</li>
    <li>磁道</li>
    <li>磁道</li>
    <li>磁道</li>
    <li>磁道</li>
    <li>1KB</li>
    <li>盘块</li>
    <li>磁道</li>
    <li>磁道</li>
    <li>环带</li>
    <li>环带</li>
    <li>环带</li>
  </ul>
</details>
</div>

</ul>

#### 磁盘驱动器结构

<ul>

> **pro：将簇号转化为磁盘物理地址的过程（2019）**

- 基本组件
  - ____臂
  - 用于旋转磁盘的____
  - 用于数据输入/输出的____设备

- 磁盘组织结构
  - 多个盘片垂直堆叠组成____组
  - 每个盘面对应一个____
  - 所有____固定在一起，只能"共进退"
  - ____：所有盘片上相对位置相同的磁道组合

- 寻址特点
  - 最小寻址单位：____
  - 磁盘地址表示：____号·盘面号·扇区号

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/d4e0d181abdea47ec7802f4dd8f7c52b20cd866783db066ce1b13bf46bcb3fdc.jpg)

<div>
<details>
  <summary> </summary>
  <ul>
    <li>磁头</li>
    <li>转轴</li>
    <li>电子</li>
    <li>磁盘</li>
    <li>磁头</li>
    <li>磁头</li>
    <li>柱面</li>
    <li>扇区</li>
    <li>柱面</li>
  </ul>
</details>
</div>

</ul>

#### 磁盘分类

<ul>

- 按____移动方式
  - ____磁盘：磁头相对盘片径向固定
  - ____磁盘：磁头可移动

- 按盘片____方式
  - ____磁盘：盘片永久固定
  - ____磁盘：盘片可移动和替换

<div>
<details>
  <summary> </summary>
  <ul>
    <li>磁头</li>
    <li>固定头</li>
    <li>活动头</li>
    <li>固定</li>
    <li>固定盘</li>
    <li>可换盘</li>
  </ul>
</details>
</div>

</ul>

</ul>

### 磁盘的管理

<ul>

> **pro：新磁盘安装操作系统的过程（2021）**

#### 磁盘初始化

<ul>

> **pro：物理格式化的内容（2017、2021）**

- 低级格式化（____格式化）过程
  - 目的：使____控制器能进行读/写操作
  - 扇区组成
    - ____
    - 数据区域
    - ____
  - 控制信息
    - ____号、磁头号和扇区号标识
    - ____校验字段

<div>
<details>
  <summary> </summary>
  <ul>
    <li>物理</li>
    <li>磁盘</li>
    <li>头部</li>
    <li>尾部</li>
    <li>磁道</li>
    <li>CRC</li>
  </ul>
</details>
</div>

</ul>

#### 分区

<ul>

> **pro：逻辑格式化的内容（2017、2021）**

- 分区步骤
  - ____分区
    - 由一个或多个____组成
    - 分区信息记录在____引导记录
  - 逻辑格式化（____格式化）
    - 建立____系统数据结构
    - 初始化目录和____管理

- 簇的概念
  - 多个相邻____的组合
  - 文件存储特点
    - 一簇只能存放一个____
    - 占用空间必须是簇的____倍

<div>
<details>
  <summary> </summary>
  <ul>
    <li>物理</li>
    <li>柱面</li>
    <li>主</li>
    <li>高级</li>
    <li>文件</li>
    <li>空间</li>
    <li>扇区</li>
    <li>文件</li>
    <li>整数</li>
  </ul>
</details>
</div>

</ul>

#### 引导块

<ul>

- 系统启动过程
  - 初始化程序（____程序）功能
    - 初始化____
    - 加载____系统

- 引导程序存储
  - ____中存储小型自举装入程序
  - 磁盘____块存储完整引导程序

- Windows引导过程
  - 主引导记录（____）位于第0号扇区
    - 包含____代码
    - 包含____表
    - 包含____标志
  - 引导过程
    - ____代码读取MBR
    - 定位____分区
    - 读取____扇区
    - 加载____服务

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/b7c95873944cd60dc13dbc53e4afbb793e28c58949c335a8d0cf871b51830251.jpg)
图5.17Windows磁盘的引导

<div>
<details>
  <summary> </summary>
  <ul>
    <li>自举</li>
    <li>硬件</li>
    <li>操作</li>
    <li>ROM</li>
    <li>启动</li>
    <li>MBR</li>
    <li>引导</li>
    <li>分区</li>
    <li>引导</li>
    <li>ROM</li>
    <li>引导</li>
    <li>引导</li>
    <li>系统</li>
  </ul>
</details>
</div>

</ul>

#### 坏块

<ul>

- 坏块产生原因
  - 磁盘有____部件
  - ____能力弱

- 坏块处理方式
  - 简单磁盘（____控制器）
    - ____处理
    - ____表标记
  - 复杂磁盘
    - 控制器维护____列表
    - 使用____块替代（扇区备用）

<div>
<details>
  <summary> </summary>
  <ul>
    <li>移动</li>
    <li>容错</li>
    <li>IDE</li>
    <li>手动</li>
    <li>FAT</li>
    <li>坏块</li>
    <li>备用</li>
  </ul>
</details>
</div>

</ul>

</ul>

### 磁盘调度算法

<ul>

#### 磁盘的存取时间

<ul>

##### 时间组成

<ul>

- 一次磁盘读/写操作的时间由三部分决定：

  ###### ____时间 $T_s$

  <ul>

  - 将____移动到目的磁道所需的时间
  - 计算公式：$T_{s}=\boldsymbol{m}\!\times\!\boldsymbol{n}+\!____$
    - $m$ 是磁盘驱动器速度____(约0.2ms)
    - $s$ 是磁头臂____时间(约2ms)

  </ul>

  ###### ____时间 $T_{r}$

  <ul>

  - 磁头定位到要读/写____所需的时间
  - 计算公式：$T_{\mathrm{r}}\,{=}\,\frac{1}{2____}$
  - 典型值：
    - 硬盘(____转/分)：$T_{\mathrm{r}}$ 为5.55ms
    - 软盘(____转/分)：$T_{\mathrm{r}}$ 为50~100ms

  </ul>

  ###### ____时间 $T_{\mathrm{t}}$

  <ul>

  - 读出或写入数据所需的时间
  - 计算公式：$T_{\mathrm{t}}=\frac{____}{r N}$
    - $r$ 为每秒____数
    - $N$ 为一个____上的字节数
    - $b$ 为读/写____数

  </ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>寻道</li>
    <li>磁头</li>
    <li>s</li>
    <li>常数</li>
    <li>启动</li>
    <li>旋转延迟</li>
    <li>扇区</li>
    <li>r</li>
    <li>5400</li>
    <li>300~600</li>
    <li>传输</li>
    <li>b</li>
    <li>转</li>
    <li>磁道</li>
    <li>字节</li>
  </ul>
</details>
</div>

</ul>

##### 总平均存取时间

<ul>

- 计算公式：$T_{\mathrm{a}}=____+{\frac{1}{2r}}+{\frac{b}{r N}}$
- 特点：
  - ____时间占主要部分
  - 延迟时间和传输时间与____线性相关
  - 磁盘调度主要目标是减少平均____时间

<div>
<details>
  <summary> </summary>
  <ul>
    <li>T_{\mathrm{s}}</li>
    <li>寻道</li>
    <li>转速</li>
    <li>寻道</li>
  </ul>
</details>
</div>

</ul>

</ul>

#### 磁盘调度算法

<ul>

##### FCFS算法

<ul>

- 特点：按请求先后____进行调度
- 优点：具有____性
- 性能：
  - 少量进程访问时性能较好
  - 大量进程竞争时接近____调度

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/b8425ee5ae7ac3a0dcb06de61cb27fd6d3cb2c582e4f386dd8f6304e4a02e448.jpg)

<div>
<details>
  <summary> </summary>
  <ul>
    <li>顺序</li>
    <li>公平</li>
    <li>随机</li>
  </ul>
</details>
</div>

</ul>

##### SSTF算法

<ul>

> **pro：磁盘调度STTF算法的应用（2019、2021）**

- 特点：选择与当前____最近的磁道
- 优点：比FCFS提供更好____
- 缺点：可能产生____现象

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/dd06b9fc1246a34569fc5258e8248c831db19702f82bda8b3c8ac1f790936d8f.jpg)

<div>
<details>
  <summary> </summary>
  <ul>
    <li>磁头</li>
    <li>性能</li>
    <li>饥饿</li>
  </ul>
</details>
</div>

</ul>

##### SCAN算法

<ul>

> **pro：磁盘调度SCAN算法的应用（2009、2010、2015）**

- 特点：
  - 规定____移动方向
  - 类似____运行方式
- 缺点：对最近扫描区域不____

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/e23ff7834fc7dfb47ca7bc3bb816adfab1acd589aaf1e86fdaa754dd62d5b6c2.jpg)

<div>
<details>
  <summary> </summary>
  <ul>
    <li>磁头</li>
    <li>电梯</li>
    <li>公平</li>
  </ul>
</details>
</div>

</ul>

##### C-SCAN算法

<ul>

> **pro：磁盘高度CSCAN算法的应用（2024）**

- 特点：
  - 磁头____移动服务
  - 返回时____移动不服务
- 改进：避免SCAN算法的____性

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/f7b3b0423047721711f42f621ef0d8fa676a86199461550c1a35cce3dcbc5774.jpg)

<div>
<details>
  <summary> </summary>
  <ul>
    <li>单向</li>
    <li>快速</li>
    <li>偏向</li>
  </ul>
</details>
</div>

</ul>

##### LOOK和C-LOOK算法

<ul>

- LOOK调度：改进的____算法
- C-LOOK调度：改进的____算法
- 特点：只移动到最远端____位置

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/0b7af4079ce1508170cfd0c6785a935c544146c6fba1615004413e098e803166.jpg)

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/1361b6282bbb7ccca8e902c8b775efe191ce31127575de272a9b094e4bb963ad.jpg)

表5.2四种磁盘调度算法的优缺点
![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/306473ea1dc03b13f75a7b4b6cbbcb37604ee92c9a16855a4334e74fb2115f52.jpg)

<div>
<details>
  <summary> </summary>
  <ul>
    <li>SCAN</li>
    <li>C-SCAN</li>
    <li>请求</li>
  </ul>
</details>
</div>

</ul>

</ul>

#### 减少延迟时间的方法

<ul>

##### 扇区交替编号

<ul>

- 目的：减少连续块读取的____时间
- 方法：逻辑相邻块在物理上保持____

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/83716c397933becb5f3149d21af881a9f2546dee402d24683822bd761c10df62.jpg)

<div>
<details>
  <summary> </summary>
  <ul>
    <li>延迟</li>
    <li>间隔</li>
  </ul>
</details>
</div>

</ul>

##### 盘面错位命名

<ul>

- 目的：减少不同盘面连续块读取的____时间
- 方法：对不同盘面进行____编号

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/b4df78520dc3118e1f94059fd6b9289b5f4251ad8466d09eec81bd5d52552ff9.jpg)

<div>
<details>
  <summary> </summary>
  <ul>
    <li>延迟</li>
    <li>错位</li>
  </ul>
</details>
</div>

</ul>

</ul>

#### 提高磁盘I/O速度的方法

<ul>

> **pro：改善磁盘I/O性能的方法（2012、2018）**

- 采用磁盘____缓存
- 调整磁盘____顺序
- ____读
- 优化____块分布
- 使用____盘
- 采用磁盘阵列____

<div>
<details>
  <summary> </summary>
  <ul>
    <li>高速</li>
    <li>请求</li>
    <li>提前</li>
    <li>物理</li>
    <li>虚拟</li>
    <li>RAID</li>
  </ul>
</details>
</div>

</ul>

</ul>

### 固态硬盘

<ul>

#### 固态硬盘的特性

<ul>

##### 基本结构

<ul>

- 组成：
  - ____芯片
  - ____翻译层

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/cb88f8cf9e4953f156d5cc0c0cdec68d55bd14ebc65d9f36e4c13544b6ab9744.jpg)

<div>
<details>
  <summary> </summary>
  <ul>
    <li>闪存</li>
    <li>闪存</li>
  </ul>
</details>
</div>

</ul>

##### 工作特点

<ul>

- 读写单位：以____为单位
- 写入限制：需要先擦除整个____
- 性能特点：
  - 随机写入较____
  - 无____部件
  - ____低
  - ____性好

<div>
<details>
  <summary> </summary>
  <ul>
    <li>页</li>
    <li>块</li>
    <li>慢</li>
    <li>机械</li>
    <li>能耗</li>
    <li>抗震</li>
  </ul>
</details>
</div>

</ul>

</ul>

#### 磨损均衡

<ul>

##### 问题

<ul>

- 闪存擦写____有限
- 磨损不均衡导致整块____

<div>
<details>
  <summary> </summary>
  <ul>
    <li>寿命</li>
    <li>损坏</li>
  </ul>
</details>
</div>

</ul>

##### 解决方案

<ul>

###### 动态磨损均衡

<ul>

- 写入时选择较新____块

<div>
<details>
  <summary> </summary>
  <ul>
    <li>闪存</li>
  </ul>
</details>
</div>

</ul>

###### 静态磨损均衡

<ul>

- 自动监测数据____
- 平衡各____块使用

<div>
<details>
  <summary> </summary>
  <ul>
    <li>分配</li>
    <li>闪存</li>
  </ul>
</details>
</div>

</ul>

</ul>

</ul>

</ul>

</ul>

### brief

<ul>

本节开头提出的问题的参考答案如下。

1）在磁盘上进行一次读/写操作需要哪几部分时间？其中哪部分时间最长？

在磁盘上进行一次读/写操作花费的时间由____时间、____时间和____时间决定。其中____时间是将磁头移动到指定磁道所需要的时间，____时间是磁头定位到某一磁道的扇区（块号）所需要的时间，____时间是从磁盘读出or向磁盘写入数据所经历的时间。一般来说，____时间因为要移动磁头臂，所以占用时间最长。

2）存储一个文件时，当一个磁道存储不下时，剩下部分是存在同一个盘面的不同磁道好，还是存在同一个柱面上的不同盘面好？

上一问已经说到，____时间对于一次磁盘访问的影响是最大的，若存在同一个盘面的不同____，则磁头臂势必要移动，这样会大大增加文件的访问时间，而存在同一个____上的不同盘面就不需要移动磁道，所以一般情况下存在同一个____上的不同盘面更好。

<div>
<details>
  <summary> </summary>
  <ul>
    <li>寻道</li>
    <li>延迟</li>
    <li>传输</li>
    <li>寻道</li>
    <li>延迟</li>
    <li>传输</li>
    <li>寻道</li>
    <li>寻道</li>
    <li>磁道</li>
    <li>柱面</li>
    <li>柱面</li>
  </ul>
</details>
</div>

</ul>

## 本章疑难点

<ul>

#### 为了增加设备分配的灵活性、成功率，can如何改进？

<ul>

can从以下两方面对基本的设备分配程序加以改进：

1）增加设备的____性。进程使用____设备名请求I/O。这样，系统首先从____中找出第一个该类设备的____。若该设备忙，则又查找第二个该类设备的____。仅当所有该类设备都忙时，才将进程挂到该类设备的等待队列上；只要有一个该类设备可用，系统便进一步计算分配该设备的安全性。

2）考虑____情况。为防止I/O系统的“瓶颈”现象，通常采用____的I/O系统结构。此时对____和____的分配同样要经过几次反复，即若设备（控制器）所连接的第一个控制器（通道）忙时，则应查看其所连接的第二个控制器（通道），仅当所有控制器（通道）都忙时，此次的控制器（通道）分配才算失败，才将进程挂到控制器（通道）的等待队列上。而只要有一个控制器（通道）可用，系统便可将它分配给进程。

设备分配过程中，先后分别访问的数据结构为____→____→____→____。要成功分配一个设备，必须要： ① 设备可用： $\circledcirc$ ____可用： $\textcircled{3}$ ____可用。所以，“设备分配，要过三关”。

<div>
<details>
  <summary> </summary>
  <ul>
    <li>独立</li>
    <li>逻辑</li>
    <li>SDT</li>
    <li>DCT</li>
    <li>DCT</li>
    <li>多通路</li>
    <li>多通路</li>
    <li>控制器</li>
    <li>通道</li>
    <li>SDT</li>
    <li>DCT</li>
    <li>COCT</li>
    <li>CHCT</li>
    <li>控制器</li>
    <li>通道</li>
  </ul>
</details>
</div>

</ul>

#### 什么是用户缓冲区、内核缓冲区？

<ul>

5.1.4节中讨论过：“O操作完成后，系统将数据从内核复制到用户空间”，这里说的是“内核”其实是指____缓冲区，“用户空间”是指____缓冲区。

用户缓冲区是指当用户进程读文件时，通常先申请一块内存数组，称为____，用来存放读取的数据。每次____调用，将读取的数据写入____，之后程序都从____中获取数据，当____使用完后，再进行下一次调用，填充____。可见，用户缓冲区的目的是减少____调用次数，从而降低系统在用户态与核心态之间切换的开销。

内核也有自己的缓冲区。当用户进程从磁盘读取数据时，不直接读____，而将____缓冲区中的数据复制到____缓冲区中。若____缓冲区中没有数据，则内核请求从____读取，然后将进程挂起，为其他进程服务，等到数据已读取到____缓冲区中时，将____缓冲区中的数据复制到用户进程的缓冲区，才通知进程（当然，I/O模型不同，处理的方式也不同）。当用户进程需要写数据时，数据可能不直接写入____，而将数据写入____缓冲区，时机适当时（如____缓冲区的数据积累到一定量后），内核才将____缓冲区的数据写入____。可见，内核缓冲区是为了在操作系统级别提高____I/O效率，优化____写操作。

<div>
<details>
  <summary> </summary>
  <ul>
    <li>内核</li>
    <li>用户</li>
    <li>Buffer</li>
    <li>read</li>
    <li>Buffer</li>
    <li>Buffer</li>
    <li>Buffer</li>
    <li>Buffer</li>
    <li>系统</li>
    <li>磁盘</li>
    <li>内核</li>
    <li>用户</li>
    <li>内核</li>
    <li>磁盘</li>
    <li>内核</li>
    <li>内核</li>
    <li>磁盘</li>
    <li>内核</li>
    <li>内核</li>
    <li>磁盘</li>
    <li>磁盘</li>
    <li>磁盘</li>
  </ul>
</details>
</div>

</ul>

</ul>


