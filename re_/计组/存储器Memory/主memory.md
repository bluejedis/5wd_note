#  <span style="color: silver;">above  

##  <span style="color: silver;">【考纲内容】  

（一）存储器的分类  

（二）层次化存储器的基本结构  

（三）半导体随机存储器（RAM）SRAM、DRAM、Flash存储器  

（四）主存储器DRAM芯片和内存条、多模块存储器、主存储器和CPU之间的连接  

（五）外部存储器磁盘存储器、固态硬盘（SSD）  

（六）高速缓冲存储器（Cache）Cache的基本原理：Cache和主存之间的映射方式Cache中主存块的替换算法：Cache写策略  

（七）虚拟存储器  

虚拟存储器的基本概念页式虚拟存储器：基本原理、页表、地址转换、TLB（快表）段式虚拟存储器的基本原理：段页式虚拟存储器的基本原理  

##  <span style="color: silver;">【复习提示】  

- 本章命题重点：
  - 特别关注Cache和虚拟存储器相关内容，这些考点容易出综合题。
  - 存储器的特点、扩展（芯片选择、连接方式、地址范围等）、交叉存储器也常考。
  - Cache的相关计算与替换算法是重要考点。
  - 虚拟存储器与TLB（Translation Lookaside Buffer）也是考试重点。


- 地址翻译与Cache映射问题：
  - 掌握存在Cache和TLB的计算机中的地址翻译机制。
  - 理解Cache映射问题。

- 学习建议：
  - 掌握基本原理，并多结合习题进行反复训练。
  - 深化理解并巩固知识。


  <details>
  <summary>学习本章时的思考问题：</summary>


  1. 存储器系统分层次的原因：
     - 为什么存储器系统需要分层次？
     - 计算机如何管理这些层次？

  2. 影响Cache性能的因素：
     - 有哪些因素会影响Cache的性能？

  3. 虚拟存储系统页面大小的选择：
     - 虚拟存储系统的页面是设置得大一些好还是小一些好？
</details>


# 存储器概述  

## 存储器的分类  

存储器种类繁多，可从不同角度对存储器进行分类。  

### 按在计算机中的作用（层次）分类  
- 主存储器
  - 简称主存，也称内存储器（内存）
  - 用途：存放计算机运行期间所需的程序和数据
  - 特点：
    - CPU可以直接随机访问
    - 可与Cache及辅助存储器交换数据
    - 容量较小
    - 存取速度较快
    - 每位价格较高

- 辅助存储器
  - 简称辅存，也称外存储器或外存
  - 用途：存放当前暂时不用的程序和数据，以及需要永久性保存的信息
  - 特点：
    - 需要调入主存后才能被CPU访问
    - 容量大
    - 存取速度较慢
    - 单位成本低

- 高速缓冲存储器
  - 简称Cache
  - 位置：位于主存和CPU之间
  - 用途：存放当前CPU经常使用的指令和数据
  - 特点：
    - 存取速度可与CPU速度匹配
    - 存储容量小
    - 价格高
    - 现代计算机通常将其制作在CPU中

### 按存储介质分类  
- 磁表面存储器
  - 磁盘
  - 磁带
- 磁芯存储器
- 半导体存储器
  - MOS型存储器
  - 双极型存储器
- 光存储器
  - 光盘

### 按存取方式分类  

> pro：采用随机存取的存储器（2011）  

- 随机存储器（RAM)
  - 特点：
    - 任何存储单元都可以随机存取
    - 存取时间与存储单元物理位置无关
  - 优点：读/写方便、使用灵活
  - 用途：主要用作主存或高速缓冲存储器
  - 分类：
    - 静态RAM
    - 动态RAM

- 只读存储器（ROM）
  - 特点：
    - 内容只能随机读出不能写入
    - 断电内容不会丢失
    - 写入速度比读取速度慢得多
  - 用途：存放固定不变的程序、常数和汉字字库等
  - 功能：可与随机存储器共同作为主存的一部分

- 串行访问存储器
  - 特点：需按物理位置先后顺序寻址
  - 类型：
    - 顺序存取存储器（如磁带）
      - 特点：存取速度慢，按顺序存取
    - 直接存取存储器（如磁盘、光盘）
      - 特点：介于RAM和顺序存取之间
      - 存取方式：先寻找小区域，再在区域内顺序查找

### 按信息的可保存性分类  
- 易失性存储器
  - 特点：断电后信息消失
  - 示例：RAM

- 非易失性存储器
  - 特点：断电后信息保持
  - 类型：
    - ROM
    - 磁表面存储器
    - 光存储器

#### 按读出方式分类
- 破坏性读出
  - 特点：读出时原存储信息被破坏
  - 要求：每次读出后需要进行再生操作

- 非破坏性读出
  - 特点：读出时原存储信息不被破坏
## 存储器的性能指标  

### 三个主要性能指标
- 存储容量
- 单位成本  
- 存储速度

#### 具体说明
- 存储容量
  - 计算公式：存储容量 = 存储字数 × 字长（如1M×8位）
  - 单位换算：1B（Byte，字节）= 8b (bit，位)
  - 说明：
    - 存储字数表示存储器的地址空间大小
    - 字长表示一次存取操作的数据量

- 单位成本
  - 计算公式：每位价格 = 总成本/总容量

- 存储速度
  - 计算公式：数据传输速率 = 数据的宽度/存取周期
  - 重要参数：
    - 存取时间（Ta）
      - 定义：从启动一次存储器操作到完成该操作所经历的时间
      - 分类：读出时间和写入时间
    - 存取周期（Tm）
      - 定义：存储器进行一次完整的读/写操作所需的全部时间
      - 特点：连续两次独立访问存储器操作之间所需的最小时间间隔
    - 主存带宽（Bm）
      - 别称：数据传输速率
      - 含义：每秒从主存进出信息的最大数量
      - 单位：字/秒、字节/秒（B/s）或位/秒（b/s)

#### 存取时间与存取周期的关系
- 基本关系：存取周期大于存取时间
- 原因：
  - 读/写操作后需要恢复内部状态
  - 对于破坏性读出的存储器，可达Tm = 2Ta
- 示意图：

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/21f64fafd194c1ba1c6165c7728968a6e8ae536402c6539569c4d4e7c1719c0f.jpg)  
图3.1存取时间与存取周期的关系  

## 多级层次的存储系统  

### 系统特点
- 层次结构特征：
  - 由上至下：
    - 位价越来越低
    - 速度越来越慢
    - 容量越来越大
    - CPU访问频度越来越低
- 主要层次：
  - Cache-主存层
  - 主存-辅存层

### 系统结构
- 信息交换方式：
  - Cache、主存能与CPU直接交换信息
  - 辅存需通过主存与CPU交换信息
  - 主存与CPU、Cache、辅存都能交换信息
- 结构示意图：

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/ecbfb7431920fae95ef8cac047bea026b1dcf473fe23120161d91a5948c10f1a.jpg)  
图3.2多级存储器结构  

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/3695ac60caa0ef8aa0adc0813638b48ef2f1586374984cdd5278a8b6809a560d.jpg)  
图3.3三级存储系统的层次结构及其构成  

### 工作原理
- CPU数据存取过程：
  - 先访问Cache
  - 若不在Cache中，则访问主存
  - 若不在主存中，则访问磁盘
  - 数据读取路径：磁盘→主存→Cache

### 系统优势
- Cache-主存层：
  - 速度接近Cache
  - 容量和位价接近主存
- 主存-辅存层：
  - 速度接近主存
  - 容量和位价接近辅存

### 层次功能
- Cache-主存层：
  - 主要功能：解决CPU和主存速度不匹配问题
  - 数据调动：由硬件自动完成
  - 特点：对所有程序员透明
- 主存-辅存层：
  - 主要功能：解决存储系统容量问题
  - 数据调动：由硬件和操作系统共同完成
  - 特点：对应用程序员透明

### 发展趋势
- 虚拟存储系统的形成：
  - 特点：程序员编程地址范围与虚拟存储器地址空间对应
  - 优势：可用地址空间远大于主存空间

> attention：  

- 在Cache一主存层和主存一辅存层中，上一层中的内容都只是下一层中的内容的副本
  - 也即Cache（或主存）中的内容只是主存（或辅存）中的内容的一部分。



# 主存储器  

## SRAM DRAM  

半导体存储器分为随机存储器（RAM）和只读存储器（ROM）。RAM又分为静态随机存储器（SRAM）和动态随机存储器（DRAM），主存储器主要由DRAM实现，靠近处理器的那一层（Cache）则由SRAM实现，它们都是易失性存储器。ROM是非易失性存储器。  

### SRAM的工作原理  
- 基本概念
  - 存储元：存放一个二进制位的物理器件，是存储器的最基本构件
  - 存储单元：地址码相同的多个存储元构成
  - 存储体：若干存储单元的集合

- 工作特点
  - 使用双稳态触发器（六晶体管MOS）记忆信息
  - 静态特性：信息读出后保持原状态，无需再生（非破坏性读出）
  - 性能特征：
    - 存取速度快
    - 集成度低
    - 功耗较大
    - 价格昂贵
  - 主要用途：高速缓冲存储器

### DRAM的工作原理  
#### 基本特性
- 存储原理：利用存储元电路中栅极电容上的电荷存储信息
- 基本结构：通常只使用一个晶体管
- 与SRAM对比优势：
  - 密度更高
  - 集成度高
  - 位价低
  - 功耗低
- 主要缺点：
  - 存取速度较慢
  - 需要定时刷新和读后再生
- 主要用途：大容量主存系统

> pro：需要刷新的存储芯片：SDRAM（2015）  

#### 工作特点
- 电荷维持时间：$1\sim2\mathrm{ms}$
- 读操作特性：破坏性读出，需读后再生
- 刷新周期：相邻两次刷新的时间间隔，通常为$2\mathrm{ms}$

#### 刷新方式
##### 集中刷新
- 特点：
  - 在固定时间内逐一对所有行再生
  - 刷新期间停止读/写操作（死时间/访存死区）
- 优点：读/写操作不受刷新影响
- 缺点：刷新期间不能访问存储器

##### 分散刷新
- 工作方式：后半部分用于刷新
- 影响：增加系统存取周期（如$0.5\mu\mathrm{s}$到$1\mu\mathrm{s}$）
- 优点：没有死区
- 缺点：加长系统存取周期

##### 异步刷新
- 原理：结合集中和分散刷新方法
- 实现方式：
  - 将刷新周期除以行数
  - 按间隔时间产生刷新请求
- 优势：死时间分布更分散，减少CPU等待时间

#### 刷新注意事项
- 刷新对CPU透明，不依赖外部访问
- 以行为单位，由芯片内部生成行地址
- 刷新操作类似读操作但有区别
- 刷新时无需选片，所有芯片同时刷新

> attention：  

- 虽然DRAM的刷新和再生都是恢复数据，但刷新与再生的过程并不完全相同。
  - 刷新是以行为单位，逐行恢复数据的，而再生仅需恢复被读出的那些单元的数据。  

> pro：DRAM芯片行缓冲器容量的计算（2022）  

#### SDRAM特性
- 工作方式：与CPU同步交换数据
- 与传统DRAM区别：
  - 传统DRAM：
    - 采用异步方式
    - CPU需等待读/写完成
  - SDRAM：
    - 采用同步方式
    - 锁存地址和控制信号
    - CPU可同时进行其他操作
- 操作特点：
  - 在系统时钟控制下进行
  - 支持突发传输
  - 首次给出首地址
  - 整行数据送入行缓冲器
  - 每个时钟连续输出数据
- 行缓冲器：
  - 功能：缓存指定行中整行数据
  - 大小：列数×位平面数
  - 实现方式：通常用SRAM
### DRAM芯片的读/写周期  
#### 读/写周期时序图
- 为了使芯片能正确接收行、列地址并实现读写操作，各信号的时间关系应符合一定要求
- 读（写）周期时间 $t_{\mathrm{{RC}}}$  $t_{\mathrm{{wc}}}$ ）表示DRAM芯片进行两次连续读（写）操作时所必须间隔的时间
- 读周期特点：
  - 在RAS有效前将行地址送到芯片的地址引I脚
  - CAS滞后RAS一段时间
  - 在CAS有效前再将列地址送到芯片的地址引脚
  - RAS、CAS应分别至少保持 $t_{\mathrm{RAS}}$ 和 $t_{\mathrm{CAS}}$ 的时间
  - 在读周期中WE为高电平，并在CAS有效前建立

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/ac49c5139324c976bef95c5760eecc986130d9c6997bdc4b888ceda236371d26.jpg)  
图3.4DRAM芯片读/写周期时序图  

- 写周期特点：
  - 行列选通信号的时序关系和读周期相同
  - WE为低电平，同样在CAS有效前建立
  - 为了保证数据可靠地写入，写数据必须在CAS有效前在数据总线上保持稳定

### SRAM DRAM  
- 表3.1详细列出了SRAM和DRAM各自的特点

表3.1SRAM DRAM
![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/247e4075afae5a6921141e41eb4721eb9e64db737333bbae6ebd4d1ecd2c7aab.jpg)  

### 存储器芯片的内部结构  
![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/2516f94b368ccd12877ec553c7401ec98c5b18224a062f7a42b548d1c7b596b4.jpg)  
图3.5存储器芯片结构图  

#### 存储体（存储矩阵）
- 存储体是存储单元的集合
- 由行选择线（X）和列选择线（Y）来选择所访问单元
- 存储体的相同行、列上的多位（位平面数）同时被读出或写入

#### 地址译码器
- 用途：将地址转换为译码输出线上的高电乎，以便驱动相应的读/写电路
- 译码方式：
  ##### 单译码法（一维译码）
  - 只有一个行译码器
  - 同一行中所有存储单元的字线连在一起
  - 同一行中的各单元构成一个字，被同时读出或写入
  - 缺点：地址译码器的输出线数过多
  
  ##### 双译码法（二维译码）
  - 地址译码器分为X和Y方向两个译码器
  - 在选中的行和列交叉点上能确定一个存储单元
  - 是DRAM芯片目前普遍采用的译码结构

#### I/O控制电路
- 用以控制被选中的单元的读出或写入
- 具有放大信息的作用

#### 片选控制信号
- 单个芯片容量太小，往往满足不了计算机对存储器容量的要求
- 需用一定数量的芯片进行存储器的扩展
- 在访问某个字时，必须"选中"该存储字所在的芯片，而其他芯片不被"选中"
- 因此需要有片选控制信号

#### 读/写控制信号
- 根据CPU给出的读命令或写命令，控制被选中单元进行读或写
## 只读存储器  

### 只读存储器（ROM）的特点  

> pro：RAM和ROM的区别（2010）  

ROM和RAM都是支持随机访问的存储器，其中SRAM和DRAM均为易失性半导体存储器。而ROM中一旦有了信息，就不能轻易改变，即使掉电也不会丢失。ROM具有两个显著的优点：
- 结构简单，所以位密度比可读/写存储器的高
- 具有非易失性，所以可靠性高

### ROM的类型  

#### 掩模式只读存储器  
- MROM的内容由半导体制造厂按用户提出的要求在芯片的生产过程中直接写入，写入以后任何人都无法改变其内容
- 优点：
  - 可靠性高
  - 集成度高
  - 价格便宜
- 缺点：
  - 灵活性差

#### 一次可编程只读存储器  
- PROM是可以实现一次性编程的只读存储器
- 允许用户利用专门的设备（编程器）写入自己的程序，一旦写入，内容就无法改变

#### 可擦除可编程只读存储器  
- EPROM不仅可以由用户利用编程器写入信息，而且可以对其内容进行多次改写
- 局限性：
  - 编程次数有限
  - 写入时间过长
  - 不能取代RAM

#### Flash存储器  

> pro：Flash存储器的特点（2012）  

- 在EPROM基础上发展
- 特点：
  - 兼有ROM和RAM的优点
  - 可在不加电情况下长期保存信息
  - 能在线进行快速擦除与重写
  - 价格便宜
  - 集成度高
  - 擦除重写速度快

#### 固态硬盘（Solid State Drive，SSD）
- 基本组成：
  - 控制单元
  - 存储单元（Flash芯片）
- 特点：
  - 保留Flash存储器优点
  - 读/写速度快
  - 低功耗
- 缺点：
  - 价格较高

### 主存储器的基本组成  

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/32d7adac4f2bd43918e63a15cb75067abfdb78b3072fd13466d39b41b1a285a2.jpg)  
图3.6主存储器的基本组成框图  

#### 存储矩阵结构
- 由存储元件（记忆单元）构成
  - 存储元件是具有两种稳态的能表示二进制0和1的物理器件
- 编址方式：
  - 可按字节编址
  - 可按字编址
  - 现代计算机通常采用字节编址

#### 存储器访问过程
- CPU操作步骤：
  - 将被访问单元地址送到MAR
  - 通过地址线将主存地址送到主存地址寄存器
  - 发送读/写信号到控制电路
- 写操作流程：
  - CPU将数据送到MIDR
  - 通过数据线写入选中单元
- 读操作流程：
  - 主存读出选中单元内容
  - 通过数据线送到MDR

#### 硬件特性
- MDR位数与数据线位数相同
- MAR位数与地址线位数相同
- 地址空间范围：0~2^地址线位数-1

> attention：  

- 数据线的位数通常等于存储字长
  - 因此MIDR的位数通常等于存储字长
- 若数据线的位数不等于存储字长
  - 则MIDR的位数由数据线的位数决定  

##### DRAM芯片特性
###### 地址引脚复用技术
- 背景：
  - DRAM芯片容量较大，地址位数较多
- 目的：
  - 减少芯片的地址引脚数
- 实现方式：
  - 行地址和列地址通过相同的引脚分先后两次输入
- 效果：
  - 地址引脚数可减少一半

> pro：DRAM芯片行、列数的优化原则（2018）  

###### 行列数优化原则
- 基本参数：
  - 存储容量：$2^{n}{\times}b$ 位
  - 行数：r
  - 列数：c
  - 关系：$2^{n}=r\times\!c$
- 地址位数：
  - 总地址位数：n
  - 行地址位数：$\log_{2}r$
  - 列地址位数：$\log_{2}c$
  - 关系：$n=\log_{2}r+\log_{2}c$
- 优化要求：
  - 减少地址引脚数：$|r–c|$ 最小
  - 减少刷新开销：$r\leqslant c$

#### 多模块存储器
- 定义：一种空间并行技术
- 目的：提高存储器的吞吐率
- 实现方式：利用多个结构完全相同的存储模块并行工作
- 常见类型：
  - 单体多字存储器
  - 多体低位交叉存储器
> attention：  

- CPU的速度比存储器快得多
- 若同时从存储器中取出 $n$ 条指令
  - 就可以充分利用CPU资源，提高运行速度

多体交叉存储器就是基于这种思想提出的。  


### 单体多字存储器
- 基本特点：
  - 每个存储单元存储m个字
  - 总线宽度为m个字
  - 一次并行读出m个字
- 工作过程：
  - 一个存取周期内从同一地址取出m条指令
  - 将指令逐条送至CPU执行
  - 每隔1/m存取周期，CPU向主存取一条指令
- 缺点：
  - 仅在指令和数据连续存放时有效
  - 遇到转移指令或操作数不连续时效果不明显

### 多体并行存储器
- 基本组成：
  - 由多个相同容量和存取速度的模块组成
  - 每个模块具有独立的：
    - 读/写控制电路
    - 地址寄存器
    - 数据寄存器
  - 可并行工作也可交叉工作

#### 编址方式分类
##### 高位交叉编址（顺序方式）
- 地址划分：
  - 高位表示模块号（体号）
  - 低位表示模块内地址（体内地址）

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/75d2ac2a627c5bcdace95fe592ef3010583976cec7fbd37807fc2eed52d25b78.jpg)  
图3.7高位交叉编址的多体存储器  

- 工作特点：
  - 低位体内地址送到高位体号确定的模块内译码
  - 连续访问时在一个模块内完成
  - 各模块不能并行访问
  - 不能提高存储器吞吐率

> attention：  

模块内的地址是连续的，存取方式仍是串行存取，因此这种存储器仍是顺序存储器。  

##### 低位交叉编址（交叉方式）

> pro：交叉存储器中数据的存放方式（2017）  

- 地址划分：
  - 低位为模块号
  - 高位为模块内地址
- 编址规则：
  - 每个模块按"模m"交叉编址
  - 模块号 = 单元地址 % m

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/b4f48c1df4011710c3242e64f98016fdf9a431c95108f08cf1745946d0aec796.jpg)  
图3.8低位交叉编址的多体存储器  

- 工作特点：
  - 高位体内地址送到低位体号确定的模块内译码
  - 程序连续存放在相邻模块中

##### 启动方式
###### 轮流启动方式
- 条件要求：
  - 每个模块读/写位数等于数据总线位数
  - 模块数m ≥ T/r（T为存取周期，r为总线周期）

> pro：交叉存储器存取时间和带宽的计算（2012、2013）  

- 工作特点：
  - 每隔1/m个存取周期轮流启动各模块
  - 存取速度提高m倍
  - 连续存取m个字时间：t₁ = T + (m-1)r
  - 顺序方式时间：t₂ = mT

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/357a8d6b3c8858f8e0445d4f33ec790e4dc9c97914e01f04c3acc061319ce47a.jpg)  
图3.9低位交叉轮流启动的存取时间示意图  

> pro：交叉存储器中访存冲突的分析（2015）  

- 访存冲突：
  - 发生条件：相邻m次访问的地址在同一模块
  - 处理方法：延迟发生冲突的访问请求

###### 同时启动方式
- 条件要求：
  - 所有模块并行读/写的总位数等于数据总线位数
- 工作示例：
  - 每模块读/写16位
  - 模块数m=4
  - 数据总线64位
  - 4个模块同时启动并行读/写
 

# 主存储器与CPU的连接  

## 连接原理  

- 主存储器与CPU的连接方式：
  - 通过三种总线连接：
    - 数据总线
    - 地址总线 
    - 控制总线
  - 总线特点：
    - 数据总线：位数与工作频率的乘积决定数据传输速率
    - 地址总线：位数决定最大可寻址内存空间
    - 控制总线：指示总线周期类型和I/O操作完成时刻

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/1e1d92cf5473f7cdbefec0c268399f79d298a75bd67083e238876b319130a603.jpg)  
图3.10主存储器与CPU的连接  

- 存储器扩展需求：
  - 单个芯片容量有限
  - 通过扩展技术集成多个芯片
  - 多个内存条和ROM芯片组成主存空间
  - 通过总线与CPU相连

## 主存容量的扩展  

- 扩展需求：
  - 单个存储芯片容量有限
  - 需要在字和位两方面进行扩充
  - 目的是满足实际存储器容量要求

### 位扩展法  

- 概念：对字长进行扩展
- 应用场景：CPU数据线数多于存储芯片数据位数
- 连接方式：
  - 各芯片的地址线、片选线和读/写控制线与系统总线并联
  - 各芯片数据线单独引出连接系统数据线
  - 各芯片同时工作
- 实例：用8片8K×1位RAM组成8K×8位存储器

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/f2b1e66bdcaafe6c0055bf34f9b6020f9ac3160dbd2ded9961f636deabd2b444.jpg)  
图3.11位扩展连接示意图  

### 字~

- 概念：对存储字数量进行扩展
- 特点：存储字位数满足系统要求
- 连接方式：
  - 芯片地址线与系统地址低位相连
  - 数据线和读/写控制线与系统总线并联
  - 系统地址高位译码得到片选信号
  - 各芯片分时工作

> pro：字扩展（或字位扩展）后存储芯片的地址范围（2010、2016）  

- 实例：用4片16K×8位RAM组成64K×8位存储器
- 地址分配：
  - 第一片：0000000000000000-0011111111111111
  - 第二片：0100000000000000-0111111111111111
  - 第三片：1000000000000000-1011111111111111
  - 第四片：1100000000000000-1111111111111111

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/44f1fe99a9391d96d9aeb0fb8712474bf298dbedaaa36321308e7bb49a6874d2.jpg)  
图3.12字扩展连接示意图  

### 字位同时~

- 概念：位扩展和字扩展的组合
- 功能：
  - 增加存储字数量
  - 增加存储字长
- 连接方式：
  - 位扩展芯片作为一组
  - 各组连接方式同位扩展
  - 系统地址高位译码产生片选信号
- 实例：用8片16K×4位RAM组成64K×8位存储器
  - 组织方式：
    - 每两片构成16K×8位存储器（位扩展）
    - 4组构成64K×8位存储器（字扩展）

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/1bd0ffee871eff245d8c4e998e914cbf1ee53c30a0465b58592027c9ed8d0501.jpg)  
图3.13字位同时扩展及CPU的连接图  
## 存储芯片的地址分配和片选  

### 基本概念
- CPU访问存储单元需要两个步骤：
  - 片选：选择存储芯片
  - 字选：在选定芯片中选择具体存储单元
- 字选过程：
  - 由CPU送出N条低位地址线完成
  - N由片内存储容量2^N决定
- 片选信号产生方法：
  - 线选法
  - 译码片选法

### 线选法  

#### 工作原理
- 高位地址线直接连接至存储芯片片选端
- 地址线为"0"时选中对应存储芯片
- 每次只能有一位有效

#### 实例说明
- 4片2K×8位存储芯片构成8K×8位存储器
- 低位地址线A10~A0作为字选线
- 片选信号分配如下：

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/d3e8ef9e2d826e33c5a04dddaf3613401040af874224f56e1f181b5f42aec2d2.jpg)  

#### 优缺点
- 优点：
  - 不需要地址译码器
  - 线路简单
- 缺点：
  - 地址空间不连续
  - 选片地址线必须分时为低电平
  - 存储器空间利用率低

### 译码片选法  

#### 工作原理
- 高位地址线通过地址译码器产生片选信号

#### 实例说明
- 8片8K×8位存储芯片组成64K×8位存储器
  - 地址线16位，数据线8位
  - 需要8个片选信号
  - 使用74LS138作为地址译码器
  - 高3位用于片选：
    - A15A14A13=000选中第一片
    - A15A14A13=001选中第二片
    - 以此类推

## 存储器与CPU的连接  

### 合理选择存储芯片  

> pro：根据要求合理选择存储芯片（2009、2021）  

#### 选择原则
- 存储芯片类型选择：
  - ROM：存放系统程序、标准子程序和常数
  - RAM：用于用户编程
- 芯片数量考虑：
  - 追求连线简单
  - 方便实用

### 地址线的连接  

> pro：地址范围与存储容量的对应关系（2016、2023）  

#### 连接规则
- CPU地址线数通常多于存储芯片
- 连接方式：
  - 低位：CPU地址线与存储芯片地址线相连
    - 用于字选
    - 由片内逻辑完成译码
  - 高位：用于扩充存储芯片
    - 用于片选
    - 由外接译码器完成译码

#### 实例说明
- CPU：16位地址线(A15~A0)
- 存储芯片：1K×4位，10根地址线
- 连接方式：CPU的A9~A0与存储芯片的A9~A0相连

### 数据线的连接  

#### 连接方式
- CPU与存储芯片数据线数相等：
  - 直接相连
- CPU与存储芯片数据线数不等：
  - 需对存储芯片扩位
  - 使数据位数与CPU数据线数相等

### 读/写命令线的连接  

#### 连接方式
- 单一读/写命令线：
  - 直接与存储芯片控制端相连
  - 高电平为读，低电平为写
- 分开的读/写命令线：
  - 读命令线(RD)连接芯片读控制端
  - 写命令线(WE)连接芯片写控制端
  - 均为低电平有效

### 片选线的连接  

#### 基本原理
- 片选决定存储芯片是否被选中
- 取决于片选控制端CS接收到的信号

#### 工作过程
- 与CPU访存控制信号MREQ相关
  - CPU要求访存：MREQ为低电平
  - CPU访问I/O：MREQ为高电平，存储器不工作


