以下是按照您的要求对提供的关于数据结构的 Markdown 文档进行挖空处理后的结果。挖空部分包括定义中的关键词、公式定理和算法中的关键步骤，答案以 HTML 折叠块的形式列在每个次级标题下方。内容保持原有目录结构不变，输出格式同时包括 Markdown 和 HTML 代码。

---

# above

<ul>

# 

<ul>

## 【考纲内容】  

<ul>

（一）内存管理基础  

内存管理概念：____地址与____地址空间，地址变换，内存共享，内存保护内存分配与回收连续分配管理方式：____管理：____管理：____管理  

（二）虚拟内存管理  

虚拟内存基本概念：____页式管理；页框分配：____算法内存映射文件（Memory-MappedFiles）；虚拟存储器性能的影响因素及改进方式  

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>逻辑</li>
    <li>物理</li>
    <li>页式</li>
    <li>段式</li>
    <li>段页式</li>
    <li>请求</li>
    <li>页置换</li>
  </ul>
</details>
</div>

## 【复习提示】  

<ul>

- 操作系统的核心内容：
  - ____管理。
  - 进程管理。

- 本章重点复习内容：
  - 围绕____机制展开。

- 分页机制的作用：
  - 提高内存利用率：通过____管理方式在物理内存大小的基础上。
  - 实现____内存：引入请求分页管理方式。
  - 提高处理器利用率：使内存脱离____大小的限制。

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>内存</li>
    <li>分页</li>
    <li>分页</li>
    <li>虚拟</li>
    <li>物理</li>
  </ul>
</details>
</div>

</ul>

# 内存管理概念  

<ul>

在学习本节时，请读者思考以下问题：  

- 为什么要进行内存管理？  
- 多级页表解决了什么问题？又会带来什么问题？  

在学习经典的管理方法前，同样希望读者先思考，自己给出一些内存管理的想法，并在学习过程中和经典方案进行比较。注意本节给出的内存管理是循序渐进的，后一种方法通常会解决前一种方法的不足。希望读者多多思考，比较每种方法的异同，看重掌握____管理。  

## 内存管理的基本原理和要求  

<ul>

### 内存管理概述

<ul>

- 内存管理是操作系统设计中最重要和最复杂的内容之一
- 虽然内存容量不断增大，但仍需要对内存空间进行合理划分和____分配
- 在多道程序设计中非常重要：
  - 方便用户使用存储器
  - 提高内存____率
  - 通过虚拟技术扩充存储器

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>页式</li>
    <li>动态</li>
    <li>利用</li>
  </ul>
</details>
</div>

### 内存管理的主要功能

<ul>

- 内存空间的____与回收
  - 由操作系统 ona负责管理
  - 记录空闲空间和分配情况
  - 回收已结束进程的内存
- 地址转换
  - 将____地址转换为____地址
- 内存空间的扩充
  - 利用____存储技术
- 内存共享
  - 允许多进程访问同一内存部分
- 存储保护
  - 确保进程在各自存储空间内运行

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>分配</li>
    <li>逻辑</li>
    <li>物理</li>
    <li>虚拟</li>
  </ul>
</details>
</div>

### 程序的链接与装入

<ul>

#### 程序装入步骤

<ul>

>pro：编译、链接和装入阶段的工作内容（2011）  

- 编译：由编译程序将用户源代码编译成若干____模块
- 链接：由链接程序将目标模块和库函数链接成完整____模块
- 装入：由装入程序将装入模块装入内存运行

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/e2e92705f899ae7c658c8ce6e7e7e09d832b97668ad820799aaa59506678d711.jpg)  
图3.1将用户程序变为可在内存中执行的程序的步骤  

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>目标</li>
    <li>装入</li>
  </ul>
</details>
</div>

#### 装入方式

<ul>

##### 绝对装入

<ul>

- 适用于单道程序环境
- 编译时产生____地址的目标代码
- 不需对程序和数据地址进行修改
- 地址可在编译/汇编时给出或由程序员直接赋予

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>绝对</li>
  </ul>
</details>
</div>

##### 可重定位装入

<ul>

- 装入模块始址从0开始
- 使用相对于始址的地址
- 根据内存情况装入适当位置
- 静态重定位特点：
  - 必须分配全部内存空间
  - 运行期间不能____
  - 不能再申请内存空间

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>移动</li>
  </ul>
</details>
</div>

##### 动态运行时装入

<ul>

- 又称动态重定位
- 地址转换推迟到程序____时
- 需要____寄存器支持
- 优点：
  - 可分配到不连续存储区
  - 只需装入部分代码即可运行
  - 可动态申请内存
  - 便于程序段共享

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/c0e725fbc2972b27f98a7f55f3ffde34de2c58cfb4321de43a3a06b0b9de50a6.jpg)  
图3.2重定位类型  

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>执行</li>
    <li>重定位</li>
  </ul>
</details>
</div>

</ul>

#### 链接方式

<ul>

根据链接时间不同，分为以下三种：

##### 静态链接

<ul>

- 在程序运行之前，先将各目标模块及库函数链接成完整装入模块，以后不再拆开
- 将目标模块装配成装入模块需解决两个问题：
  - 修改____地址，编译后的所有目标模块都是从0开始的相对地址，当链接成一个装入模块时要修改相对地址
  - 变换外部调用符号，将每个模块中所用的外部调用符号也都变换为____地址

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>相对</li>
    <li>相对</li>
  </ul>
</details>
</div>

##### 装入时动态链接

<ul>

- 将用户源程序编译后的目标模块，在装入内存时边装入边____
- 优点：
  - 便于修改和更新
  - 便于实现对目标模块的____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>链接</li>
    <li>共享</li>
  </ul>
</details>
</div>

##### 运行时动态链接

<ul>

- 在程序执行中需要某目标模块时才进行____
- 未用到的目标模块不会被调入内存和链接
- 优点：
  - 能加快程序的装入过程
  - 节省内存空间

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>链接</li>
  </ul>
</details>
</div>

</ul>

#### 逻辑地址与物理地址

<ul>

>pro：进程虚拟地址空间的特点（2023）  

##### 逻辑地址特点

<ul>

- 编译后每个目标模块从____号单元开始编址
- 链接程序将各模块链接成完整可执行程序时：
  - 按各模块相对地址构成统一的从____号单元开始编址的逻辑地址空间
  - 32位系统逻辑地址空间范围为 $0{\sim}____$
- 进程运行时使用逻辑地址
- 不同进程可有相同逻辑地址，映射到不同物理位置

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>0</li>
    <li>0</li>
    <li>2^{32}-1</li>
  </ul>
</details>
</div>

##### 物理地址特点

<ul>

- 指内存中____单元的集合
- 是地址转换的最终地址
- 进程运行时通过物理地址从主存____
- 装入时通过地址重定位将逻辑地址转换为____地址

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>物理</li>
    <li>存取</li>
    <li>物理</li>
  </ul>
</details>
</div>

##### 地址转换机制

<ul>

- 通过内存管理部件(____)实现转换
- 逻辑地址通过____映射到物理内存
- 页表由操作系统维护并被处理器引用

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>MMU</li>
    <li>页表</li>
  </ul>
</details>
</div>

</ul>

#### 进程的内存映像

<ul>

##### 基本组成要素

<ul>

- 代码段：
  - 程序的____代码
  - 只读
  - 可被多个进程共享
- 数据段：
  - 程序运行时加工处理的对象
  - 包括全局变量和____变量
- 进程控制块(PCB)：
  - 存放在系统区
  - 用于操作系统控制和管理____
- 堆：
  - 存放动态分配的变量
  - 通过____函数向高地址分配空间
- 栈：
  - 用于实现函数调用
  - 从用户空间最大地址往____地址方向增长

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>二进制</li>
    <li>静态</li>
    <li>进程</li>
    <li>malloc</li>
    <li>低</li>
  </ul>
</details>
</div>

##### 内存映像特点

<ul>

- 代码段和数据段：
  - 调入内存时指定____
- 堆的特点：
  - 可在运行时动态扩展和收缩
  - 通过____和____函数管理
- 栈的特点：
  - 可动态扩展和收缩
  - 函数调用时增长
  - 函数返回时收缩

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>大小</li>
    <li>malloc</li>
    <li>free</li>
  </ul>
</details>
</div>

##### 内存映像结构

<ul>

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/0e2fe5889793c687c3723b8dfd8cf019f7286115e86893dcd2b25d4e5be163d7.jpg)  
图3.3内存中的一个进程  

- 共享库：存放进程使用的共享函数库代码
- 只读代码段：
  - .init：程序初始化调用的____函数
  - .text：用户程序的机器代码
  - .rodata：只读数据
- 读/写数据段：
  - .data：已初始化的全局变量和静态变量
  - .bss：未初始化及初始化为____的全局变量和静态变量

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>_init</li>
    <li>0</li>
  </ul>
</details>
</div>

</ul>

#### 内存保护

<ul>

>pro：分区分配内存保护的措施（2009）  

##### 保护目标

<ul>

- 确保每个进程都有单独内存空间
- 保护操作系统不受用户进程影响
- 保护用户进程不受其他进程影响

</ul>

##### 保护方法

<ul>

###### 方法一：上下限寄存器

<ul>

- 在CPU中设置____寄存器
- 存放用户进程主存中的下限和上限地址
- CPU访问地址时进行____判断

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>上下限</li>
    <li>越界</li>
  </ul>
</details>
</div>

###### 方法二：重定位和界地址寄存器

<ul>

- 重定位寄存器：
  - 存放进程起始____地址
  - 用于地址转换
- 界地址寄存器：
  - 存放进程最大____地址
  - 用于越界检查
- 工作流程：
  - 比较逻辑地址与____地址
  - 未越界则加上重定位值
  - 映射成物理地址送交内存单元

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/769586d1b69163b38c8eb8a0d766464d8534b2c32618ad685357ef625ec6e181.jpg)  
图3.4重定位寄存器和界地址寄存器的硬件支持  

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>物理</li>
    <li>逻辑</li>
    <li>界</li>
  </ul>
</details>
</div>

</ul>

##### 寄存器特点

<ul>

- 区别：
  - 重定位寄存器用于"____"操作
  - 界地址寄存器用于"____"操作
- 安全措施：
  - 加载时必须使用特权指令
  - 只有操作系统内核可以加载
  - 不允许用户程序修改

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>加</li>
    <li>比</li>
  </ul>
</details>
</div>

</ul>

#### 内存共享

<ul>

##### 共享特点

<ul>

- 只读区域可以____
- 可重入代码(纯代码)特点：
  - 允许多进程同时访问
  - 不允许被修改
- 执行机制：
  - 可为每个进程配局部数据区
  - 将可能改变的部分复制到数据区
  - 只修改私有数据区内容

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>共享</li>
  </ul>
</details>
</div>

##### 共享实现示例

<ul>

- 系统条件：
  - 40个用户同时执行
  - 文本编辑程序：____KB代码区和____KB数据区
- 内存需求对比：
  - 不共享：____KB
  - 共享：____KB (40KB×40 + 160KB)

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>160</li>
    <li>40</li>
    <li>8000</li>
    <li>1760</li>
  </ul>
</details>
</div>

##### 共享实现方式

<ul>

###### 分页系统实现

<ul>

- 假设页面大小4KB：
  - 代码区占____个页面
  - 数据区占____个页面
- 实现方式：
  - 每个进程页表建立40个指向共享代码区的页表项
  - 每个进程建立10个指向私有数据区的页表项

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>40</li>
    <li>10</li>
  </ul>
</details>
</div>

###### 分段系统实现

<ul>

- 以段为分配单位
- 只需一个段表项：
  - 指向共享代码段始址
  - 设置段长____KB
- 特点：实现简单易行

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>160</li>
  </ul>
</details>
</div>

</ul>

</ul>

#### 内存分配与回收

<ul>

##### 发展历程

<ul>

- 单道到多道：
  - 从单一连续分配到____分区分配
- 适应性提升：
  - 从固定分区到____分区分配
- 利用率提高：
  - 从连续分配到离散分配(____存储)
- 用户需求：
  - 引入____存储管理

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>固定</li>
    <li>动态</li>
    <li>页式</li>
    <li>分段</li>
  </ul>
</details>
</div>

</ul>

</ul>

## 连续分配管理方式

<ul>

- 定义：为用户程序分配____的内存空间
- 包含方式：
  - ____连续分配
  - ____分区分配 
  - ____分区分配

### 单一连续分配

<ul>

- 内存分区：
  - 系统区(____地址)
  - 用户区(用户程序独占)
- 特点：
  - 优点：
    - 简单
    - 无外部碎片
    - 不需内存保护
  - 缺点：
    - 仅适用单用户单任务
    - 有____碎片
    - 存储器利用率低

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>连续</li>
    <li>单一</li>
    <li>固定</li>
    <li>动态</li>
    <li>低</li>
    <li>内部</li>
  </ul>
</details>
</div>

### 固定分区分配

<ul>

- 基本概念：
  - 将用户内存划分为____大小分区
  - 每个分区装入一道作业
- 分区划分方法：
  - 分区大小相等
    - 缺点：程序大小不匹配导致浪费
  - 分区大小不等
    - 划分方式：多个小分区、适量中等分区、少量大分区
- 管理方式：
  - 建立分区使用表
    - 按分区大小排序
    - 包含信息：始址、大小、____

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/8d70757f4ca7ec6e9bcb8e81300b8c8e25d53c67df66978b2b0b247e2c72a013.jpg)  
图3.5固定分区说明表和内存分配情况  

- 存在问题：
  - 程序可能过大无法装入
  - ____碎片问题
  - 无法实现多进程共享

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>固定</li>
    <li>状态</li>
    <li>内部</li>
  </ul>
</details>
</div>

### 动态分区分配

<ul>

#### 基本原理

<ul>

- 定义：根据进程需要动态分配内存
- 特点：
  - 分区大小和数量____
  - 适应进程实际需求

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/84b658e6d931df33bc921645b00ee4a5939fddf33865510dce7e507e102c17ac.jpg)  
图3.6动态分区分配  

- 问题：
  - 产生____碎片
  - 需要____技术处理

>pro：动态分区分配的内存回收方法（2017）  

- 内存管理：
  - 设置空闲分区链
  - 分配过程：
    - 检索空闲分区链
    - 按需____分配
  - 回收情况：
    - 与前一分区相邻____
    - 与后一分区相邻____
    - 与前后分区都相邻____
    - 无相邻分区新建表项

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>可变</li>
    <li>外部</li>
    <li>紧凑</li>
    <li>分割</li>
    <li>合并</li>
    <li>合并</li>
    <li>合并</li>
  </ul>
</details>
</div>

#### 基于顺序搜索的分配算法

<ul>

>pro：各种动态分区分配算法的比较（2019、2024）  

##### 首次适应算法

<ul>

- 特点：
  - 按地址____排序
  - 分配第一个满足大小的分区
- 优缺点：
  - 优点：保留高地址大空闲分区
  - 缺点：低地址产生小碎片

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>递增</li>
  </ul>
</details>
</div>

##### 邻近适应算法

<ul>

- 特点：
  - 从上次结束位置继续查找
  - 低高地址同等概率分配
- 缺点：性能通常比首次适应差

</ul>

##### 最佳适应算法

<ul>

- 特点：
  - 按容量____排序
  - 选择最小满足需求的分区
- 缺点：产生最多外部碎片

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>递增</li>
  </ul>
</details>
</div>

##### 最坏适应算法

<ul>

- 特点：
  - 按容量____排序
  - 选择最大空闲分区
- 缺点：快速耗尽大空闲分区

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>递减</li>
  </ul>
</details>
</div>

</ul>

#### 基于索引搜索的分配算法

<ul>

##### 快速适应算法

<ul>

- 特点：
  - 按进程常用空间大小____
  - 使用索引表管理
- 优缺点：
  - 优点：查找效率高
  - 缺点：回收复杂

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>分类</li>
  </ul>
</details>
</div>

##### 伙伴系统

<ul>

- 特点：
  - 分区大小为____的k次幂
  - 采用分裂合并机制
- 分配过程：
  - 查找合适大小分区
  - 必要时分裂大分区
  - 产生伙伴分区

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>2</li>
  </ul>
</details>
</div>

##### 哈希算法

<ul>

- 实现方式：
  - 建立____函数
  - 构建空闲分区大小哈希表
- 分配过程：
  - 计算哈希值
  - 获取对应分区链表

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>哈希</li>
  </ul>
</details>
</div>

</ul>

</ul>

- 连续分配方式的局限：
  - 需要连续空间
  - 可能导致大进程无法运行
- 非连续分配的优势：
  - 支持____分配
  - 更灵活但存储密度较低

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>分散</li>
  </ul>
</details>
</div>

## 基本分页存储管理

<ul>

- 固定分区和动态分区的问题：
  - 固定分区产生____碎片
  - 动态分区产生____碎片
  - 两种技术内存利用率低

- 分页思想的引入：
  - 内存空间划分：
    - ____大小的分区（如4KB）
    - 称为页框、页帧或物理块
  - 进程逻辑地址空间：
    - 划分为与块大小相等的区域
    - 称为____或页面
  - 分配方式：
    - 以____为单位分配内存空间

- 与固定分区的比较：
  - 相似点：形式上类似分区相等的固定分区
  - 区别：
    - 块大小相对分区小很多
    - 进程按块划分和申请空间
  - 碎片情况：
    - 不产生____碎片
    - 仅在最后一块产生____碎片
    - 平均每个进程产生半个块大小的内部碎片

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>内部</li>
    <li>外部</li>
    <li>固定</li>
    <li>页</li>
    <li>页框</li>
    <li>外部</li>
    <li>内部</li>
  </ul>
</details>
</div>

### 分页存储的几个基本概念

<ul>

#### 页面和页面大小

<ul>

##### 页面编号

<ul>

- 页号：进程逻辑地址空间中页面编号，从____开始
- 页框号：内存空间中页框编号，从____开始
- 对应关系：页号和页框号____对应

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>0</li>
    <li>0</li>
    <li>一一</li>
  </ul>
</details>
</div>

##### 页面大小设计

<ul>

- 基本要求：应是____的整数次幂
- 大小选择考虑：
  - 过小问题：
    - 页表过长占用大量内存
    - 增加地址转换开销
    - 降低页面换入/换出效率
  - 过大问题：
    - 页内碎片增多
    - 降低内存利用率

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>2</li>
  </ul>
</details>
</div>

</ul>

#### 地址结构

<ul>

>pro：分页系统的逻辑地址结构（2009、2010、2013、2015、2017）

某个分页存储管理的逻辑地址结构如图3.7所示。

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/a1084600709c4d0aa005f5487fcbb33775ce656838a921c6a1ed9595caad2029.jpg)

##### 地址组成

<ul>

- 两个部分：
  - ____P
  - 页内偏移量W
- 32位地址结构：
  - 0~11位：页内地址，页大小为____B
  - 12~31位：页号，最多____页

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>页号</li>
    <li>2^{12}</li>
    <li>2^{20}</li>
  </ul>
</details>
</div>

##### 地址特点

<ul>

- 决定____内存寻址空间大小
- 数值表示：
  - 可用十进制表示
  - 可用二进制表示
  - 需要会进行转换

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>虚拟</li>
  </ul>
</details>
</div>

</ul>

#### 页表

<ul>

##### 页表功能与结构

<ul>

- 建立目的：找到页面在内存中的____
- 组成特点：
  - 每个进程一张页表
  - 每个页面对应一个____
  - 页表项包含页号和____号

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>位置</li>
    <li>页表项</li>
    <li>块</li>
  </ul>
</details>
</div>

##### 页表作用

<ul>

- 实现地址映射：
  - 从页号到____块号的映射
  - 通过查表找到内存中的物理块号

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/4e941d532664249c15e4c6bfa16b0d95e1d9e20f298489776e12659e46b93471.jpg)
图3.8页表的作用

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>物理</li>
  </ul>
</details>
</div>

</ul>

</ul>

### 基本地址变换机构  

<ul>

#### 地址变换机构概述

<ul>

- 主要任务：将逻辑地址转换为内存中的____地址
- 实现方式：借助____完成
- 基本结构：如图3.9所示

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/e6eee6e73f4f9cae62eb8d1c257f991c320374c1947ac8ac055ae2fa059e54d6.jpg)  
图3.9分页存储管理系统中的地址变换机构  

>attention:  

在页表中，由于页表项连续存放，因此页号可以是隐含的，不占用存储空间。  

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>物理</li>
    <li>页表</li>
  </ul>
</details>
</div>

#### 地址变换实现机制

<ul>

##### 页表寄存器设置

<ul>

- 目的：提高地址变换____
- 组成：
  - 存放页表在内存的始址____
  - 页表长度____
- 使用特点：
  - 单CPU系统只设一个页表寄存器
  - 进程未执行时信息存在PCB中
  - 进程调度执行时装入页表寄存器

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>速度</li>
    <li>F</li>
    <li>M</li>
  </ul>
</details>
</div>

##### 地址变换步骤

<ul>

- 步骤1：计算页号和偏移量
  - 页号P = ____
  - 页内偏移量W = ____
- 步骤2：页号越界检查
  - 若P ≥ M则产生____中断
- 步骤3：查询页表
  - 计算页表项地址 = F + P × ____
  - 获取物理块号____
- 步骤4：计算物理地址
  - E = ____
  - 用E访问内存

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>A/L</li>
    <li>A%L</li>
    <li>越界</li>
    <li>页表项长度</li>
    <li>b</li>
    <li>b×L + W</li>
  </ul>
</details>
</div>

##### 地址变换示例

<ul>

- 条件：
  - 页面大小L = ____KB
  - 页号2对应物理块b = ____
  - 逻辑地址A = ____
- 计算过程：
  - P = 2500/1K = ____
  - W = 2500%1K = ____
  - E = 8×1024 + 452 = ____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>1</li>
    <li>8</li>
    <li>2500</li>
    <li>2</li>
    <li>452</li>
    <li>8644</li>
  </ul>
</details>
</div>

</ul>

#### 页表项大小设计

<ul>

##### 约束条件分析

<ul>

- 基本要求：能找到页面在内存中的____
- 计算示例：
  - 32位地址空间
  - 4KB页面大小
  - 总页数：2^{32}B/4KB = ____页
  - 所需位数：log₂2^{20} = ____位
  - 最小页表项：⌈20/8⌉ = ____B

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>位置</li>
    <li>2^{20}</li>
    <li>20</li>
    <li>3</li>
  </ul>
</details>
</div>

</ul>

#### 分页管理主要问题

<ul>

- 访存效率问题：
  - 每次访存需地址____
  - 转换速度要求高
- 内存利用率问题：
  - 每进程需维护____
  - 页表大小需合理控制

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>转换</li>
    <li>页表</li>
  </ul>
</details>
</div>

</ul>

### 具有快表的地址变换机构  

<ul>

#### 快表的引入背景

<ul>

- 传统页表访问过程需两次内存访问：
  - 第一次访问页表获取____地址
  - 第二次根据物理地址访问数据/指令
- 这种方法使指令执行速度降低一半

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>物理</li>
  </ul>
</details>
</div>

#### 快表的基本概念

<ul>

- 在地址变换机构中增设____缓冲存储器(快表/TLB)
  - 具有并行查找能力
  - 存放当前访问的若干页表项
  - 加速地址变换过程
- 主存中的页表称为慢表

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/849dd4ffb9bf9d8bec3027b62a29e5854c61e99bba2e66054afa6c2ee3a3787b.jpg)  
图3.10具有快表的地址变换机构  

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>高速</li>
  </ul>
</details>
</div>

#### 快表地址变换过程

<ul>

- CPU给出逻辑地址后硬件进行地址转换
- 将页号与快表中所有页号比较
  - 找到匹配页号：
    - 直接取出对应____号
    - 与页内偏移量拼接形成物理地址
    - 仅需一次访存
  - 未找到匹配页号：
    - 需访问主存中____
    - 读出页表项并存入快表
    - 若快表已满需按算法淘汰旧页表项

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>页框</li>
    <li>页表</li>
  </ul>
</details>
</div>

#### 快表性能分析

<ul>

- 命中率可达____%以上
- 分页速度损失降至____%以下
- 有效性基于____原理

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>90</li>
    <li>10</li>
    <li>局部性</li>
  </ul>
</details>
</div>

</ul>

### 两级页表  

<ul>

#### 引入背景

<ul>

- 单级页表存在问题：
  - 以32位地址空间为例：
    - 页面大小____KB
    - 页表项大小____B
    - 页内偏移____位
    - 页号____位
  - 导致：
    - 页表项数达____
    - 占用____个页
    - 要求连续存放

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>4</li>
    <li>4</li>
    <li>12</li>
    <li>20</li>
    <li>2^{20}</li>
    <li>1K</li>
  </ul>
</details>
</div>

#### 解决方案

<ul>

- 方案一：____分配方式
  - 用索引表记录页表存放位置
  - 解决连续内存空间问题
- 方案二：部分页表调入
  - 仅调入当前需要的____
  - 其余页表项驻留磁盘
  - 需要时再调入

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>离散</li>
    <li>页表项</li>
  </ul>
</details>
</div>

#### 两级页表结构

<ul>

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/f3d711b1fdfd48bdfbf62078bf72f43ff15a97f9dc1f39225d1f0d21e9af6e3d.jpg)  

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/e940ed14b9df9e0a88b9d4ed75eb1b22dcea777df08139307f5ba7513072ad6d.jpg)  
图3.12两级页表结构示意图  

</ul>

#### 两级页表实现

<ul>

- 页表项内容：
  - 存放进程页对应的____块号
  - 如：0号页存放在1号物理块
- 外层页表项内容：
  - 存放页表分页的____
  - 如：0号页表存放在3号物理块

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>物理</li>
    <li>始址</li>
  </ul>
</details>
</div>

#### 地址变换过程

<ul>

- 系统增设外层____寄存器
  - 用于存放页目录始址
- 变换步骤：
  - 用页目录号索引找到____始址
  - 用二级页号索引找到____
  - 将物理块号和页内偏移拼接
  - 用最终地址访问内存
- 需要____次访存

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>页表</li>
    <li>页表</li>
    <li>页表项</li>
    <li>3</li>
  </ul>
</details>
</div>

#### 多级页表的必要性

<ul>

- 64位地址空间的问题：
  - 两级分页条件：
    - 页面大小____KB
    - 页表项大小____B
  - 外层页表需求：
    - ____位用于外层页号
    - ____G个页表项
    - 需____GB连续内存
- 解决方案：
  - 必须采用____页表
  - 对外层页表再次分页
  - 目的是建立索引避免存储无用页表项

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>4</li>
    <li>4</li>
    <li>42</li>
    <li>4096</li>
    <li>16384</li>
    <li>多级</li>
  </ul>
</details>
</div>

</ul>

</ul>

## 基本分段存储管理

<ul>

### 概述

<ul>

- 分页管理方式
  - 从计算机角度设计
  - 目的是提高内存____率和性能
  - 通过硬件机制实现
  - 对用户完全透明

- 分段管理方式
  - 考虑用户和程序员需求
  - 满足多方面需要：
    - 方便编程
    - 信息保护和____
    - 动态增长
    - 动态链接

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>利用</li>
    <li>共享</li>
  </ul>
</details>
</div>

### 分段

<ul>

#### 基本概念

<ul>

- 将用户进程的逻辑地址空间划分为大小不等的____
- 进程划分示例：
  - 主程序段
  - 两个子程序段
  - 栈段
  - 数据段
- 特点：
  - 段内要求____
  - 段间不要求连续
  - 进程的地址空间是____的

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>段</li>
    <li>连续</li>
    <li>二维</li>
  </ul>
</details>
</div>

#### 逻辑地址结构

<ul>

- 由两部分组成：
  - 段号(____)
  - 段内偏移量(____)
- 具体参数：
  - 段号：____位
  - 段内偏移量：____位
  - 最大段数：____ = 65536
  - 最大段长：____KB

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/90346c8dc49007d299dcec9f7edeb1cdbbfcc155f76ca5933c5eed85f0350dff.jpg)  
图3.13分段系统中的逻辑地址结构  

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>S</li>
    <li>W</li>
    <li>16</li>
    <li>16</li>
    <li>2^{16}</li>
    <li>64</li>
  </ul>
</details>
</div>

#### 用户可见性

<ul>

- 页式系统：
  - 页号和页内偏移量对用户____
- 分段系统：
  - 段号和段内偏移量需用户显式提供
  - 在高级语言中由____程序完成

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>透明</li>
    <li>编译</li>
  </ul>
</details>
</div>

</ul>

### 段表

<ul>

#### 基本特征

<ul>

- 每个进程都有一张____
- 用途：
  - 实现逻辑空间与内存空间____
- 结构：
  - 每个段对应一个____
  - 段表项记录：
    - 段在内存中的____
    - 段的长度

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/587fc0765e3589715cc978f4f3f4d13ce767907a018d146270266a66587833b6.jpg)  
图3.14段表的内容  

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>段表</li>
    <li>映射</li>
    <li>段表项</li>
    <li>始址</li>
  </ul>
</details>
</div>

#### 映射实现

<ul>

- 执行过程：
  - 通过查找____
  - 找到每段对应的内存区
- 作用：
  - 实现从逻辑段到____内存区的映射

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/8c140d6facaf5de36702ce9fc4d8c567bcd938c6ee4352f5ce6a2176cece06db.jpg)  
图3.15利用段表实现物理内存区映射

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>段表</li>
    <li>物理</li>
  </ul>
</details>
</div>

</ul>

### 地址变换机构  

<ul>

#### 变换过程

<ul>

- 系统设置：
  - 段表寄存器：存放段表始址____和段表长度____
- 从逻辑地址A到物理地址E的变换过程如下：

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/4ce6c20cc541f28a9c88f7a86c22f90a5c02d2beeb61fb177c23a9c0e40280e0.jpg)  
图3.16分段系统的地址变换过程  

- 具体步骤：
  - ① ____ ____
  - ② 段号越界检查：
    - 若段号S>段表长度M：产生____中断
    - 否则：继续执行
  - ③ 段表查询：
    - 计算段表项地址：段表始址F + 段号S × ____
    - 段长检查：
      - 若W≥C：产生____中断
      - 否则：继续执行
  - ④ 物理地址计算：
    - 取出段始址____
    - 计算物理地址E=____
    - 访问内存

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>F</li>
    <li>M</li>
    <li>S</li>
    <li>W</li>
    <li>越界</li>
    <li>段表项长度</li>
    <li>越界</li>
    <li>b</li>
    <li>b+W</li>
  </ul>
</details>
</div>

</ul>

### 分页和分段的对比  

<ul>

#### 相似之处

<ul>

- 都是____分配方式
- 都需要地址映射机构实现地址变换

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>非连续</li>
  </ul>
</details>
</div>

#### 主要区别

<ul>

- 基本单位性质：
  - 页：信息的____单位
  - 段：信息的____单位
- 大小特征：
  - 页：____大小，由系统决定
  - 段：长度不固定，由用户程序决定
- 地址空间维度：
  - 分页：____地址空间
  - 分段：____地址空间

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>物理</li>
    <li>逻辑</li>
    <li>固定</li>
    <li>一维</li>
    <li>二维</li>
  </ul>
</details>
</div>

</ul>

### 段的共享与保护  

<ul>

#### 共享实现

<ul>

- 分页系统：
  - 共享N个页框需要在每个进程页表中建立____个页表项
- 分段系统：
  - 只需一个段表项指向共享的____段
  - 可重入代码（纯代码）：
    - 特点：允许多进程同时访问
    - 保护措施：
      - 每个进程配备局部数据区
      - 可修改的内容复制到数据区

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>N</li>
    <li>物理</li>
  </ul>
</details>
</div>

#### 保护方法

<ul>

- 两种主要方式：
  - ____控制保护
  - 地址越界保护：
    - 段号越界检查：段号与段表长度比较
    - 段内偏移越界检查：段内偏移与段长比较
- 与分页管理对比：
  - 分页只需检查____越界
  - 页内偏移不可能越界

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>存取</li>
    <li>页号</li>
  </ul>
</details>
</div>

</ul>

</ul>

## 段页式存储管理  

<ul>

### 基本概念

<ul>

- 结合了分页和分段的优点：
  - ____存储管理能有效地提高内存利用率
  - ____存储管理能反映程序的逻辑结构并有利于段的共享和保护

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>分页</li>
    <li>分段</li>
  </ul>
</details>
</div>

### 存储空间划分

<ul>

- 进程地址空间划分：
  - 首先分成若干逻辑段，每段都有自己的____
  - 然后将每段分成若干大小固定的____
- 内存空间管理：
  - 将内存分成若干和页面大小相同的____块
  - 以存储块为单位进行分配

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/a19e5e21015fab4e9f7957c838961ae0ac322f6956d3a3233be80e644f36ad9d.jpg)  
图3.17段页式管理方式  

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>段号</li>
    <li>页</li>
    <li>存储</li>
  </ul>
</details>
</div>

### 地址结构

<ul>

- 逻辑地址包含三部分：
  - ____号
  - ____号
  - 页内____量

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/faebce5e4781cefaab723928f127ba1a5e590b95ef32a8b81add22f95bf3fae7.jpg)  
图3.18段页式系统的逻辑地址结构  

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>段</li>
    <li>页</li>
    <li>偏移</li>
  </ul>
</details>
</div>

### 地址变换实现

<ul>

#### 系统表结构

<ul>

- 段表：
  - 每个进程一张段表
  - 段表项包含：
    - 段号
    - 页表____
    - 页表____
- 页表：
  - 每个段对应一张页表
  - 页表项包含：
    - 页号
    - ____号
- 段表寄存器：
  - 指出进程的段表始址和段表长度
  - 双重作用：
    - 在段表中寻址
    - 判断是否越界

>attention:  

在段页式存储管理中，每个进程的段表只有一个，而页表可能有多个。  

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>长度</li>
    <li>始址</li>
    <li>块</li>
  </ul>
</details>
</div>

#### 地址变换过程

<ul>

- 变换步骤：
  - 首先通过段表查到____始址
  - 然后通过页表找到____块号
  - 最后形成____地址
- 访问特点：
  - 一次访问需要____次访存
  - 可使用快表加快查找速度
    - 快表关键字：段号、页号
    - 快表值：物理块号和保护码

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/902defa81b7d034667a22ba17e1c383d0b86ba3adf1f5b19cbcb5ea02917b42f.jpg)  
图3.19段页式系统的地址变换机构  

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>页表</li>
    <li>物理</li>
    <li>物理</li>
    <li>3</li>
  </ul>
</details>
</div>

</ul>

### 地址空间特征

<ul>

- 段页式管理的地址空间是____的

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>二维</li>
  </ul>
</details>
</div>

</ul>

## 本节小结  

<ul>

本节开头提出的问题的参考答案如下。  

1）为什么要进行内存管理？  

在单道系统阶段，一个系统在一个时间段内只执行一个程序，内存的分配极其简单，即仅分配给当前运行的进程。引入多道程序后，进程之间共享的不仅仅是处理机，还有主存储器。然而，共享主存会形成一些特殊的挑战。若不对内存进行管理，则容易导致内存数据的混乱，以至于影响进程的____执行。因此，为了更好地支持多道程序并发执行，必须进行内存管理。  

2）多级页表解决了什么问题？又会带来什么问题？  

多级页表解决了当逻辑地址空间过大时，____的长度会大大增加的问题。而采用多级页表时，一次访盘需要多次访问内存甚至磁盘，会大大增加一次访存的____。  

无论是段式管理、页式管理还是段页式管理，读者都只需要掌握下面三个关键问题： ① ____地址结构， ②页（段）表项结构， ③ ____过程。搞清楚这三个问题，就相当于搞清楚了上面几种存储管理方式。再次提醒读者区分逻辑地址结构和表项结构。  

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>并发</li>
    <li>页表</li>
    <li>时间</li>
    <li>逻辑</li>
    <li>寻址</li>
  </ul>
</details>
</div>

</ul>

# 虚拟内存管理  

<ul>

在学习本节时，请读者思考以下问题：  

1）为什么要引入虚拟内存？2）虚拟内存空间的大小由什么因素决定？3）虚拟内存是怎么解决问题的？会带来什么问题？  

读者要掌握虚拟内存解决问题的思想，了解各种替换算法的优劣，掌握虚实地址的变换方法。  

## 虚拟内存的基本概念  

<ul>

### 传统存储管理方式的特征  

<ul>

- 两个共同特征：
  - ____性
    - 作业必须一次性全部装入内存后才能运行
    - 导致的问题：
      - 作业太大无法全部装入时无法运行
      - 内存不足导致并发度下降
  - 驻留性
    - 作业装入后一直驻留直至结束
    - 即使进程阻塞等待I/O也占用内存
- 问题：造成内存资源浪费

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>一次性</li>
  </ul>
</details>
</div>

### 局部性原理

<ul>

- 是____缓存技术的基础
- 适用于程序结构和数据结构
- 两个方面：

#### 时间局部性

<ul>

- 指令或数据被访问后不久可能再次被____
- 原因是程序中存在大量循环操作

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>高速</li>
    <li>访问</li>
  </ul>
</details>
</div>

#### 空间局部性

<ul>

- 访问某存储单元后不久可能访问其____单元
- 原因：
  - 指令顺序存放执行
  - 数据以向量、数组等形式簇聚存储

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>附近</li>
  </ul>
</details>
</div>

- 实现方式：
  - 时间局部性：通过高速缓存层次结构
  - 空间局部性：使用大容量高速缓存和____机制
  - 虚拟内存：建立内存-外存两级结构

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>预取</li>
  </ul>
</details>
</div>

### 虚拟存储器的定义和特征

<ul>

- 基本原理：
  - 程序装入时只装入必需____/段
  - 运行时动态调页/段
  - 内存空间不足时进行页面/段____

- 三个主要特征：

#### 多次性

<ul>

- 无需一次性全部装入
- 可分多次调入所需部分

</ul>

#### 对换性

<ul>

- 允许程序运行时进行____
- 暂不使用的部分可换出到外存

</ul>

#### 虚拟性

<ul>

- 逻辑上扩充内存____
- 用户看到的容量远大于实际容量

</ul>

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>页面</li>
    <li>置换</li>
    <li>换入换出</li>
    <li>容量</li>
  </ul>
</details>
</div>

### 虚拟内存技术的实现

<ul>

- 实现基础：
  - 需要建立在____分配方式上
  - 连续分配会造成内存浪费

- 三种实现方式：
  - ____分页存储管理
  - ____分段存储管理
  - ____段页式存储管理

- 所需硬件支持：
  - 一定容量的内存和外存
  - 页表/段表机制
  - ____机构
  - 地址变换机构

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>离散</li>
    <li>请求</li>
    <li>请求</li>
    <li>请求</li>
    <li>中断</li>
  </ul>
</details>
</div>

</ul>

## 请求分页管理方式  

<ul>

请求分页系统建立在基本分页系统的基础之上，为支持虚拟存储器功能而增加了____调页和页面____功能。在请求分页系统中，只要求将当前需要的一部分页面装入内存，便可启动作业运行。在作业执行过程中，当所访问的页面不在内存时，再通过请求调页功能将其从外存调入内存；当内存空间不够时，通过页面置换功能将内存中暂时用不到的页面换出到外存。  

- 系统必须提供的硬件支持：
  - 需要一定容量的内存及外存
  - ____机制
  - ____中断机构
  - 地址变换机构

### 页表机制  

<ul>

#### 与基本分页系统的区别

<ul>

- 请求调页功能需求：
  - 需知道页面是否已调入____
  - 未调入时需知道外存存放地址

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>请求</li>
    <li>置换</li>
    <li>页表</li>
    <li>缺页</li>
    <li>内存</li>
  </ul>
</details>
</div>

#### 页面置换功能需求

<ul>

- 需通过指标决定____页面
- 需知道页面是否被修改以决定是否写回外存

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>换出</li>
  </ul>
</details>
</div>

#### 页表项新增字段

<ul>

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/303eb7338433296b1594b6b41a3d67baab1a6ec3202f81030c6eba53ac77444c.jpg)  

- 状态位____：标记页面是否已调入内存
- 访问字段____：记录页面访问次数或未访问时间
- 修改位____：标记页面是否被修改
- 外存地址：记录页面在____的存放位置

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>P</li>
    <li>A</li>
    <li>M</li>
    <li>外存</li>
  </ul>
</details>
</div>

</ul>

### 缺页中断机构  

<ul>

#### 缺页中断处理流程

<ul>

- 进程状态变化：
  - 缺页进程进入____队列
  - 调页完成后进入____队列
- 页面调入处理：
  - 有空闲页框时直接分配
  - 无空闲页框时需进行页面____
    - 被修改页面需写回外存
    - 未修改页面直接覆盖

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>阻塞</li>
    <li>就绪</li>
    <li>置换</li>
  </ul>
</details>
</div>

#### 与一般中断的区别

<ul>

- 发生时间：指令执行期间（____异常）
- 特点：一条指令可能多次缺页中断

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>内部</li>
  </ul>
</details>
</div>

</ul>

### 地址变换机构  

<ul>

#### 地址变换过程

<ul>

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/87bc4b66fa081f12eff16181f93a138db04c62d81e949c6053dcb2d60a16476c.jpg)  

- 快表检索：
  - 命中：获取____块号并更新访问位
  - 写指令时设置修改位
- 页表查找：
  - 找到：获取物理块号并更新____
  - 快表已满需进行替换
- 缺页处理：
  - 将页面从外存调入____
  - 更新页表和快表
  - 获取物理块号
- 物理地址形成：
  - 物理块号和____地址拼接
  - 访问内存

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>物理</li>
    <li>快表</li>
    <li>内存</li>
    <li>页内</li>
  </ul>
</details>
</div>

</ul>

</ul>

## 页框分配  

<ul>

### 驻留集大小  

<ul>

- 驻留集定义：给一个进程分配的____的集合
- 驻留集大小考虑因素：
  - 驻留集越小：
    - 优点：提高多道程序并发度
    - 缺点：____率高，CPU耗费大量时间处理缺页
  - 驻留集越大：
    - 缺点：
      - 超过某个数目时改善不明显
      - 浪费内存空间
      - 降低多道程序并发度

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>页框</li>
    <li>缺页</li>
  </ul>
</details>
</div>

### 内存分配策略  

<ul>

#### 固定分配局部置换

<ul>

- 特点：
  - 每个进程分配固定数目____块
  - 运行期间不改变
  - 缺页时只能从本进程页面中置换
- 缺点：难以确定合适的物理块数目

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>物理</li>
  </ul>
</details>
</div>

#### 可变分配全局置换

<ul>

- 特点：
  - 初始分配一定数目物理块
  - 运行期间可____
  - 缺页时从空闲队列分配
- 优缺点：
  - 优点：更加灵活
  - 缺点：可能降低并发能力

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>增减</li>
  </ul>
</details>
</div>

#### 可变分配局部置换

<ul>

- 特点：
  - 初始分配一定数目物理块
  - 只能从本进程页面中____
  - 根据缺页率动态调整分配
- 优点：
  - 保证进程不会过多调页
  - 保持系统并发能力
- 缺点：
  - 实现复杂
  - 开销较大

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>置换</li>
  </ul>
</details>
</div>

</ul>

### 物理块调入算法  

<ul>

#### 固定分配策略下的分配算法

<ul>

- 平均分配算法：平均分配给各进程
- 按比例分配算法：根据进程____分配
- 优先权分配算法：
  - 部分按比例分配
  - 部分按____分配

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>大小</li>
    <li>优先权</li>
  </ul>
</details>
</div>

</ul>

### 调入页面的时机  

<ul>

#### 预调页策略

<ul>

- 特点：一次调入多个____页面
- 优点：可能提高效率
- 缺点：预测成功率低(约____%)
- 应用：主要用于进程首次调入

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>相邻</li>
    <li>50</li>
  </ul>
</details>
</div>

#### 请求调页策略

<ul>

- 特点：运行中需要时才____
- 优点：
  - 调入页面必被访问
  - 易于实现
- 缺点：每次只调入一页，I/O开销大
- 应用：目前虚拟存储器主要采用此策略

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>调入</li>
  </ul>
</details>
</div>

</ul>

### 从何处调入页面  

<ul>

#### 外存分区

<ul>

- 文件区：存放文件，____分配
- 对换区：存放对换页面，____分配，I/O更快

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>离散</li>
    <li>连续</li>
  </ul>
</details>
</div>

#### 调入方式

<ul>

- 有足够对换区空间：
  - 全部从____区调入
  - 运行前需将文件复制到对换区
- 缺少对换区空间：
  - 不修改文件直接从____区调入
  - 可能修改的页面从对换区调入
- UNIX方式：
  - 未运行页面从文件区调入
  - 换出页面从对换区调入
  - 共享页面可直接使用

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>对换</li>
    <li>文件</li>
  </ul>
</details>
</div>

</ul>

### 如何调入页面  

<ul>

#### 缺页中断处理流程

<ul>

- 发现页面不在内存时：
  - 向CPU发出____中断
  - 转入中断处理程序
- 内存未满时：
  - 启动磁盘I/O调入所缺页
  - 修改____
- 内存已满时：
  - 选择换出页面
  - 若页面已修改则写回磁盘
  - 调入所缺页面
  - 修改页表
- 完成后利用新页表访问数据

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>缺页</li>
    <li>页表</li>
  </ul>
</details>
</div>

</ul>

</ul>

## 页面置换算法

<ul>

- 当进程访问的页面不在内存且内存无空闲空间时需要页面____
- 页面置换算法用于选择调出哪个页面
- 目标是追求更低的____率，因为换入换出需要磁盘I/O开销大

### 常见页面置换算法

<ul>

#### 最佳（OPT）置换算法

<ul>

- 基本原理
  - 选择淘汰以后永不使用或最长时间不再访问的____
  - 可获得最低缺页率
  - 无法实现(无法预测未来访问)
  - 可用于评价其他算法

- 示例分析
  - 系统分配____个物理块
  - 页面引用串：$7,0,1,2,0,3,0,4,2,3,0,3,2,1,2,0,1,7,0,1$
  - 置换过程
    - 先装入____三页
    - 访问2时换出____
    - 访问0时已在内存无需置换
    - 访问3时换出____
    
![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/61583c18c7ae930edd7d16c4dcff3c3ae7858119f6557eccd99e4b5398175ec7.jpg)

- 结果统计
  - 缺页中断____次
  - 页面置换____次

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>置换</li>
    <li>缺页</li>
    <li>页面</li>
    <li>3</li>
    <li>7,0,1</li>
    <li>7</li>
    <li>1</li>
    <li>9</li>
    <li>6</li>
  </ul>
</details>
</div>

#### 先进先出（FIFO）页面置换算法

<ul>

- 基本原理
  - 选择最早进入内存的页面____
  - 实现简单：页面按调入顺序排队
  - 性能较差：未利用____原理

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>淘汰</li>
    <li>局部性</li>
  </ul>
</details>
</div>

</ul>

</ul>

---

### HTML 代码示例（部分展示）

以下是部分内容的 HTML 代码示例，完整代码可根据上述 Markdown 内容按需生成：

```html
<h1>内存管理概念</h1>
<ul>
  <li>在学习本节时，请读者思考以下问题：
    <ul>
      <li>为什么要进行内存管理？</li>
      <li>多级页表解决了什么问题？又会带来什么问题？</li>
    </ul>
  </li>
  <li>在学习经典的管理方法前，同样希望读者先思考，自己给出一些内存管理的想法，并在学习过程中和经典方案进行比较。注意本节给出的内存管理是循序渐进的，后一种方法通常会解决前一种方法的不足。希望读者多多思考，比较每种方法的异同，看重掌握____管理。</li>
</ul>

<h2>内存管理的基本原理和要求</h2>
<ul>
  <h3>内存管理概述</h3>
  <ul>
    <li>内存管理是操作系统设计中最重要和最复杂的内容之一</li>
    <li>虽然内存容量不断增大，但仍需要对内存空间进行合理划分和____分配</li>
    <li>在多道程序设计中非常重要：
      <ul>
        <li>方便用户使用存储器</li>
        <li>提高内存____率</li>
        <li>通过虚拟技术扩充存储器</li>
      </ul>
    </li>
  </ul>
  <div>
    <details>
      <summary> </summary>
      <ul>
        <li>页式</li>
        <li>动态</li>
        <li>利用</li>
      </ul>
    </details>
  </div>
</ul>
```

---

以上内容严格遵循您的要求，挖空了关键词、公式和关键步骤，并将答案以折叠块形式列出，未改变原有结构，确保简洁明了便于记忆。如果需要完整 HTML 代码或其他调整，请告知！

以下是按照要求对提供的Markdown文档进行挖空处理后的结果，包含Markdown格式和HTML折叠块。挖空部分包括定义中的关键词、公式定理和算法关键步骤，答案置于折叠块中。文档结构保持不变，内容完整输出。

---

## 页面置换算法

<ul>

### 最佳（OPT）置换算法

<ul>

- 定义：
  - 在发生缺页时选择____的页面置换
  - 需要知道整个页面访问序列
- 应用举例：
  - 页面序列：$7,0,1,2,0,3,0,4,2,3,0,3$
  - 分配3个物理块
  - 访问2时换出最早进入的____
    - 访问3时换出最早的____
    - 总计____次页面置换

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/d9303910609604ffdc49a8d93279f88c91f4f105bd07496c65cd98a4e9bf8937.jpg)

- Belady异常现象
  - 定义：物理块增多但____次数增加
  - 示例：页面序列$3,2,1,0,3,2,4,3,2,1,0,4$
    - 3个物理块：____次缺页
    - 4个物理块：____次缺页

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/0fac7f8bd4c56893befd56f5a065cabcad42b9c28541021c3188fe483f19cead.jpg)

- 特点：只有____可能出现Belady异常

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

最长时间不再被访问</li>
    <li>

7</li>
    <li>

0</li>
    <li>

12</li>
    <li>

缺页</li>
    <li>

9</li>
    <li>

10</li>
    <li>

FIFO</li>
  </ul>
</details>
</div>

</ul>

#### 最近最久未使用（LRU）置换算法

<ul>

- 基本原理
  - 选择____的页面
  - 基于过去访问预测____
  - 为每页设置访问字段记录____
  - 需要硬件支持(____和____)

>pro：LRU算法的应用分析（2009、2015、2019）

- 示例分析
  - 访问2时换出最久未用的____
  - 访问3时换出最久未用的____

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/fb8c1a1a9ff760899ed4e2b7148eb6930e602e244b42f39ea5b1eceb8187008f.jpg)

- 算法特点
  - 性能____
  - 属于____类算法
  - ____出现Belady异常
  - "____看"而非"____看"

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

最近最长时间未使用</li>
    <li>

将来</li>
    <li>

未访问时间</li>
    <li>

寄存器</li>
    <li>

栈</li>
    <li>

7</li>
    <li>

1</li>
    <li>

较好</li>
    <li>

堆栈</li>
    <li>

不会</li>
    <li>

向前</li>
    <li>

向后</li>
  </ul>
</details>
</div>

</ul>

</ul>

### 时钟（CLOCK）置换算法

<ul>

#### 基本概念

<ul>

- LRU算法性能接近____，但开销____
- 操作系统设计者尝试用____开销接近LRU性能
- 这类算法都是CLOCK算法的____

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

OPT</li>
    <li>

大</li>
    <li>

小</li>
    <li>

变体</li>
  </ul>
</details>
</div>

</ul>

#### 简单CLOCK置换算法

<ul>

>pro：类CLOCK置换算法的过程分析（2012）

##### 工作原理

<ul>

- 为每页设置____位
  - 首次装入或访问时置为____
- 内存页面形成____队列
  - 有____指针相关联
  - 指针指向被替换页的____

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

访问</li>
    <li>

1</li>
    <li>

循环</li>
    <li>

替换</li>
    <li>

下一页</li>
  </ul>
</details>
</div>

</ul>

##### 置换过程

<ul>

- 检查页面访问位
  - 若为____：选择换出
  - 若为____：
    - 置为____
    - 给予____机会
    - 检查____页
- ____检查直到找到可换出页面

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

0</li>
    <li>

1</li>
    <li>

0</li>
    <li>

第二次</li>
    <li>

下一</li>
    <li>

循环</li>
  </ul>
</details>
</div>

</ul>

>pro：CLOCK算法的应用分析（2010）

##### 示例分析

<ul>

- 访问序列：$7,0,1,2,0,3,0,4,2,3,0,3,2,1,3,2$
- 分配____个页帧
- 页面结构：(____，____)

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/8b7911315f5bee6fa27e9b245e753c04e54c4f77d1a4cacc75a6be29a9037264.jpg)

- 具体过程：
  - 首次访问7,0,1,2：依次调入，访问位置____
  - 访问3时第____次缺页：
    - 扫描一周将访问位置____
    - 返回帧____替换
  - 访问4时第____次缺页：
    - 从帧____开始扫描
    - 找到帧____访问位为0并替换

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/2fb977bf56e778aeeb1826bdeb16c5a0556489c1fc630c31a806466dd18668cf.jpg)

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

4</li>
    <li>

页面号</li>
    <li>

访问位</li>
    <li>

1</li>
    <li>

5</li>
    <li>

0</li>
    <li>

1</li>
    <li>

6</li>
    <li>

2</li>
    <li>

3</li>
  </ul>
</details>
</div>

</ul>

</ul>

#### 改进型CLOCK置换算法

<ul>

>pro：改进CLOCK算法的思想（2018）

>pro：改进CLOCK算法的应用分析（2016、2021）

##### 改进原理

<ul>

- 增加____位考虑
  - 修改过的页面需____磁盘
  - 未修改页面不需____
- 页面分为四类(A为访问位，M为修改位)：
  - 1类(A=____,M=____)：最佳淘汰页
  - 2类(A=____,M=____)：次佳淘汰页
  - 3类(A=____,M=____)：可能再访问
  - 4类(A=____,M=____)：可能再访问

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

修改</li>
    <li>

写回</li>
    <li>

写回</li>
    <li>

0</li>
    <li>

0</li>
    <li>

0</li>
    <li>

1</li>
    <li>

1</li>
    <li>

0</li>
    <li>

1</li>
    <li>

1</li>
  </ul>
</details>
</div>

</ul>

##### 执行过程

<ul>

1. 第一轮扫描
   - 寻找____类页面(A=____,M=____)
   - 不改变____位
2. 第二轮扫描
   - 寻找____类页面(A=____,M=____)
   - 将扫描过页面访问位置____
3. 若仍失败
   - 返回____
   - 所有访问位置____
   - 重复前____步

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

1</li>
    <li>

0</li>
    <li>

0</li>
    <li>

访问</li>
    <li>

2</li>
    <li>

0</li>
    <li>

1</li>
    <li>

0</li>
    <li>

起点</li>
    <li>

0</li>
    <li>

两</li>
  </ul>
</details>
</div>

</ul>

##### 算法特点

<ul>

- 优点：减少____操作
- 缺点：可能需____扫描
- 基本原则：
  - 保留____的页面
  - 淘汰____页面
  - 优先考虑____页面

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

磁盘I/O</li>
    <li>

多轮</li>
    <li>

访问过</li>
    <li>

未访问</li>
    <li>

未修改</li>
  </ul>
</details>
</div>

</ul>

</ul>

</ul>

</ul>

## *抖动和工作集

<ul>

### 抖动

<ul>

#### 概念

<ul>

- 在页面置换过程中出现的最糟糕情形：
  - 刚换出的页面马上要____内存
  - 刚换入的页面马上要____内存
  - 这种频繁的页面调度行为称为____或____

>pro：抖动的处理措施（2011）

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

换入</li>
    <li>

换出</li>
    <li>

抖动</li>
    <li>

颠簸</li>
  </ul>
</details>
</div>

</ul>

#### 原因与影响

<ul>

- 根本原因：
  - 分配给每个进程的____太少
  - 不能满足进程____的基本要求
- 导致结果：
  - 进程运行时频繁出现____
  - 必须请求系统将所缺页面____内存
  - 对磁盘的访问时间____增加
  - 进程大部分时间用于页面____
  - CPU利用率____下降并趋于____

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

物理块</li>
    <li>

正常运行</li>
    <li>

缺页</li>
    <li>

调入</li>
    <li>

急剧</li>
    <li>

换入/换出</li>
    <li>

急剧</li>
    <li>

零</li>
  </ul>
</details>
</div>

</ul>

#### 解决思路

<ul>

- 抖动是____问题，必须采取相应措施解决
- 由于抖动与系统为进程分配____的多少（____）有关
- 提出了关于进程____的概念

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

严重</li>
    <li>

物理块</li>
    <li>

驻留集</li>
    <li>

工作集</li>
  </ul>
</details>
</div>

</ul>

</ul>

### 工作集

<ul>

#### 定义与特点

<ul>

- 工作集是指在某段时间间隔内，进程要访问的____集合
- 工作集W可由时间____和工作集窗口尺寸____来确定
- 例如，某个进程对页面的访问次序如下：

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/7e7650cbeee2c2313379c84decb64491b8962aec3f0e1b2705e0b3f4f6bdc05d.jpg)

>pro：工作集的应用分析（2016）

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

页面</li>
    <li>

t</li>
    <li>

Δ</li>
  </ul>
</details>
</div>

</ul>

#### 应用实例

<ul>

- 假设工作集窗口尺寸Δ设置为____：
  - t₁时刻，进程的工作集为____
  - t₂时刻，进程的工作集为____
- 实际应用特点：
  - 工作集窗口会设置得____
  - 对局部性好的程序，工作集大小一般比工作集窗口____小很多
  - 工作集反映了进程可能____访问的页面集合
  - 驻留集大小不能小于____，否则会频繁____

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

5</li>
    <li>

{2,3,5}</li>
    <li>

{1,2,3,4}</li>
    <li>

很大</li>
    <li>

Δ</li>
    <li>

频繁</li>
    <li>

工作集</li>
    <li>

缺页</li>
  </ul>
</details>
</div>

</ul>

</ul>

</ul>

</ul>

## 内存映射文件

<ul>

### 基本概念

<ul>

- 是操作系统向应用程序提供的____调用
- 与____内存相似
- 在磁盘文件与进程的____地址空间之间建立映射关系

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

系统</li>
    <li>

虚拟</li>
    <li>

虚拟</li>
  </ul>
</details>
</div>

</ul>

### 工作原理

<ul>

- 映射过程：
  - 进程将文件映射到____地址空间的某区域
  - 用访问____的方式读写文件
  - 将文件当作内存中的____数组访问
- 操作特点：
  - 不通过____操作来访问
  - 磁盘文件的读出/写入由____负责
  - 对进程是____的
  - 页面映射时不实际____文件内容
  - 仅在访问页面时才每次____地读入
  - 进程退出或关闭文件映射时，被改动的页面才____磁盘

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

虚拟</li>
    <li>

内存</li>
    <li>

大字符</li>
    <li>

文件I/O</li>
    <li>

操作系统</li>
    <li>

透明</li>
    <li>

读入</li>
    <li>

一页</li>
    <li>

写回</li>
  </ul>
</details>
</div>

</ul>

### 共享内存实现

<ul>

- 实现方式：
  - 通过映射____文件到通信进程的虚拟地址空间
  - 各进程虚拟地址空间____独立
  - 操作系统将对应虚拟地址空间映射到____物理内存

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/76a940c9c401911d0a3d8bdf085755a3db103cf97b89ec83e4dc8259b9c4ac6e.jpg)`
图3.28采用内存映射1/0的共享内存

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

相同</li>
    <li>

相互</li>
    <li>

相同</li>
  </ul>
</details>
</div>

</ul>

### 主要优点

<ul>

- 编程更____：
  - 已建立映射的文件只需按访问____方式读写
- 便于____：
  - 方便多个进程共享同一个____文件

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

简单</li>
    <li>

内存</li>
    <li>

共享</li>
    <li>

磁盘</li>
  </ul>
</details>
</div>

</ul>

</ul>

</ul>

## 虚拟存储器性能影响因素

<ul>

>pro：请求分页系统性能的影响因素分析（2020、2022）

### 缺页率影响因素

<ul>

#### 页面大小

<ul>

- 页面较大：
  - 缺页率____
  - 减少____长度
  - 页内____增大
- 页面较小：
  - 缺页率____
  - 减少____碎片
  - 提高内存____率
  - 进程要求页面____
  - 页表过长占用____内存

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

较低</li>
    <li>

页表</li>
    <li>

碎片</li>
    <li>

较高</li>
    <li>

内存</li>
    <li>

利用</li>
    <li>

多</li>
    <li>

大量</li>
  </ul>
</details>
</div>

</ul>

#### 物理块数量

<ul>

- 分配规律：
  - 物理块数越多，缺页率____
  - 超过某数目后改善____
- 分配原则：
  - 保证____页面在内存中
  - 保持缺页率在____范围
  - 避免____分配浪费内存

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

越低</li>
    <li>

不明显</li>
    <li>

活跃</li>
    <li>

很低</li>
    <li>

过度</li>
  </ul>
</details>
</div>

</ul>

#### 页面置换算法

<ul>

- 好的置换算法可____缺页率
- 建议选择：
  - ____算法
  - ____算法
- 目标：
  - 保留____访问的页面
  - 提高页面____速度

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

降低</li>
    <li>

LRU</li>
    <li>

CLOCK</li>
    <li>

可能</li>
    <li>

访问</li>
  </ul>
</details>
</div>

</ul>

#### 写回磁盘策略

<ul>

- 问题：
  - 频繁写回____低
- 解决方案：
  - 建立已修改换出页面____
  - 达到给定值时____写回
- 优点：
  - 减少磁盘____次数
  - 减少页面____开销
  - 便于快速____访问

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

效率</li>
    <li>

链表</li>
    <li>

批量</li>
    <li>

I/O</li>
    <li>

换出</li>
    <li>

重新</li>
  </ul>
</details>
</div>

</ul>

#### 程序编写方式

<ul>

- 局部化程度：
  - 程度越高，缺页率____
- 访问方式：
  - 应与____方式一致
  - 避免____访问造成高缺页率

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

越低</li>
    <li>

存储</li>
    <li>

不当</li>
  </ul>
</details>
</div>

</ul>

</ul>

### 地址翻译

<ul>

#### 系统条件

<ul>

- TLB、data Cache存储器以____为编址单位
- 虚拟地址____位
- 物理地址____位
- 页面大小为____B
- TLB为____路组相联，共有____个条目
- dataCache是____寻址、____映射的，行大小为____B，共有____组

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

字节</li>
    <li>

14</li>
    <li>

12</li>
    <li>

64</li>
    <li>

四</li>
    <li>

16</li>
    <li>

物理</li>
    <li>

直接</li>
    <li>

4</li>
    <li>

16</li>
  </ul>
</details>
</div>

</ul>

#### 地址结构分析

<ul>

##### 页面和偏移地址

<ul>

- 页内偏移地址：____位 (log₂(____/1B))
- 虚拟页号：____位 (____-____)
- 物理页号：____位 (____-____)

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

6</li>
    <li>

64B</li>
    <li>

8</li>
    <li>

14</li>
    <li>

6</li>
    <li>

6</li>
    <li>

12</li>
    <li>

6</li>
  </ul>
</details>
</div>

</ul>

##### TLB结构

<ul>

- 组数：____组 (____/____)
- 组索引：____位 (log₂____)
- TLB标记：____位

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

4</li>
    <li>

16</li>
    <li>

4</li>
    <li>

2</li>
    <li>

4</li>
    <li>

6</li>
  </ul>
</details>
</div>

</ul>

##### Cache结构

<ul>

- 块偏移：____位 (log₂____)
- 组索引：____位 (log₂____)
- 标记：____位

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

2</li>
    <li>

4</li>
    <li>

4</li>
    <li>

16</li>
    <li>

6</li>
  </ul>
</details>
</div>

</ul>

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/dbdeed3133ddcb8ed2cdd3bd10491b740e5e8cc58505a0c29ee261038ceb1e74.jpg)`

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/a5f7319265719ba6e25e3ec3f135197d7c99f1dfa9209f5bcd36dad1ffb46b67.jpg)`

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/7e154007b41dcd04b7e293781945dd249d0bd70f7887925b381c61eb3e4e83b7.jpg)`

</ul>

#### 地址访问过程分析

<ul>

##### 系统表项内容

<ul>

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/892bee3a9810f38bf11e2b68d97aa52d2018def60493e098ec7d75760ce43c16.jpg)`

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/52e61c9fd22d3430821b1c0a67807963a7773534f9c1ef10d7a1a349e61a025e.jpg)`

</ul>

##### 虚拟地址转换

<ul>

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/1e7807571355ea09050aeba0b7ec561b9e3a7526b7b11926e613b2ddb448876c.jpg)`

</ul>

##### 地址0x03d4访问过程

<ul>

- TLB查找：
  - 组索引：____
  - TLB标记：____
  - 结果：____，物理页号为____
- 物理地址：____（____）

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

3</li>
    <li>

0x03</li>
    <li>

命中</li>
    <li>

0d</li>
    <li>

0x354</li>
    <li>

001101010100</li>
  </ul>
</details>
</div>

</ul>

##### 地址0x00f1访问过程

<ul>

- TLB查找：
  - 组索引：____
  - TLB标记：____
  - 结果：____
- 页表查找：
  - 虚拟页号：____
  - 结果：页面在____中，物理页号为____
- 物理地址：____（____）

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

3</li>
    <li>

0x00</li>
    <li>

未命中</li>
    <li>

0x03</li>
    <li>

主存</li>
    <li>

02</li>
    <li>

0x0b1</li>
    <li>

000010110001</li>
  </ul>
</details>
</div>

</ul>

##### 地址0x0229访问过程

<ul>

- TLB查找：
  - 组索引：____
  - TLB标记：____
  - 结果：____
- 页表查找：
  - 虚拟页号：____
  - 结果：页面不在____中，产生____中断

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

0</li>
    <li>

0x02</li>
    <li>

未命中</li>
    <li>

0x08</li>
    <li>

主存</li>
    <li>

缺页</li>
  </ul>
</details>
</div>

</ul>

</ul>

#### Cache访问分析

<ul>

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/1e8cd1180558d839295c7746012ed8552118b1d827ec9f3c7f9e18ff80a654d1.jpg)`

##### 地址0x354的Cache访问

<ul>

- Cache索引：____
- Cache标记：____
- 结果：____，块____
- 内容：____

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

5</li>
    <li>

0x0d</li>
    <li>

命中</li>
    <li>

0</li>
    <li>

36H</li>
  </ul>
</details>
</div>

</ul>

##### 地址0x0b1的Cache访问

<ul>

- Cache索引：____
- Cache标记：____
- 结果：____，需要访问____
- 访问位置：物理页号____，偏移____

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

c</li>
    <li>

0x02</li>
    <li>

未命中</li>
    <li>

主存</li>
    <li>

2</li>
    <li>

0x31</li>
  </ul>
</details>
</div>

</ul>

</ul>

</ul>

</ul>

## 本节小结

<ul>

本节开头提出的问题的参考答案如下。

1）为什么要引入____内存？

上一节提到过，多道程序并发执行不仅使进程之间共享了处理器，而且同时共享了____。然而，随着对处理器需求的增长，进程的执行速度会以某种合理平滑的方式慢下来。但是，若同时运行的进程太多，则需要很多的内存，当一个程序没有内存空间可用时，那么它甚至无法运行。所以，在物理上扩展内存相对有限的条件下，应尝试以一些其他可行的方式在____上扩充内存。

2）虚拟内存（虚存）空间的大小由什么因素决定？

虚存的容量要满足以下两个条件：

① 虚存的实际容量 $\leqslant$ ____容量和____容量之和，这是硬件的硬性条件规定的，若虚存的实际容量超过了这个容量，则没有相应的空间来供虚存使用。

②虚存的最大容量≤计算机的____位数能容纳的最大容量。假设地址是32位的，按字节编址，一个地址代表1B存储空间，则虚存的最大容量 $\leqslant$ ____ $2^{32}\mathrm{B}$ )。这是因为若虚存的最大容量超过4GB，则32位的地址将无法访问全部虚存，也就是说4GB以后的空间被浪费了，相当于没有一样，没有任何意义。

实际虚存的容量是取条件 $^{;\bigstar}$ 和 $^{(2)}$ 的____，即两个条件都要满足，仅满足一个条件是不行的。

3）虚拟内存是怎么解决问题的？会带来什么问题？

虚拟内存使用____上的空间来扩充内存空间，通过一定的____/____，使得整个系统在逻辑上能够使用一个远远超出其物理内存大小的内存容量。因为虚拟内存技术调换页面时需要访问____，会导致平均访存时间____，若使用了不合适的____算法，则会大大降低系统性能。

本节学习了____种页面置换算法，要将它们与处理机调度算法区分开。当然，这些调度算法之间也是有联系的，它们都有一个共同点，即通过一定的____决定资源的分配对象。在处理机调度算法中这些准则比较多，有优先级、响应比、时间片等，而在页面调度算法中就比较简单，即是否被用到过或近段时间内是否经常使用。在操作系统中，几乎每类资源都会有相关的调度算法，读者通过将这些调度算法作为线索，可将整个操作系统的课程连成一个整体。

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

虚拟</li>
    <li>

主存</li>
    <li>

逻辑</li>
    <li>

内存</li>
    <li>

外存</li>
    <li>

地址</li>
    <li>

4GB</li>
    <li>

交集</li>
    <li>

外存</li>
    <li>

换入</li>
    <li>

换出</li>
    <li>

外存</li>
    <li>

增加</li>
    <li>

替换</li>
    <li>

4</li>
    <li>

准则</li>
  </ul>
</details>
</div>

</ul>

</ul>

# 本章疑难点

<ul>

分页管理方式和分段管理方式在很多地方是相似的，比如在内存中都是____的、都有地址变换机构来进行地址____等。但两者也存在许多区别，表3.6列出了两种方式的对比。

表3.6分页管理方式和分段管理方式的比较
![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/0e284641a05efcae2eb9311512844c4a61986a86581546ebdabc28e74db69cd7.jpg)

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

不连续</li>
    <li>

映射</li>
  </ul>
</details>
</div>

</ul>

---

以上内容严格按照要求处理，挖空关键词、公式和关键步骤，并在每个次级标题下以HTML折叠块形式提供答案。折叠块使用`<details>`和`<summary>`标签，答案以`<ul>`和`<li>`标签列出，确保Markdown公式渲染正确。原文档结构和内容未做任何改变或省略。

