# above

<ul>

## 【考纲内容】

<ul>

（一）文件

文件的基本概念：文件____和索引节点（inode）文件的操作：____，删除，打开，关闭，读，写 文件的保护：文件的____结构；文件的____结构

（二）目录

目录的____概念；____目录；目录的____；硬链接和____链接

（三）文件系统

文件系统的____结构（layout）：文件系统在____中的结构，文件系统在____中的结构外存空闲空间管理办法：虚拟文件系统：文件系统____（mounting）

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>元数据</li>
    <li>建立</li>
    <li>逻辑</li>
    <li>物理</li>
    <li>基本</li>
    <li>树形</li>
    <li>操作</li>
    <li>软</li>
    <li>全局</li>
    <li>外存</li>
    <li>内存</li>
    <li>挂载</li>
  </ul>
</details>
</div>

</ul>

## 【复习提示】

<ul>

- 本章内容概述：
  - 内容较为具体，需要重视对____的理解。

- 重点掌握的知识点：
  - 文件系统的____及其实现。
  - 文件____和空闲空间管理。
  - 文件____块。
  - ____分配方法。
  - ____结构。
  - ____目录结构。
  - 文件____原理。
  - 文件系统的____。
  - 虚拟文件系统____。

- 易于考查的内容：
  - 这些都是统考真题中容易____的内容。

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>概念</li>
    <li>结构</li>
    <li>分配</li>
    <li>控制</li>
    <li>物理</li>
    <li>索引</li>
    <li>树形</li>
    <li>共享</li>
    <li>布局</li>
    <li>原理</li>
    <li>考查</li>
  </ul>
</details>
</div>

</ul>

# 文件系统基础

<ul>

在学习本节时，请读者思考以下问题

1）什么是____？

2）单个文件的____结构和____结构之间是否存在某些制约关系？

本节内容较为抽象，要注意区分文件的逻辑结构和物理结构。在学习过程中，可尝试以上面的两个问题为线索，构建整个文件系统的概念。在前面的学习中，曾经提醒过读者不要忽略对基本概念的理解。从历年的情况来看，大部分同学对进程管理、内存管理有较好的掌握，但对于文件管理及后面的I/O管理，往往理解不太深入。在考试中，即使面对一些基本问题也容易失分，这十分可惜。主要原因还是对概念的理解不够全面和透彻，希望读者能够关注这个问题。

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>文件</li>
    <li>逻辑</li>
    <li>物理</li>
  </ul>
</details>
</div>

</ul>

## 基本概念

<ul>

### 文件的本质

<ul>

- 文件是以____为载体的存储在计算机上的信息集合
  - 可以是文本文档、图片、程序等
- 系统资源调度与文件的关系
  - 系统运行时：以____为基本单位进行资源调度和分配
  - 用户输入输出：以____为基本单位
- 文件系统的需求
  - 大多数应用程序通过文件实现____
  - 用户需要访问、修改和保存文件等____功能
  - 系统需提供文件管理系统来实现这些____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>硬盘</li>
    <li>进程</li>
    <li>文件</li>
    <li>输入输出</li>
    <li>管理</li>
    <li>需求</li>
  </ul>
</details>
</div>

</ul>

### 文件的定义

<ul>

#### 文件的组成要素

<ul>

- 存储空间中的____
- ____和索引信息
- 访问____信息

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>数据</li>
    <li>分类</li>
    <li>权限</li>
  </ul>
</details>
</div>

</ul>

#### 图书馆管理类比

<ul>

- 书籍内容 ≈ 文件____
- 分类编号系统 ≈ 文件____和查找
- 借阅权限 ≈ 文件访问____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>数据</li>
    <li>分类</li>
    <li>权限</li>
  </ul>
</details>
</div>

</ul>

#### 文件系统的用户视角

<ul>

- 用户关注点
  - 文件____、分类和查找
  - 文件数据____性
  - 可进行的____
- 用户不关注的细节
  - 文件____方式
  - ____区域管理

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>命名</li>
    <li>安全</li>
    <li>操作</li>
    <li>存储</li>
    <li>辅存</li>
  </ul>
</details>
</div>

</ul>

#### 文件的层次结构

<ul>

##### 数据项

<ul>

- 基本数据项：描述对象某属性的最小____单位
- 组合数据项：多个基本数据项的____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>逻辑</li>
    <li>组合</li>
  </ul>
</details>
</div>

</ul>

##### 记录

<ul>

- 相关数据项的____
- 用于描述对象某方面____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>集合</li>
    <li>属性</li>
  </ul>
</details>
</div>

</ul>

##### 文件类型

<ul>

- 有结构文件：由相似____组成
- 无结构文件：视为____流

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>记录</li>
    <li>字符</li>
  </ul>
</details>
</div>

</ul>

</ul>

</ul>

### 文件的属性

<ul>

- 基本属性列表
  1. ____：唯一标识
  2. ____：支持不同文件系统
  3. 创建者ID
  4. 所有者ID
  5. 位置____
  6. ____信息
  7. 访问控制信息
  8. ____相关信息
     - 创建时间
     - 最后修改时间
     - 最后存取时间

> pro：文件属性信息的存储位置（2009）

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>名称</li>
    <li>类型</li>
    <li>指针</li>
    <li>大小</li>
    <li>时间</li>
  </ul>
</details>
</div>

</ul>

### 文件的分类

<ul>

#### 按性质和用途

<ul>

- ____文件
- 用户文件
- ____文件

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>系统</li>
    <li>库</li>
  </ul>
</details>
</div>

</ul>

#### 按数据形式

<ul>

- ____文件
- 目标文件
- ____文件

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>源</li>
    <li>可执行</li>
  </ul>
</details>
</div>

</ul>

#### 按存取控制属性

<ul>

- 可执行文件
- ____文件
- ____文件

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>只读</li>
    <li>读/写</li>
  </ul>
</details>
</div>

</ul>

#### 按组织形式和处理方式

<ul>

- 普通文件
- ____文件
- ____文件

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>目录</li>
    <li>特殊</li>
  </ul>
</details>
</div>

</ul>

</ul>

</ul>

</ul>

## 文件控制块和索引节点

<ul>

与进程管理一样，为便于文件管理，引入了文件控制块的数据结构。

### 文件控制块和索引节点

<ul>

#### 文件控制块

<ul>

- FCB是存放控制文件需要的各种信息的____结构，用于实现按名存取
- FCB与文件____对应，FCB的有序集合称为文件目录
  - 一个FCB就是一个文件____项
  - 文件目录也被视为一个____文件
- 创建新文件时，系统建立FCB记录文件____

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/42e00482cf2da53c34734fbedeb938ce4d87d374115b0af2a6d8e85421ac59c8.jpg)

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/4c9849ace7df7caf82295ecbc683a1c21d78d5eae7b5a90795e9071a8342ca52.jpg)

##### FCB主要信息

<ul>

- 基本信息
  - 文件名
  - 文件的____位置
  - 文件的____结构
  - 文件的____结构
- 存取控制信息
  - 文件主的存取____
  - 核准用户的存取____
  - 一般用户的存取____
- 使用信息
  - 文件建立____
  - 上次修改____

</ul>

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>数据</li>
    <li>一一</li>
    <li>目录</li>
    <li>目录</li>
    <li>属性</li>
    <li>物理</li>
    <li>逻辑</li>
    <li>物理</li>
    <li>权限</li>
    <li>权限</li>
    <li>权限</li>
    <li>时间</li>
    <li>时间</li>
  </ul>
</details>
</div>

</ul>

#### 索引节点

<ul>

> pro：目录项结构的相关分析与计算（2020、2022）

##### 索引节点概述

<ul>

- 文件目录存放在____上，大量文件会占用多个盘块
- UNIX系统采用文件名和描述信息____方法
  - 描述信息形成索引节点(____)数据结构
  - 目录项仅包含文件名和索引节点____

> pro：索引节点号与文件容量的关系（2018、2020）

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>磁盘</li>
    <li>分离</li>
    <li>inode</li>
    <li>号</li>
  </ul>
</details>
</div>

</ul>

##### 索引节点效率分析

<ul>

- FCB方案
  - FCB大小：____B
  - 盘块大小：____KB
  - 每盘块存放____个FCB
  - 640个FCB需要平均____次磁盘启动
- UNIX目录项方案
  - 目录项大小：____B(14B文件名+2B索引节点号)
  - 每盘块存放____个目录项
  - 磁盘启动次数减少到原来的____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>64</li>
    <li>1</li>
    <li>16</li>
    <li>20</li>
    <li>16</li>
    <li>64</li>
    <li>1/4</li>
  </ul>
</details>
</div>

</ul>

##### 索引节点类型

<ul>

###### 磁盘索引节点

<ul>

- 每个文件唯一对应一个磁盘索引____
- 主要内容：
  - 文件主____符
  - 文件____
  - 文件存取____
  - 文件____地址(13个地址项)
  - 文件____
  - 文件链接____
  - 文件存取____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>节点</li>
    <li>标识</li>
    <li>类型</li>
    <li>权限</li>
    <li>物理</li>
    <li>长度</li>
    <li>计数</li>
    <li>时间</li>
  </ul>
</details>
</div>

</ul>

###### 内存索引节点

<ul>

- 文件打开时，磁盘索引节点复制到____
- 额外内容：
  - 索引节点____
  - ____(上锁/修改标记)
  - 访问____
  - 逻辑设备____
  - 链接____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>内存</li>
    <li>号</li>
    <li>状态</li>
    <li>计数</li>
    <li>号</li>
    <li>指针</li>
  </ul>
</details>
</div>

</ul>

</ul>

</ul>

- FCB或索引节点类比：相当于图书馆中图书的____号

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>索书</li>
  </ul>
</details>
</div>

</ul>

</ul>

</ul>

## 文件的操作

<ul>

### 文件的基本操作

<ul>

#### 基本操作类型

<ul>

- 文件属于抽象____类型
- 需要考虑可以对文件执行的____
- 操作系统提供系统调用实现以下操作：
  - ____
  - 删除
  - ____
  - 写
  - ____
  - 关闭

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>数据</li>
    <li>操作</li>
    <li>创建</li>
    <li>读</li>
    <li>打开</li>
  </ul>
</details>
</div>

</ul>

##### 创建文件

<ul>

- 两个必要步骤：
  - 为新文件分配____空间
  - 在目录中创建____项
    - 记录新文件名
    - 记录文件在外存中的____等信息

> pro：文件删除的过程（2013、2021)

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>外存</li>
    <li>目录</li>
    <li>地址</li>
  </ul>
</details>
</div>

</ul>

##### 删除文件

<ul>

- 删除步骤：
  - 根据文件名查找____
  - 删除指定文件对应的____项和文件控制块
  - 回收该文件所占用的____空间
    - 包括磁盘空间
    - 包括内存缓冲区

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>目录</li>
    <li>目录</li>
    <li>存储</li>
  </ul>
</details>
</div>

</ul>

##### 读文件

<ul>

- 读取步骤：
  - 根据文件名查找____
  - 找到指定文件的____项
  - 从中得到文件在____中的地址
  - 使用目录项中的读____进行读操作

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>目录</li>
    <li>目录</li>
    <li>外存</li>
    <li>指针</li>
  </ul>
</details>
</div>

</ul>

##### 写文件

<ul>

- 写入步骤：
  - 根据文件名查找____
  - 找到指定文件的____项
  - 利用目录项中的写____进行写操作
  - 每次写操作后更新写____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>目录</li>
    <li>目录</li>
    <li>指针</li>
    <li>指针</li>
  </ul>
</details>
</div>

</ul>

</ul>

</ul>

### 文件的打开与关闭

<ul>

> pro：文件打开的过程（2014）

#### 打开文件机制

<ul>

- 目的：避免多次重复检索____
- 实现方式：
  - 用户首次操作需要使用____系统调用
  - 系统维护打开____表
  - "打开"过程：
    - 检索指定文件的____项
    - 将目录项从外存复制到打开____表
    - 返回文件____符给用户
  - 后续操作通过文件描述符查找____

> pro：多进程同时打开文件的分析（2017、2020）

> pro：文件关闭的过程（2023）

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>目录</li>
    <li>open</li>
    <li>文件</li>
    <li>目录</li>
    <li>文件</li>
    <li>描述</li>
    <li>信息</li>
  </ul>
</details>
</div>

</ul>

#### 多进程文件访问结构

<ul>

- 采用两级表结构：
  - 整个系统表
    - 包含与进程无关的____
    - 文件在磁盘上的____
    - 访问____
    - 文件____
  - 每个进程表
    - 保存进程对文件的使用____
    - 当前读写____
    - 文件访问____
    - 指向系统表条目的____

- 文件打开机制：
  - 首次打开：系统表创建____
  - 其他进程打开：进程表增加条目并指向____表
  - 使用打开____(OpenCount)记录打开进程数
  - 关闭过程：
    - 删除进程表____
    - 系统表计数器____
    - 计数为0时删除系统表____

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/893b6e7893b73c67d7fe74d1969ba469fd1ddf4c1cb25d0b5103ed645b6a95ab.jpg)
图4.3内存中文件的系统结构

> pro：文件名和文件描述符的应用场景（2012、2017、2024）

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>信息</li>
    <li>位置</li>
    <li>日期</li>
    <li>大小</li>
    <li>信息</li>
    <li>指针</li>
    <li>权限</li>
    <li>指针</li>
    <li>条目</li>
    <li>系统</li>
    <li>计数器</li>
    <li>条目</li>
    <li>递减</li>
    <li>条目</li>
  </ul>
</details>
</div>

</ul>

#### 文件访问标识

<ul>

- 文件名特点：
  - 不是打开文件表必需____
  - FCB定位后不再____
- 文件描述符：
  - UNIX称为文件____
  - Windows称为文件____
  - 文件未关闭时通过描述符进行____

> attention:

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>部分</li>
    <li>使用</li>
    <li>描述符</li>
    <li>句柄</li>
    <li>操作</li>
  </ul>
</details>
</div>

</ul>

#### 文件关联信息

<ul>

- 文件指针
  - 跟踪上次读写____
  - 作为当前文件位置____
  - 对每个进程____
  - 与磁盘文件____分开保存
- 文件打开计数
  - 跟踪文件打开和关闭____
  - 多进程可能打开同一____
  - 最后一个进程关闭后删除____
- 文件磁盘位置
  - 保存在内存中避免重复____
  - 用于文件数据____操作
- 访问权限
  - 每个进程打开文件需要访问____
    - 创建
    - 只读
    - 读写
    - 添加等
  - 保存在进程打开____表
  - 用于控制____请求

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>位置</li>
    <li>指针</li>
    <li>唯一</li>
    <li>属性</li>
    <li>数量</li>
    <li>文件</li>
    <li>条目</li>
    <li>读取</li>
    <li>修改</li>
    <li>模式</li>
    <li>文件</li>
    <li>I/O</li>
  </ul>
</details>
</div>

</ul>

</ul>

</ul>

</ul>

## 文件保护

<ul>

为了防止文件共享可能会导致文件被破坏或未经核准的用户修改文件，文件系统必须控制用户对文件的____，即解决对文件的读、写、执行的许可问题。为此，必须在文件系统中建立相应的文件____机制，可以通过口令保护、加密保护和访问控制等方式实现。其中，口令和加密是为了防止用户文件被他人存取或窃取，而访问控制则用于控制用户对文件的____方式。

### 访问类型

<ul>

- 主要访问类型：
  - 读：从文件中____
  - 写：向文件中____
  - 执行：将文件装入内存并____
  - 添加：将新信息添加到文件____部分
  - 删除：删除文件，释放____
  - 列表清单：列出文件名和文件____

- 其他控制：
  - 文件重命名、复制、编辑等高层____
  - 通过系统程序调用低层系统调用____
  - 保护可以只在低层____
    - 例如：具有读访问权限即可复制和打印

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>存取</li>
    <li>保护</li>
    <li>访问</li>
    <li>读</li>
    <li>写</li>
    <li>执行</li>
    <li>结尾</li>
    <li>空间</li>
    <li>属性</li>
    <li>功能</li>
    <li>实现</li>
    <li>提供</li>
  </ul>
</details>
</div>

</ul>

### 访问控制

<ul>

#### 基于身份的访问控制

<ul>

- 访问控制列表(ACL)方法：
  - 优点：可使用复杂的访问____
  - 缺点：长度无法____，可能导致复杂的空间管理
  - 解决方案：使用精简的访问____

> pro：文件访问控制表的结构（2017）

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>方法</li>
    <li>预计</li>
    <li>列表</li>
  </ul>
</details>
</div>

</ul>

#### 精简访问控制列表

<ul>

- 三种用户类型：
  - 拥有者：创建文件的____
  - 组：共享文件且具有类似访问的____群
  - 其他：系统内所有其他____

- 实现机制：
  - 每项占用一个____位
  - 使用____矩阵描述访问权限
  - 文件创建时记录所有者和组信息在____中
  - 访问权限判定机制：
    - 文件主按____权限访问
    - 同组用户按____权限访问
    - 其他用户按____权限访问

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/78822bd83083d7593e5f6b94b77320fd372e6563c1b1c256745528bdf97e8d4d.jpg)

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>用户</li>
    <li>用户</li>
    <li>用户</li>
    <li>二进制</li>
    <li>3×4位</li>
    <li>FCB</li>
    <li>所有者</li>
    <li>组</li>
    <li>其他</li>
  </ul>
</details>
</div>

</ul>

#### 其他访问控制方法

<ul>

##### 口令控制

<ul>

- 特点：
  - 建立文件时提供____
  - 系统在FCB中附加____
  - 访问时需提供相应____
- 优缺点：
  - 优点：时间和空间开销____
  - 缺点：口令存储在系统内部，____性不足

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>口令</li>
    <li>口令</li>
    <li>口令</li>
    <li>小</li>
    <li>安全</li>
  </ul>
</details>
</div>

</ul>

##### 密码控制

<ul>

- 特点：
  - 文件____保护
  - 访问需要____
- 优缺点：
  - 优点：保密性____，节省存储空间
  - 缺点：编码和译码____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>加密</li>
    <li>密钥</li>
    <li>强</li>
    <li>耗时</li>
  </ul>
</details>
</div>

</ul>

##### 目录保护

<ul>

- 保护范围：
  - 单个文件____
  - 子目录内文件____
- 特点：
  - 目录操作与文件操作____
  - 需要不同的____机制

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>保护</li>
    <li>保护</li>
    <li>不同</li>
    <li>保护</li>
  </ul>
</details>
</div>

</ul>

</ul>

</ul>

</ul>

</ul>

## 文件的逻辑结构

<ul>

- 文件的逻辑结构是指从____角度出发所看到的文件的组织形式
- 文件的物理结构（又称存储结构）是指将文件存储在____上的存储组织形式，是用户所看不见的
- 文件的逻辑结构与存储介质特性____，它实际上是指在文件的内部，数据在逻辑上是如何____起来的

按逻辑结构，文件可划分为____文件和____文件两大类。

### 无结构文件

<ul>

- 最____的文件组织形式
- 由____流构成，又称流式文件
- 特点：
  - 长度以____为单位
  - 通过读/写____访问
  - 应用于源程序、可执行文件、库函数等
- 局限性：
  - 没有结构，只能通过____搜索访问记录
  - 对很多应用不____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>用户</li>
    <li>外存</li>
    <li>无关</li>
    <li>组织</li>
    <li>无结构</li>
    <li>有结构</li>
    <li>简单</li>
    <li>字符</li>
    <li>字节</li>
    <li>指针</li>
    <li>穷举</li>
    <li>适用</li>
  </ul>
</details>
</div>

</ul>

### 有结构文件

<ul>

- 由一个以上的____构成，又称记录式文件

#### 按记录长度分类

<ul>

##### 定长记录

<ul>

- 所有记录长度____
- 数据项位置和长度____
- 优点：
  - 检索速度____
  - 方便____
  - 广泛用于数据____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>相同</li>
    <li>固定</li>
    <li>快</li>
    <li>处理</li>
    <li>处理</li>
  </ul>
</details>
</div>

</ul>

##### 变长记录

<ul>

- 各记录长度不一定____
- 原因：
  - 数据项数目____
  - 数据项长度____
- 缺点：只能顺序查找，速度____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>相同</li>
    <li>不同</li>
    <li>不定</li>
    <li>慢</li>
  </ul>
</details>
</div>

</ul>

</ul>

#### 按记录组织形式分类

<ul>

##### 顺序文件

<ul>

- 记录一个接一个顺序____
- 可包含定长或变长____
- 排列结构：
  - 串结构：
    - 记录顺序与关键字____
    - 按存入时间____
    - 需从头顺序____
  - 顺序结构：
    - 按关键字顺序____
    - 定长记录可用折半____
- 特点：
  - 批量操作效率____
  - 适合顺序存储____
  - 单记录操作性能____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>排列</li>
    <li>记录</li>
    <li>无关</li>
    <li>排列</li>
    <li>查找</li>
    <li>排列</li>
    <li>查找</li>
    <li>最高</li>
    <li>设备</li>
    <li>差</li>
  </ul>
</details>
</div>

</ul>

##### 索引文件

<ul>

- 建立____表提高检索效率
- 结构：
  - 为每个记录设置索引____项
  - 包含记录____和长度
  - 索引表按关键字____

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/eb9d674d05888c7f26d7eac9891539314e3a96e19941c26b4ab65a74299eedbb.jpg)
图4.4索引文件示意图

- 优缺点：
  - 优点：加快检索____
  - 缺点：增加存储____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>索引</li>
    <li>表</li>
    <li>指针</li>
    <li>排序</li>
    <li>速度</li>
    <li>开销</li>
  </ul>
</details>
</div>

</ul>

##### 索引顺序文件

<ul>

- 结合顺序文件和索引文件____
- 组织方式：
  - 记录分组____
  - 建立组首记录____表
  - 组内记录可____
  - 组间关键字____

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/77c339574ccf62a58e641983cd07b2b604a07238b667f6c76d33f50290e230c7.jpg)
图4.5索引顺序文件示意图

- 查找效率：
  - 顺序文件：平均需查找____次
  - 索引顺序文件：仅需查找____次
- 特点：
  - 提高查找____
  - 可采用多级____
  - 增加存储____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>特点</li>
    <li>存储</li>
    <li>索引</li>
    <li>无序</li>
    <li>有序</li>
    <li>N/2</li>
    <li>√N</li>
    <li>效率</li>
    <li>索引</li>
    <li>空间</li>
  </ul>
</details>
</div>

</ul>

##### 直接文件或散列文件（HashFile）

<ul>

- 通过键值或____函数直接定位记录
- 特点：
  - 存取速度____
  - 可能产生____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>散列</li>
    <li>高</li>
    <li>冲突</li>
  </ul>
</details>
</div>

</ul>

</ul>

</ul>

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>记录</li>
  </ul>
</details>
</div>

</ul>

## 文件的物理结构

<ul>

- 文件的物理结构研究文件的____方式
  - 研究文件数据在物理存储设备上的____和组织
  - 包含两个方面：
    - 文件的____方式（对磁盘非空闲块的管理）
    - 文件存储空间管理（对磁盘空闲块的管理，详见4.3节）

> pro：不同物理结构的特点和比较（2009、2011、2013、2020）

- 文件分配方法（对应文件的物理结构）：
  - ____分配
  - 链接分配
  - ____分配
  - 注意与文件的____结构区分
- 磁盘存储单元：
  - 分为磁盘____
  - 大小通常与内存页面____
  - 内存与磁盘数据交换以____为单位

### 连续分配

<ul>

> pro：连续分配的应用和分析（2011、2012、2014）

- 特点：
  - 要求文件在磁盘上占有____的块
  - 磁盘地址呈____排序
  - 减少寻道数和寻道____

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/b6a39a462bc9f979d41141910def90539790a0b16d15bdd45bfcfd33eabc0ba3.jpg)
图4.6连续分配

- 实现方式：
  - 记录存储在相邻物理____中
  - 目录项记录：
    - 第一个磁盘____号
    - 占用____数
  - 访问第i块：直接访问块____
- 优点：
  - 支持顺序访问和直接____
  - 顺序访问速度____
  - 磁头移动距离____
- 缺点：
  - 产生外部____
  - 需预知文件____
  - 不支持动态____
  - 记录操作需物理____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>实现</li>
    <li>分布</li>
    <li>分配</li>
    <li>索引</li>
    <li>连续</li>
    <li>逻辑</li>
    <li>块</li>
    <li>相同</li>
    <li>块</li>
    <li>连续</li>
    <li>线性</li>
    <li>时间</li>
    <li>块</li>
    <li>块</li>
    <li>访问</li>
    <li>b+i-1</li>
    <li>访问</li>
    <li>快</li>
    <li>最小</li>
    <li>碎片</li>
    <li>长度</li>
    <li>增长</li>
    <li>移动</li>
  </ul>
</details>
</div>

</ul>

### 链接分配

<ul>

- 采用____分配方式
- 优点：
  - 消除外部____
  - 支持动态____
  - 便于文件____

#### 隐式链接

<ul>

> pro：链接分配的应用和分析（2014）

- 组织方式：
  - 目录项包含首尾块____
  - 磁盘块可____存储
  - 每块含下一块____
  - 指针对用户____

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/6d9292085dcbca8e228af2a372270ec49d72b5570153260a355bffa0f5e93c11.jpg)
图4.7隐式链接分配

- 缺点：
  - 仅支持顺序____
  - 稳定性____
  - 指针占用存储____

> pro：文件空间分配与簇的关系（2017、2018）

- 改进方案：
  - 多个盘块组成____
  - 按簇____
  - 减少查找____
  - 缺点：增加内部____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>离散</li>
    <li>碎片</li>
    <li>分配</li>
    <li>操作</li>
    <li>指针</li>
    <li>分散</li>
    <li>指针</li>
    <li>透明</li>
    <li>访问</li>
    <li>差</li>
    <li>空间</li>
    <li>簇</li>
    <li>分配</li>
    <li>时间</li>
    <li>碎片</li>
  </ul>
</details>
</div>

</ul>

#### 显式链接

<ul>

- 特点：
  - 链接指针集中____
  - 使用文件分配表(____)
  - 目录仅记录起始____号

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/8477c36d6d340ca093d8331ea371effd24039a9f54ae4c8fc37291be6563af46.jpg)
图4.8文件分配表

> pro：FAT的作用（2019）

- FAT特点：
  - 表项与磁盘块____对应
  - 使用特殊数字标记：
    - ____表示文件最后一块
    - ____表示空闲块
  - 可管理空闲____
- 优点：
  - 支持顺序和直接____
  - 检索速度____
  - 减少磁盘____
- 缺点：
  - 占用内存____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>存储</li>
    <li>FAT</li>
    <li>块</li>
    <li>一一</li>
    <li>-1</li>
    <li>-2</li>
    <li>空间</li>
    <li>访问</li>
    <li>快</li>
    <li>访问</li>
    <li>空间</li>
  </ul>
</details>
</div>

</ul>

</ul>

</ul>

### 索引分配

<ul>

#### 单级索引分配方式

<ul>

> pro：索引分配的应用和分析（2012）

- 基本思想：
  - 打开文件时只需将对应盘块编号调入____
  - 将每个文件的盘块号集中放在____
  - 为每个文件分配一个索引____(表)
  - 记录所有分配的盘块____

- 容量计算示例：
  - 盘块大小：____KB
  - 盘块号占用：____B
  - 一个索引块可存放：____个盘块号
  - 最大文件支持：____

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/e89abaa2fe9a3250aaac1146ba1803296a3c594654e57dcb4cc4432213350843.jpg)
图4.9索引分配

- 优缺点：
  - 优点：
    - 支持直接____
    - 不产生外部____
  - 缺点：
    - 索引块增加存储____
    - 小文件利用率____
    - 大文件需要多个____块

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>内存</li>
    <li>一起</li>
    <li>块</li>
    <li>号</li>
    <li>4</li>
    <li>4</li>
    <li>1024</li>
    <li>$1024\times4\mathrm{KB}=4\mathrm{MB}$</li>
    <li>访问</li>
    <li>碎片</li>
    <li>开销</li>
    <li>低</li>
    <li>索引</li>
  </ul>
</details>
</div>

</ul>

#### 多级索引分配方式

<ul>

- 基本原理：
  - 为索引块建立主____
  - 类似多级____机制
  - 可扩展到三级、四级____

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/dd6b002ebe09e54ebdc097237203c876304e6533e28b9d9f7c42459b4904fcfd.jpg)
图4.10二级索引分配

- 容量计算示例：
  - 盘块大小：____KB
  - 盘块号占用：____B
  - 索引块容量：____个盘块号
  - 两级索引支持：____

- 优缺点：
  - 优点：加快大型文件查找____
  - 缺点：访问次数随级数增加而____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>索引</li>
    <li>页表</li>
    <li>索引</li>
    <li>4</li>
    <li>4</li>
    <li>1024</li>
    <li>$1024\times1024\times4\mathrm{KB}=4\mathrm{GB}$</li>
    <li>速度</li>
    <li>增多</li>
  </ul>
</details>
</div>

</ul>

#### 混合索引分配方式

<ul>

> pro：混合索引分配的原理（2013）

- 设计思路：
  - 针对不同大小文件采用不同____
  - UNIX系统实现：____个地址项(i.addr[0-12])

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/423df56c235d223a9617895a37f5ae1ff7d295f35482d63d0bc986ef53bc6876.jpg)
图4.11UNIX系统的inode结构示意图

##### 直接地址

<ul>

- 特点：
  - 使用i.addr[0-9]共____个直接地址项
  - 适用于小文件(≤____KB)
  - 可直接读取盘块____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>10</li>
    <li>40</li>
    <li>号</li>
  </ul>
</details>
</div>

</ul>

##### 一次间接地址

<ul>

- 特点：
  - 使用i.addr[10]
  - 适用于中、大型____
  - 最大支持____文件

> pro：多级索引块的访问效率分析（2018、2022）

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>文件</li>
    <li>4MB+40KB</li>
  </ul>
</details>
</div>

</ul>

##### 多次间接地址

<ul>

- 二次间接地址：
  - 使用i.addr[11]
  - 最大支持____文件

- 三次间接地址：
  - 使用i.addr[12]
  - 最大支持____文件

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>4GB+4MB+40KB</li>
    <li>4TB+4GB+4MB+40KB</li>
  </ul>
</details>
</div>

</ul>

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>策略</li>
    <li>13</li>
  </ul>
</details>
</div>

</ul>

</ul>

</ul>

## 本节小结

<ul>

本节开头提出的问题的参考答案如下。

1）什么是文件？

文件是以计算机____为载体的存储在计算机上的信息集合，它的形式多样。

2）单个文件的逻辑结构和物理结构之间是否存在某些制约关系？

文件的____结构是用户可见的结构，即从用户角度看到的文件的全貌。文件的____结构是文件在存储器上的组织结构。它和文件的存取方法以及存储设备的特性等都有着密切的联系。单个文件的逻辑结构和物理结构之间虽无明显的制约或关联关系，但是如果物理结构选择不慎，也很难体现出逻辑结构的特点，比如一个逻辑结构是____结构，而物理结构是隐式链接结构的文件，即使理论上可以很快找出某条记录的地址，而实际仍需在磁盘上一块一块地找。

学到这里时，读者应能有这样的体会：现代操作系统的思想中，处处能见到面向对象程序设计的影子。本节我们学习的一个新概念一一文件，实质上就是一个抽象____类型，也就是一种数据结构，若读者在复习操作系统之前已复习完数据结构，则遇到一种新的数据结构时，一定会有这样的意识：要认识它的____结构、____结构，以及对这种数据结构的操作。

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>硬盘</li>
    <li>逻辑</li>
    <li>物理</li>
    <li>顺序</li>
    <li>数据</li>
    <li>逻辑</li>
    <li>物理</li>
  </ul>
</details>
</div>

</ul>

# 目录

<ul>

在学习本节时，请读者思考以下问题：

1）目录管理的要求是什么？

2）在目录中查找某个文件可以使用什么方法？

上节介绍了文件的____结构和____结构，本节将介绍目录的实现。文件目录也是一种____结构，用于标识系统中的文件及其物理地址，供检索时使用。通常，一个文件目录也被视为一个文件。在学习本节的内容时，读者可以围绕目录管理的要求来思考。

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>逻辑</li>
    <li>物理</li>
    <li>数据</li>
  </ul>
</details>
</div>

</ul>

## 基本概念

<ul>

### 文件目录定义与管理要求

<ul>

- FCB的有序集合称为文件____，一个FCB就是一个文件____项
- 目录管理的基本要求：
  - 实现"____存取"，提供文件名和文件之间的映射
  - 提高目录检索____，提升系统性能
  - 支持多用户文件____
  - 允许不同用户使用相同____
  - 通过____结构实现目录管理

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>目录</li>
    <li>目录</li>
    <li>按名</li>
    <li>速度</li>
    <li>共享</li>
    <li>文件名</li>
    <li>树形</li>
  </ul>
</details>
</div>

</ul>

### 目录结构

<ul>

#### 单级目录结构

<ul>

- 特点：整个文件系统只有一张____表
- 操作流程：
  - 新建文件：检查重名、增加____项
  - 访问文件：查找____、检查合法性
  - 删除文件：查找目录项、回收____
- 缺点：
  - 查找速度____
  - 不允许文件____
  - 不便于文件____
  - 不适用于多用户____

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/a61a9759c73160f0410aadcb978b5291de233ad43c64000066bf629bba768f52.jpg)

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>目录</li>
    <li>目录</li>
    <li>FCB</li>
    <li>空间</li>
    <li>慢</li>
    <li>重名</li>
    <li>共享</li>
    <li>系统</li>
  </ul>
</details>
</div>

</ul>

#### 两级目录结构

<ul>

- 组成：
  - 主文件目录(MFD)：记录用户名和____位置
  - 用户文件目录(UFD)：记录用户文件的____
- 优点：
  - 提高检索____
  - 解决多用户文件____问题
  - 可实现访问____
- 缺点：
  - 缺乏____性
  - 不能对文件____

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/63a7177d5969ca0b8ca50c1b869d98e7924eee92b08afbfb7b8996fbdc1905c2.jpg)

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>UFD</li>
    <li>FCB</li>
    <li>速度</li>
    <li>重名</li>
    <li>限制</li>
    <li>灵活</li>
    <li>分类</li>
  </ul>
</details>
</div>

</ul>

#### 树形目录结构

<ul>

> pro：设置当前工作目录的作用（2010）

- 文件路径：
  - 绝对路径：从____目录出发的完整路径
  - 相对路径：从____目录出发的路径
- 当前目录特性：
  - 每个用户有独立____目录
  - 登录时自动进入用户____目录
  - 可通过系统调用改变____目录
- 优点：
  - 便于文件____
  - 层次结构____
  - 有效进行文件管理和____
- 缺点：
  - 查找文件需逐级访问，增加磁盘____次数

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/fdd6fe735585e7b6f814f6c2c23dd8171f96c5fec74b938d4f11b5e63d299679.jpg)

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>根</li>
    <li>当前</li>
    <li>当前</li>
    <li>当前</li>
    <li>当前</li>
    <li>分类</li>
    <li>清晰</li>
    <li>保护</li>
    <li>访问</li>
  </ul>
</details>
</div>

</ul>

#### 无环图目录结构

<ul>

- 基于树形结构的____：
  - 增加指向同一节点的有向____
  - 允许目录共享子目录或____
- 共享节点管理：
  - 设置共享____器
  - 共享链增加时计数器____
  - 删除请求时计数器____
  - 计数器为0时才真正删除____
- 特点：
  - 优点：方便实现文件____
  - 缺点：系统管理更____

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/32f228bab6112191e728f9eea4662365b7102dc88891bcbfb93ea10f5c560aa8.jpg)

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>扩展</li>
    <li>边</li>
    <li>文件</li>
    <li>计数</li>
    <li>+1</li>
    <li>-1</li>
    <li>节点</li>
    <li>共享</li>
    <li>复杂</li>
  </ul>
</details>
</div>

</ul>

</ul>

</ul>

</ul>

## 目录的操作

<ul>

- 理解文件系统需求的基础：
  - 考虑目录层次上所需执行的____，有助于整体理解文件系统。

- 目录层次的操作：
  - 搜索：找到文件的对应____项。
  - 创建文件：在目录中增加一个____项。
  - 删除文件：在目录中删除相应的____项。
  - 创建目录：在树形目录结构中创建用户文件目录和____。
  - 删除目录：
    - 方式1：不删除非空目录，需先删除目录中所有文件和____。
    - 方式2：可删除非空目录，文件和子目录同时被____。
  - 移动目录：在不同父目录之间移动文件或子目录，____随之改变。
  - 显示目录：请求显示目录内容，如所有文件及____。
  - 修改目录：改变保存在目录中的文件____，需修改相应的目录项。

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>操作</li>
    <li>目录</li>
    <li>目录</li>
    <li>目录</li>
    <li>子目录</li>
    <li>子目录</li>
    <li>删除</li>
    <li>路径名</li>
    <li>属性</li>
    <li>属性</li>
  </ul>
</details>
</div>

</ul>

## * 目录实现

<ul>

- 文件访问过程：
  - 操作系统使用路径名找到相应____项。
  - 目录项提供查找文件磁盘块所需的____。

- 目录实现方法：
  - 基本方法：线性列表和____表。
  - 线性列表实现对应线性____。
  - 哈希表实现对应散列____。

- 目录查找的目的：
  - 目录的实现是为了高效____文件。

### 目录实现方法

<ul>

#### 线性列表

<ul>

- 实现方式：
  - 采用文件名和数据块____的线性列表
- 操作过程：
  - 创建文件：
    - 搜索目录确认无同名____
    - 增加新____项
  - 删除文件：
    - 根据文件名搜索____
    - 释放分配____
- 目录项重用方法：
  - 标记为不再____
  - 加入空闲目录项____
  - 将最后目录项复制到空闲位置并减少____
- 特点：
  - 优点：实现____
  - 缺点：查找____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>目录</li>
    <li>信息</li>
    <li>哈希</li>
    <li>查找</li>
    <li>查找</li>
    <li>查找</li>
    <li>指针</li>
    <li>文件</li>
    <li>目录</li>
    <li>目录</li>
    <li>空间</li>
    <li>使用</li>
    <li>列表</li>
    <li>长度</li>
    <li>简单</li>
    <li>费时</li>
  </ul>
</details>
</div>

</ul>

#### 哈希表

<ul>

- 实现原理：
  - 根据文件名计算____值
  - 返回指向线性列表元素的____
- 特点：
  - 优点：
    - 查找____
    - 插入删除____
  - 缺点：需要避免____
- 优化措施：
  - 将当前文件目录复制到____
  - 减少磁盘____操作
  - 提高系统____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>哈希</li>
    <li>指针</li>
    <li>迅速</li>
    <li>简单</li>
    <li>冲突</li>
    <li>内存</li>
    <li>I/O</li>
    <li>速度</li>
  </ul>
</details>
</div>

</ul>

</ul>

### 文件共享

<ul>

- 基本概念：
  - 多用户共享同一____
  - 系统只保留一个____
- 实现基础：
  - 基于无环图____结构
  - 复制被共享文件物理____

#### 基于索引节点的共享方式（硬链接）

<ul>

> pro：硬链接和软链接文件中引用计数值的分析（2009）

- 实现机制：
  - 文件信息存储在____节点
  - 目录项只含文件名和索引节点____
- 链接计数管理：
  - 使用____记录链接数
  - 表示用户目录项____

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/23c4e4eff9fd9aa7d4de10b736a43f80cb3862d258647ca26e827afb42afe5c1.jpg)

- 操作过程：
  - 创建文件：
    - 设置文件____者
    - count置为____
  - 共享文件：
    - 增加____项
    - count加____
  - 删除文件：
    - 减少____
    - count为0时才真正____

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/f09ad53c3f500d76eed8bf8c04e452185e641e4bc13bb00ea697950994fd35db.jpg)

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>文件</li>
    <li>副本</li>
    <li>目录</li>
    <li>地址</li>
    <li>索引</li>
    <li>指针</li>
    <li>count</li>
    <li>数目</li>
    <li>所有</li>
    <li>1</li>
    <li>目录</li>
    <li>1</li>
    <li>count</li>
    <li>删除</li>
  </ul>
</details>
</div>

</ul>

#### 利用符号链实现文件共享（软链接）

<ul>

- 实现机制：
  - 创建____类型新文件
  - 存储被链接文件____名

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/f35b3df4105ca5fd7da8809fed7378ce45b1c7a00fed4b4066c72c32df50a40d.jpg)

> pro：软链接方式删除共享文件后的情况（2021）

- 特点：
  - 访问机制：
    - 只有文件主有索引节点____
    - 其他用户只有____名
  - 删除处理：
    - 不会产生悬空____
    - 访问失败时自动删除符号____
  - 性能考虑：
    - 需多次____盘
    - 增加访问____
    - 索引节点占用磁盘____
- 网络应用：
  - 提供机器网络____
  - 提供文件____名

##### 硬链接与软链接对比

<ul>

- 硬链接：
  - 多指针指向一个____节点
  - 索引节点存在时指针____
- 软链接：
  - 保存文件访问____
  - 根据路径寻找____
- 性能比较：
  - 硬链接查找速度____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>LINK</li>
    <li>路径</li>
    <li>指针</li>
    <li>路径</li>
    <li>指针</li>
    <li>链接</li>
    <li>读</li>
    <li>开销</li>
    <li>空间</li>
    <li>地址</li>
    <li>路径</li>
    <li>索引</li>
    <li>有效</li>
    <li>路径</li>
    <li>文件</li>
    <li>更快</li>
  </ul>
</details>
</div>

</ul>

</ul>

</ul>

</ul>

</ul>

## 本节小结

<ul>

本节开头提出的问题的参考答案如下。
1）目录管理的要求是什么？

$\textcircled{\scriptsize{1}}$ 实现“____存取”，这是目录管理最基本的功能。 $\circledcirc$ 提高对目录的检索____，从而提高对文件的存取速度。 $\textcircled{3}$ 为了方便用户共享文件，目录还需要提供用于控制访问文件的____。 $\textcircled{4}$ 允许不同用户对不同文件采用相同的____，以便用户按自己的习惯给文件命名。

2）在目录中查找某个文件可以使用什么方法？

可以采用线性列表法或____表法。线性列表将文件名组织成一个线性表，查找时依次与线性表中的每个表项进行比较。若将文件名按序排列，则使用____查找法可以降低平均的查找时间，但建立新文件时会增加维护线性表的开销。哈希表用文件名通过哈希函数得到一个指向文件的____，这种方法非常迅速，但要注意避免____。

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>按名</li>
    <li>速度</li>
    <li>信息</li>
    <li>名字</li>
    <li>哈希</li>
    <li>折半</li>
    <li>指针</li>
    <li>冲突</li>
  </ul>
</details>
</div>

</ul>

# 文件系统

<ul>

在学习本节时，请读者思考以下问题：

1）什么是文件系统？

2）文件系统要完成哪些功能？

本节除了“外存空闲空间管理”，其他都是2022年统考大纲的新增考点，这些内容都是比较抽象的、看不见也摸不着的____，在常用的国内教材（如汤小丹的教材）中都鲜有涉及。如果觉得不太好理解这些内容，建议读者结合王道的最新课程进行学习。

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>原理</li>
  </ul>
</details>
</div>

</ul>

## 结构

<ul>

### 文件系统的设计问题

<ul>

- 定义文件系统的用户____
  - 定义文件及其____
  - 允许的文件____
  - 文件目录结构____
- 创建算法和数据结构
  - 映射逻辑文件系统到物理____设备

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>接口</li>
    <li>属性</li>
    <li>操作</li>
    <li>组织</li>
    <li>外存</li>
  </ul>
</details>
</div>

</ul>

### 文件系统层次结构

<ul>

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/4a35b9af73e3643a61bd453d60c98bd3da0e090a6b6d012a326ead907267f8bb.jpg)

#### I/O控制层

<ul>

- 包含组件
  - 设备____程序
  - 中断____程序
- 功能
  - 在内存和磁盘系统间传输____
  - 将命令翻译为硬件____
  - 控制I/O设备与系统____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>驱动</li>
    <li>处理</li>
    <li>信息</li>
    <li>指令</li>
    <li>交互</li>
  </ul>
</details>
</div>

</ul>

#### 基本文件系统

<ul>

- 主要功能
  - 向驱动程序发送通用____
  - 读写磁盘物理____
- 缓冲区管理
  - 管理内存____区
  - 缓存文件系统、目录和数据____
  - 分配和管理____区

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>命令</li>
    <li>块</li>
    <li>缓冲</li>
    <li>块</li>
    <li>缓冲</li>
  </ul>
</details>
</div>

</ul>

#### 文件组织模块

<ul>

- 文件块管理
  - 组织文件的____块和物理块
  - 转换逻辑块地址到物理块____
- 空闲空间管理
  - 跟踪未分配____
  - 按需提供给文件组织____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>逻辑</li>
    <li>地址</li>
    <li>块</li>
    <li>模块</li>
  </ul>
</details>
</div>

</ul>

#### 逻辑文件系统

<ul>

- 元数据管理
  - 管理文件系统结构____
  - 不包含实际文件____
- 具体功能
  - 管理____结构
  - 维护文件____块
  - 负责文件____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>信息</li>
    <li>内容</li>
    <li>目录</li>
    <li>控制</li>
    <li>保护</li>
  </ul>
</details>
</div>

</ul>

</ul>

</ul>

</ul>

## 布局

<ul>

### 文件系统在磁盘中的结构

<ul>

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/652088c7250050b7fd4efc5dab71dec6566092e5fd8b9a5b7f2f79b0de6030a8.jpg)

#### 主引导记录(MBR)

<ul>

- 位置：磁盘____号扇区
- 功能
  - 引导____
  - 包含分区____
  - 标记活动____
  - 启动时由BIOS读取____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>0</li>
    <li>计算机</li>
    <li>表</li>
    <li>分区</li>
    <li>执行</li>
  </ul>
</details>
</div>

</ul>

#### 引导块

<ul>

- 特点
  - 每个分区起始____
  - 负责启动____系统
  - Windows称为分区引导____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>位置</li>
    <li>操作</li>
    <li>扇区</li>
  </ul>
</details>
</div>

</ul>

#### 超级块

<ul>

- 包含信息
  - 文件系统关键____
  - 分区块数量和____
  - 空闲块____
  - ____相关信息

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>信息</li>
    <li>大小</li>
    <li>信息</li>
    <li>FCB</li>
  </ul>
</details>
</div>

</ul>

#### 其他组件

<ul>

- 空闲块信息
  - 位示图或指针____形式
- i节点组
  - 每个文件对应一个____
- 根目录
  - 存放文件系统目录树____
- 其他目录和文件____区

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>链接</li>
    <li>节点</li>
    <li>根部</li>
    <li>存储</li>
  </ul>
</details>
</div>

</ul>

</ul>

### 文件系统在内存中的结构

<ul>

#### 内存数据结构

<ul>

- 安装表
  - 包含已安装分区____
- 目录结构缓存
  - 最近访问目录____
- 系统打开文件表
  - ____副本
  - 打开计数等____
- 进程打开文件表
  - 文件____符
  - 指向系统文件表的____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>信息</li>
    <li>信息</li>
    <li>FCB</li>
    <li>信息</li>
    <li>描述</li>
    <li>指针</li>
  </ul>
</details>
</div>

</ul>

</ul>

</ul>

</ul>

## 外存空闲空间管理

<ul>

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/2219149a41148f7dda747f0a8d668da014f9802a01e9dd088a752e14a13e37ff.jpg)

### 卷的概念与组织

<ul>

- 卷的形式
  - 磁盘的____
  - 整个____
  - 多个磁盘组成的____集
- 卷的结构
  - 文件区与目录区____
  - 需要____
  - 包含目录区和文件____
  - 建立空闲空间管理____
  - 存放卷信息的____块

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>一部分</li>
    <li>磁盘</li>
    <li>RAID</li>
    <li>分离</li>
    <li>初始化</li>
    <li>区</li>
    <li>表格</li>
    <li>超级</li>
  </ul>
</details>
</div>

</ul>

### 存储管理特点

<ul>

- 以块为单位交换____
- 管理重点是空闲____
  - ____
  - 分配
  - ____

> pro：磁盘空闲空间管理的方法（2019、2024）

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>信息</li>
    <li>块</li>
    <li>组织</li>
    <li>回收</li>
  </ul>
</details>
</div>

</ul>

### 外存空闲空间管理方法

<ul>

#### 空闲表法

<ul>

- 属于____分配方式，类似内存动态分区分配
- 系统建立空闲____
  - 包含表项____
  - 空闲区第一个盘块____
  - 空闲区盘块____
- 按起始盘块号____排列

![图片地址](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/7a85c6c59a536a2981f83f60d296531437af7ada9889aa970af846ea0202ab60.jpg)

##### 盘块分配

<ul>

- 采用首次适应或最佳适应____
- 顺序检索空闲表找到满足需求的____区
- 分配后修改空闲____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>算法</li>
    <li>空闲</li>
    <li>表</li>
  </ul>
</details>
</div>

</ul>

##### 盘块回收

<ul>

- 类似内存回收____
- 考虑与前后空闲区的____

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>方法</li>
    <li>合并</li>
  </ul>
</details>
</div>

</ul>

##### 优点

<ul>

- 分配速度____
- 减少磁盘____频率
- 适合小文件____分配

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>高</li>
    <li>I/O</li>
    <li>连续</li>
  </ul>
</details>
</div>

</ul>

</ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>连续</li>
    <li>表</li>
    <li>序号</li>
    <li>号</li>
    <li>数</li>
    <li>递增</li>
  </ul>
</details>
</div>

</ul>

#### 空闲链表法

<ul>

##### 空闲盘块链

<ul>

- 以盘块为单位组成____
- 每个盘块指向下一空闲____
###### 优点
- 分配回收单个盘块____
###### 缺点
-

以下是按照要求对提供的 Markdown 文档进行挖空处理后的结果，包含 Markdown 和 HTML 格式的折叠块，保留原有目录结构并确保简洁明了。关键词、关键步骤等已挖空，答案置于折叠块中。

---

```markdown
# 数据结构基础知识点整理

## 文件基本概念与结构

### 文件控制块

<ul>

- 表示____目录项
- 组成：
  - 包含指向____的指针
  - 包含指向____和____的指针
- 特点：
  - ____上无对应数据结构
  - 由____在遍历路径过程中解析生成

<ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

特定</li>
    <li>

关联索引节点</li>
    <li>

父目录</li>
    <li>

子目录</li>
    <li>

磁盘</li>
    <li>

VFS</li>
  </ul>
</details>
</div>

</ul>

### 文件对象

<ul>

- 表示进程相关的____文件
- 操作方式：
  - 通过____打开
  - 通过____关闭
- 特点：
  - 类似____和____的关系
  - 仅代表____视角的已打开文件
  - 指向其____
- 包含内容：
  - 相关联的____对象
  - ____信息
  - ____指针
  - ____函数

<ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

已打开</li>
    <li>

open()</li>
    <li>

close()</li>
    <li>

进程</li>
    <li>

程序</li>
    <li>

进程</li>
    <li>

索引节点</li>
    <li>

目录项</li>
    <li>

文件系统</li>
    <li>

文件</li>
    <li>

操作</li>
  </ul>
</details>
</div>

</ul>

</ul>

## 系统调用处理流程

<ul>

- 进程发起____的系统调用
- 内核调用____函数
- VFS函数调用____相应函数
- 转换为____的指令

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/d284c15b75a406a133532a466740a742df343db72bbdb92ae9c3537a93023937.jpg)  
图4.25 write（系统调用操作示意图）

<ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

面向文件</li>
    <li>

VFS</li>
    <li>

目标文件系统</li>
    <li>

面向设备</li>
  </ul>
</details>
</div>

</ul>

## VFS特点

<ul>

- 用户无需关心____实现细节
- 对____细节进行抽象
- 使不同____对进程表现一致
- 存在特点：
  - 仅存在于____中
  - 不存在于____空间
  - 系统____时建立
  - 系统____时消亡

<ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

文件系统</li>
    <li>

文件系统</li>
    <li>

文件系统</li>
    <li>

内存</li>
    <li>

外存</li>
    <li>

启动</li>
    <li>

关闭</li>
  </ul>
</details>
</div>

</ul>

</ul>

## 文件系统挂载

### Windows文件系统挂载

<ul>

- 维护扩展的____目录结构
  - 使用____表示设备和卷
  - 卷具有____目录
    - 与____相关联
    - 含有指向____的指针
- 文件路径形式
  - 格式为____
  - 访问流程
    - 操作系统找到相应____指针
    - 遍历____查找指定文件
- 新版Windows特点
  - 允许文件系统安装在____任意位置(类似UNIX)
  - 启动时自动发现和安装____文件系统

<ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

两级</li>
    <li>

驱动器字母</li>
    <li>

常规树结构</li>
    <li>

驱动器号</li>
    <li>

已安装文件系统</li>
    <li>

driver-letter:path\to\file</li>
    <li>

文件系统</li>
    <li>

设备目录结构</li>
    <li>

目录树</li>
    <li>

所有设备</li>
  </ul>
</details>
</div>

</ul>

### UNIX文件系统挂载

<ul>

- ____文件系统
  - 系统启动时____安装
  - 是____所在文件系统
- 其他文件系统
  - 必须先挂载到____目录才能访问
  - 挂载方式
    - 系统初始化时____安装
    - 用户手动挂载到____目录
- 安装点特点
  - 同一设备可有____安装点
  - 同一安装点同时只能挂载____设备
  - 通过____目录可读取设备数据

#### 挂载示例

<ul>

- 将ext2文件系统挂载到/flp:
  - 命令: ____
- 卸载文件系统:
  - 使用____命令

<ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

根</li>
    <li>

直接</li>
    <li>

内核映像</li>
    <li>

根文件系统</li>
    <li>

自动</li>
    <li>

已安装文件系统</li>
    <li>

多个</li>
    <li>

一个</li>
    <li>

安装点</li>
    <li>

mount -t ext2 /dev/fd0 /flp</li>
    <li>

umount</li>
  </ul>
</details>
</div>

</ul>

</ul>

</ul>

### 本章主线

<ul>

- 第一条主线：文件____数据类型
  - ____结构
  - ____结构
- 第二条主线：操作系统____管理
  - 多文件____组织(目录)
  - 用户文件服务请求处理(____管理)
- 学习建议
  - ____把握知识为____掌控服务
  - 通过反复做题思考____理解

<ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

抽象</li>
    <li>

逻辑</li>
    <li>

物理</li>
    <li>

文件</li>
    <li>

逻辑结构</li>
    <li>

磁盘</li>
    <li>

宏观</li>
    <li>

微观</li>
    <li>

加深</li>
  </ul>
</details>
</div>

</ul>

</ul>

## 本节小结  

<ul>

本节开头提出的问题的参考答案如下。  

1）什么是文件系统？  

操作系统中负责管理和存储____信息的软件机构称为____管理系统，简称____。文件系统由三部分组成：与文件管理有关的____、被管理____及实施文件管理所需的____。  

2）文件系统要完成哪些功能？  

对于用户而言，文件系统最主要的功能是实现对文件的____操作，让用户可以按名____和____文件，组织成合适的____，并应当具有基本的文件____和文件____功能。对于操作系统本身而言，文件系统还需要管理与____的信息交换，完成文件____结构和____结构上的变换，组织文件在____上的存放，采取好的文件排放顺序和____方法以提升整个系统的性能。  

<ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

文件</li>
    <li>

文件</li>
    <li>

文件系统</li>
    <li>

软件</li>
    <li>

文件</li>
    <li>

数据结构</li>
    <li>

基本</li>
    <li>

存储</li>
    <li>

查找</li>
    <li>

结构</li>
    <li>

共享</li>
    <li>

保护</li>
    <li>

磁盘</li>
    <li>

逻辑</li>
    <li>

物理</li>
    <li>

磁盘</li>
    <li>

磁盘调度</li>
  </ul>
</details>
</div>

</ul>

</ul>

## 本章疑难点  

### 文件的物理分配方式的比较  

<ul>

文件的三种____分配方式的比较如表4.3所示。  

表4.3 文件三种分配方式的比较  
![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/25a02748a7aa73d186c2f7f8d38f6f9764d00d52316ca87a38244c89706bbcba.jpg)`

<ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

物理</li>
  </ul>
</details>
</div>

</ul>

### 文件打开的过程描述  

<ul>

$\textcircled{\scriptsize{1}}$ ____目录，要求打开的文件应该是已经____的文件，它应登记在____中，否则会出错。在检索到指定文件后，就将其____复制到____中。  

$\circledcirc$ 将参数mode所给出的____方式与____中在创建文件时所记录的____相比较，如果合法，则此次打开操作成功。  

$\circledast$ 当打开合法时，为文件分配____表表项和____表表项，并为后者设置初值，通过____建立表项与____之间的联系，再将____返回给调用者。  

<ul>

<div>
<details>
  <summary> </summary>
  <ul>
    <li>

检索</li>
    <li>

创建</li>
    <li>

文件目录</li>
    <li>

磁盘iNode</li>
    <li>

活动iNode表</li>
    <li>

打开</li>
    <li>

活动iNode</li>
    <li>

文件访问权限</li>
    <li>

用户打开文件</li>
    <li>

系统打开文件</li>
    <li>

指针</li>
    <li>

活动iNode</li>
    <li>

文件描述符fd</li>
  </ul>
</details>
</div>

</ul>

</ul>


